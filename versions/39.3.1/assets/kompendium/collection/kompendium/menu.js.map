{"version":3,"file":"menu.js","sourceRoot":"","sources":["../../src/kompendium/menu.ts"],"names":[],"mappings":"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","sourcesContent":["import { JsonDocsComponent, JsonDocs } from '@stencil/core/internal';\nimport startCase from 'lodash/startCase';\nimport { MenuItem, KompendiumGuide, TypeDescription } from '../types';\n\nexport function createMenu(\n    docs: JsonDocs,\n    guides: KompendiumGuide[],\n    types: TypeDescription[],\n): MenuItem[] {\n    let menu = [];\n\n    guides.forEach(addGuide(menu, ''));\n    menu = [...menu, createComponentMenu(docs), createTypeMenu(types)];\n\n    return menu;\n}\n\nexport const addGuide =\n    (menu: MenuItem[], path: string) => (guide: KompendiumGuide) => {\n        const subPath: string = guide.data.path.replace(path, '');\n        const parts = subPath.split('/');\n        const parentPath = `${path}/${parts[1]}`;\n        let submenu = menu.find((item) => item.path === parentPath + '/');\n\n        if (!submenu && parts.length === 2) {\n            const title = getGuideTitle(guide);\n            menu.push({\n                path: guide.data.path + '/',\n                title: title,\n                children: [],\n            });\n\n            return;\n        }\n\n        if (!submenu) {\n            submenu = {\n                path: parentPath + '/',\n                title: startCase(parts[1]),\n                children: [],\n            };\n            menu.push(submenu);\n        }\n\n        addGuide(submenu.children, parentPath)(guide);\n    };\n\nfunction getGuideTitle(guide: KompendiumGuide): string {\n    const regex = /^#\\s?(.+?)$/m;\n    const match = guide.content.match(regex);\n\n    return match?.[1];\n}\n\nexport function createComponentMenu(docs: JsonDocs): MenuItem {\n    const components = docs.components || [];\n\n    return {\n        path: '/component/',\n        title: 'Components',\n        children: components\n            .filter(isNotExample)\n            .filter(isPublic)\n            .map(getComponentMenu),\n    };\n}\n\nexport function isExample(component: JsonDocsComponent): boolean {\n    return !!component.dirPath.match(/\\/examples?$/);\n}\n\nfunction isNotExample(component: JsonDocsComponent) {\n    return !isExample(component);\n}\n\nexport function isPublic(component: JsonDocsComponent): boolean {\n    return !component.docsTags.find((tag) =>\n        ['internal', 'private', 'ignore'].includes(tag.name),\n    );\n}\n\nexport function getComponentMenu(component: JsonDocsComponent): MenuItem {\n    return {\n        path: `/component/${component.tag}/`,\n        title: getComponentTitle(component.tag),\n        children: [\n            getComponentPropertyMenu(component),\n            getComponentEventMenu(component),\n            getComponentMethodMenu(component),\n            getComponentSlotMenu(component),\n            getComponentStyleMenu(component),\n        ].filter((item) => !!item),\n    };\n}\n\nfunction getComponentPropertyMenu(component: JsonDocsComponent): MenuItem {\n    if (!component.props.length) {\n        return;\n    }\n\n    return {\n        title: 'Properties',\n        path: `/component/${component.tag}/properties/`,\n    };\n}\n\nfunction getComponentEventMenu(component: JsonDocsComponent): MenuItem {\n    if (!component.events.length) {\n        return;\n    }\n\n    return {\n        title: 'Events',\n        path: `/component/${component.tag}/events/`,\n    };\n}\n\nfunction getComponentMethodMenu(component: JsonDocsComponent): MenuItem {\n    if (!component.methods.length) {\n        return;\n    }\n\n    return {\n        title: 'Methods',\n        path: `/component/${component.tag}/methods/`,\n    };\n}\n\nfunction getComponentSlotMenu(component: JsonDocsComponent): MenuItem {\n    if (!component.slots.length) {\n        return;\n    }\n\n    return {\n        title: 'Slots',\n        path: `/component/${component.tag}/slots/`,\n    };\n}\n\nfunction getComponentStyleMenu(component: JsonDocsComponent): MenuItem {\n    if (!component.styles.length) {\n        return;\n    }\n\n    return {\n        title: 'Styles',\n        path: `/component/${component.tag}/styles/`,\n    };\n}\n\nexport function getComponentTitle(tag: string): string {\n    const title = tag.split('-').slice(1).join(' ');\n\n    return title[0].toLocaleUpperCase() + title.slice(1);\n}\n\nexport function createApiMenu(): MenuItem {\n    return {\n        path: '/api/',\n        title: 'API',\n    };\n}\n\nexport function createVersionMenu(): MenuItem {\n    return {\n        path: '/version/',\n        title: 'Versions',\n    };\n}\n\nfunction createTypeMenu(types: TypeDescription[]): MenuItem {\n    return {\n        path: '/type/',\n        title: 'Types',\n        // Sort types alphabetically by name\n        children: types\n            .slice()\n            .sort((a, b) => a.name.localeCompare(b.name))\n            .map(getTypeMenu),\n    };\n}\n\nexport function getTypeMenu(type: TypeDescription): MenuItem {\n    return {\n        path: `/type/${type.name}/`,\n        title: type.name,\n        children: [],\n    };\n}\n"]}