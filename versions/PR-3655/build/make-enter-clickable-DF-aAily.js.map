{"version":3,"file":"make-enter-clickable-DF-aAily.js","sources":["src/util/make-enter-clickable.ts"],"sourcesContent":["import { forceUpdate } from '@stencil/core';\n\nconst eventHandlers: WeakMap<HTMLElement, EnterClickable> = new WeakMap();\n\nclass EnterClickable {\n    private isActive = false;\n    private hasJustReleasedEnter = true;\n\n    constructor(private element: HTMLElement) {}\n\n    private handleKeyDown = (event: KeyboardEvent) => {\n        if (event.key === 'Enter' && !this.isActive) {\n            this.isActive = true;\n\n            if (this.element?.shadowRoot) {\n                forceUpdate(this.element);\n            }\n        }\n    };\n\n    private handleKeyUp = (event: KeyboardEvent) => {\n        if (event.key === 'Enter' && this.isActive) {\n            this.isActive = false;\n            this.hasJustReleasedEnter = true;\n\n            if (this.element?.shadowRoot) {\n                forceUpdate(this.element);\n            }\n        }\n    };\n\n    private handleClick = (event: MouseEvent) => {\n        if (!this.isActive) {\n            return;\n        }\n\n        if (this.hasJustReleasedEnter) {\n            this.hasJustReleasedEnter = false;\n\n            return;\n        }\n\n        event.stopImmediatePropagation();\n    };\n\n    private callbacks: CallBacks = {\n        keydownHandler: this.handleKeyDown.bind(this),\n        keyupHandler: this.handleKeyUp.bind(this),\n        clickHandler: this.handleClick.bind(this),\n    };\n\n    public enable() {\n        this.element.addEventListener('keydown', this.callbacks.keydownHandler);\n        this.element.addEventListener('keyup', this.callbacks.keyupHandler);\n        this.element.addEventListener(\n            'click',\n            this.callbacks.clickHandler,\n            true\n        );\n    }\n\n    public disable() {\n        this.element.removeEventListener(\n            'keydown',\n            this.callbacks.keydownHandler\n        );\n        this.element.removeEventListener('keyup', this.callbacks.keyupHandler);\n        this.element.removeEventListener(\n            'click',\n            this.callbacks.clickHandler,\n            true\n        );\n    }\n}\n\n/**\n * Overrides the default browser behavior for clickable elements\n * When focused and pressing down enter, avoids calling onClick repeatedly\n *\n * @param element - The clickable element\n */\nexport function makeEnterClickable(element: HTMLElement) {\n    if (!eventHandlers.has(element)) {\n        const enterClickable = new EnterClickable(element);\n        enterClickable.enable();\n        eventHandlers.set(element, enterClickable);\n    }\n}\n\n/**\n *\n * @param element\n */\nexport function removeEnterClickable(element: HTMLElement) {\n    const enterClickable: EnterClickable = eventHandlers.get(element);\n    if (enterClickable) {\n        enterClickable.disable();\n        eventHandlers.delete(element);\n    }\n}\n\ninterface CallBacks {\n    keydownHandler: (arg: KeyboardEvent) => void;\n    keyupHandler: (arg: KeyboardEvent) => void;\n    clickHandler: (arg: MouseEvent) => void;\n}\n"],"names":[],"mappings":"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"}