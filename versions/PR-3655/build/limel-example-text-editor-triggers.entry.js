import{r as t,h as e,a as i}from"./index-BWUkXc2p.js";import{a as s,A as a,b as l,E as h,T as n}from"./keycodes-DnYyy-Oi.js";const o="limel-button-group{min-width:8rem}limel-example-controls{display:flex;flex-wrap:wrap}.mode{display:flex;flex-wrap:nowrap}.value{display:flex;gap:0.5rem}limel-portal{width:auto}";const r=class{constructor(i){t(this,i);this.value="";this.triggerState="";this.tagValue="";this.isPickerOpen=false;this.insertMode="text";this.contentType="markdown";this.items=[{text:"Wolverine",value:1,icon:"wolf",selected:true},{text:"Captain America",value:2,icon:"captain_america"},{text:"Superman",value:3,icon:"superman"},{text:"Tony Stark",value:4,icon:"iron_man"},{text:"Batman",value:5,icon:"batman_old"}];this.insertModeButtons=[{id:"1",title:"text",selected:true},{id:"2",title:"chip"},{id:"3",title:"html"}];this.contentTypeButtons=[{id:"1",title:"markdown",selected:true},{id:"2",title:"html"}];this.handleKeyPress=t=>{var e;const i=[s,a,l,h,n];if(i.includes(t.key)){t.stopPropagation();t.preventDefault()}if(t.key===l||t.key===a){this.moveSelection(t.key)}if(t.key===h||t.key===n){const t=this.visibleItems.find((t=>t.selected));if(t){this.insertItem(t)}}if(t.key===s){this.isPickerOpen=false;(e=this.triggerFunction)===null||e===void 0?void 0:e.stopTrigger()}};this.moveSelection=t=>{const e=t===l?1:-1;const i=this.visibleItems.length;const s=this.visibleItems.findIndex((t=>t.selected));const a=(s+e+i)%i;this.removeAllSelections();this.setSelection(a)};this.removeAllSelections=()=>{this.items=this.items.map((t=>{t.selected=false;return Object.assign({},t)}))};this.setSelection=t=>{let e;this.visibleItems=this.visibleItems.map(((i,s)=>{const a=s===t;if(a){e=i.value}return Object.assign(Object.assign({},i),{selected:a})}));if(e){this.items[e-1].selected=true}};this.renderPicker=()=>e("limel-popover",{open:this.isPickerOpen,openDirection:"top-start",onClose:this.handleTriggerStop},this.renderList(this.visibleItems));this.renderList=t=>{if(t.length===0){return e("div",{style:{padding:"0.5rem"}},"Couldn't find. Not a hero yet! ðŸ¥²")}return e("limel-menu-list",{items:t,onInteract:this.handleListInteraction})};this.handleTriggerStart=t=>{this.triggerState="start";this.isPickerOpen=true;this.triggerFunction=t.detail.textEditor};this.handleTriggerStop=()=>{this.triggerState="stop";this.tagValue="";this.isPickerOpen=false};this.handleTriggerChange=t=>{this.tagValue=t.detail.value.toLowerCase()};this.handleChange=t=>{this.value=t.detail};this.handleListInteraction=t=>{this.insertItem(t.detail)};this.handleInsertModeChange=t=>{this.insertMode=t.detail.title};this.handleContentTypeChange=t=>{this.contentType=t.detail.title;this.value=""};this.insertItem=t=>{this.removeAllSelections();this.visibleItems=this.items;if(this.insertMode==="html"){this.triggerFunction.insertHtml(`<strong>${t.text}</strong>`).then((()=>console.log("HTML inserted successfully"))).catch((t=>console.error("Error inserting HTML:",t)));return}if(this.insertMode==="text"){this.triggerFunction.insert("@"+t.text);return}this.triggerFunction.insert({node:{tagName:"limel-chip",attributes:{icon:t.icon,text:t.text}},children:["I'm a teapot"]})}}watchOpen(){this.setupEventHandlers()}watchTagValue(){if(this.isPickerOpen){this.visibleItems=this.items.filter((t=>t.text.toLowerCase().includes(this.tagValue)))}}componentWillLoad(){this.visibleItems=this.items;this.setupEventHandlers()}setupEventHandlers(){if(this.isPickerOpen){this.host.addEventListener("keydown",this.handleKeyPress,{capture:true})}else{this.host.removeEventListener("keydown",this.handleKeyPress,{capture:true})}}render(){return[e("limel-example-controls",{key:"1c7667206bd547a15127d1162f1f993a1033cb0f"},e("label",{key:"db98fbfc36533a61bd3d9420509599ef87afb0cf"},"contentType:",e("limel-button-group",{key:"42e1293d6c59c88a0fa82eaf5ea33962562c48f0",class:"mode",value:this.contentTypeButtons,onChange:this.handleContentTypeChange}))),this.renderPicker(),e("limel-text-editor",{style:{display:"block"},value:this.value,customElements:[{tagName:"limel-chip",attributes:["text","icon"]}],triggers:["@"],onTriggerStart:this.handleTriggerStart,onTriggerStop:this.handleTriggerStop,onTriggerChange:this.handleTriggerChange,onChange:this.handleChange,contentType:this.contentType,key:this.contentType}),e("limel-example-controls",{key:"a5a2a5e24c1597520d81da738c2f2e3858f14cf4"},e("label",{key:"90f79b9eb3a4fd54fb258f3378fe1755abe6e091"},"Insert mode:",e("limel-button-group",{key:"408a5d18fa1c3e13be57058f66dfb2dbfddb3903",class:"mode",value:this.insertModeButtons,onChange:this.handleInsertModeChange})),e("div",{key:"28d9a15cb84b39e2c30a7c0f2ad15e611895d5af",class:"value"},e("limel-example-value",{key:"38a185ebf74105295769c90c8ba8e02b11722fd6",label:"Action",value:this.triggerState}),e("limel-example-value",{key:"7b5a71c7e264d5d8c0c7dd5f97ce6cf173c922d8",label:"Tag value",value:this.tagValue}))),e("limel-example-value",{key:"a0b9c7c59158c46b73bda49d6709fe8e3d02629b",value:this.value})]}get host(){return i(this)}static get watchers(){return{isPickerOpen:["watchOpen"],tagValue:["watchTagValue"]}}};r.style=o;export{r as limel_example_text_editor_triggers};
//# sourceMappingURL=limel-example-text-editor-triggers.entry.js.map