import{r as e,h as t,H as i}from"./index-2714248e.js";import"./table.types-a8f98572.js";import{I as s}from"./text-editor.types-e82469d1.js";const a=class{constructor(t){e(this,t);this.metadata={links:[],images:[]};this.handleFailedThumbnailChange=e=>{this.uploadImageFails=e.detail};this.handleChange=e=>{this.value=e.detail};this.handleImagePasted=async e=>{const t=e.detail;t.insertThumbnail();const i=await this.uploadImage(t.fileInfo);if(i){t.insertImage(i)}else{t.insertFailedThumbnail()}};this.uploadImage=async e=>{try{const e=await new Promise(((e,t)=>{setTimeout((()=>{if(this.uploadImageFails){t("Server error")}else{e("https://cdn.lime-crm.com/mail-addin-logo.png")}}),2e3)}));return e}catch(t){console.error(`Failed to upload image ${e.filename}: ${t}`)}};this.handleMetadataChange=e=>{const t=this.getRemovedImages(this.metadata,e.detail);t.forEach((e=>{if(e.state===s.SUCCESS){this.removeImage(e)}}));this.metadata=e.detail};this.value="Copy an image file and paste it here.";this.uploadImageFails=false}render(){return t(i,null,t("limel-text-editor",{value:this.value,onChange:this.handleChange,onImagePasted:this.handleImagePasted,onMetadataChange:this.handleMetadataChange}),t("limel-checkbox",{label:"Upload image fails - insert failed thumbnail",onChange:this.handleFailedThumbnailChange}),t("limel-example-value",{label:"Value",value:this.value}))}getRemovedImages(e,t){const i=new Set(t.images.map((e=>e.fileInfoId)));return e.images.filter((e=>!i.has(e.fileInfoId)))}removeImage(e){console.log(`Image removed: ${e.fileInfoId}`)}};export{a as limel_example_text_editor_with_inline_images_file_storage};
//# sourceMappingURL=limel-example-text-editor-with-inline-images-file-storage.entry.js.map