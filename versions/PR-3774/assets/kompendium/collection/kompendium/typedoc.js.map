{"version":3,"file":"typedoc.js","sourceRoot":"","sources":["../../src/kompendium/typedoc.ts"],"names":[],"mappings":"AAAA,OAAO,EACH,WAAW,EAGX,cAAc,GAGjB,MAAM,SAAS,CAAC;AAWjB,OAAO,MAAM,MAAM,eAAe,CAAC;AAWnC,OAAO,EAAE,UAAU,EAAE,MAAM,IAAI,CAAC;AAOhC,MAAM,UAAU,SAAS,CAAC,QAAgB;IACtC,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,EAAE,CAAC;QACxB,sCAAsC;QACtC,OAAO,CAAC,IAAI,CAAC,8BAA8B,EAAE,QAAQ,CAAC,CAAC;QAEvD,OAAO,EAAE,CAAC;IACd,CAAC;IAED,MAAM,GAAG,GAAG,IAAI,WAAW,EAAE,CAAC;IAC9B,MAAM,OAAO,GAAiC;QAC1C,MAAM,EAAE,MAAM;QACd,oBAAoB,EAAE,IAAI;KAC7B,CAAC;IAEF,IAAI,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE,CAAC;QAC7B,OAAO,CAAC,mBAAmB,GAAG,IAAI,CAAC;QACnC,OAAO,CAAC,OAAO,GAAG,CAAC,8BAA8B,CAAC,CAAC;IACvD,CAAC;IAED,GAAG,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;IAEvB,MAAM,UAAU,GAAG,GAAG,CAAC,OAAO,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;IAC3C,IAAI,CAAC,UAAU,EAAE,CAAC;QACd,sCAAsC;QACtC,OAAO,CAAC,IAAI,CAAC,qCAAqC,CAAC,CAAC;QAEpD,OAAO,EAAE,CAAC;IACd,CAAC;IAED,MAAM,IAAI,GAAsB,EAAE,CAAC;IACnC,UAAU,CAAC,QAAQ,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAAC;IAE5C,OAAO,IAAI,CAAC;AAChB,CAAC;AAED,MAAM,GAAG,GAAG;IACR,CAAC,cAAc,CAAC,SAAS,CAAC,EAAE,YAAY;IACxC,CAAC,cAAc,CAAC,KAAK,CAAC,EAAE,QAAQ;IAChC,CAAC,cAAc,CAAC,aAAa,CAAC,EAAE,YAAY;IAC5C,CAAC,cAAc,CAAC,SAAS,CAAC,EAAE,QAAQ;IACpC,CAAC,cAAc,CAAC,SAAS,CAAC,EAAE,OAAO;IACnC,yCAAyC;IACzC,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE,OAAO;IAC9B,CAAC,cAAc,CAAC,UAAU,CAAC,EAAE,aAAa;CAC7C,CAAC;AAEF,MAAM,gBAAgB,GAAG,CAAC,IAAS,EAAE,EAAE,CAAC,CAAC,UAAsB,EAAE,EAAE;IAC/D,MAAM,EAAE,GAAG,GAAG,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;IAChC,IAAI,EAAE,EAAE,CAAC;QACL,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;IACzB,CAAC;SAAM,CAAC;QACJ,UAAU,CAAC,QAAQ,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAAC;IAChD,CAAC;AACL,CAAC,CAAC;AAEF,SAAS,YAAY,CACjB,UAAiC,EACjC,IAA4B;IAE5B,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,UAAU,EAAE,CAAC;QAC/B,OAAO;IACX,CAAC;IAED,IAAI,CAAC,IAAI,CAAC;QACN,IAAI,EAAE,WAAW;QACjB,IAAI,EAAE,UAAU,CAAC,IAAI;QACrB,UAAU,EAAE,aAAa,CAAC,UAAU,CAAC;QACrC,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC;QACzB,QAAQ,EAAE,WAAW,CAAC,UAAU,CAAC;QACjC,KAAK,EAAE,UAAU,CAAC,QAAQ,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,GAAG,CAAC,WAAW,CAAC;QAC9D,OAAO,EAAE,UAAU,CAAC,QAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,GAAG,CAAC,SAAS,CAAC;QAC5D,OAAO,EAAE,UAAU,CAAC,UAAU,CAAC;KAClC,CAAC,CAAC;AACP,CAAC;AAED,SAAS,QAAQ,CAAC,UAAiC,EAAE,IAAwB;;IACzE,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,UAAU,EAAE,CAAC;QAC/B,OAAO;IACX,CAAC;IAED,IAAI,CAAC,IAAI,CAAC;QACN,IAAI,EAAE,OAAO;QACb,IAAI,EAAE,UAAU,CAAC,IAAI;QACrB,UAAU,EAAE,aAAa,CAAC,UAAU,CAAC;QACrC,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC;QACzB,QAAQ,EAAE,WAAW,CAAC,UAAU,CAAC;QACjC,KAAK,EAAE,MAAA,UAAU,CAAC,QAAQ,0CAAE,MAAM,CAAC,UAAU,EAAE,GAAG,CAAC,WAAW,CAAC;QAC/D,OAAO,EAAE,MAAA,UAAU,CAAC,QAAQ,0CAAE,MAAM,CAAC,QAAQ,EAAE,GAAG,CAAC,SAAS,CAAC;QAC7D,OAAO,EAAE,UAAU,CAAC,UAAU,CAAC;QAC/B,UAAU,EAAE,MAAA,UAAU,CAAC,UAAU,0CAAE,GAAG,CAAC,YAAY,CAAC;KACvD,CAAC,CAAC;AACP,CAAC;AAED,SAAS,YAAY,CAAC,UAA+B,EAAE,IAAqB;;IACxE,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC;QACtB,OAAO;IACX,CAAC;IAED,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC;IACrB,IAAI,CAAC,OAAO,GAAG;QACX,IAAI,EAAE,UAAU,CAAC,IAAI,CAAC,QAAQ,EAAE;QAChC,IAAI,EACA,CAAA,MAAA,MAAA,MAAA,UAAU,CAAC,MAAM,CAAC,MAAM,CAAC,OAAO,0CAAE,IAAI,0CAAE,IAAI,CAAC,SAAS,CAAC,0CAAE,IAAI,KAAI,EAAE;KAC1E,CAAC;IAEF,UAAU,CAAC,QAAQ,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAAC;AAChD,CAAC;AAED,SAAS,QAAQ,CAAC,UAA+B,EAAE,IAAqB;;IACpE,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC;QACjB,IAAI,EAAE,UAAU,CAAC,IAAI;QACrB,IAAI,EAAE,UAAU,CAAC,IAAI,CAAC,QAAQ,EAAE;QAChC,IAAI,EACA,CAAA,MAAA,MAAA,MAAA,UAAU,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,OAAO,0CAAE,IAAI,0CACvC,MAAM,CAAC,OAAO,EACf,IAAI,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,SAAS,KAAK,UAAU,CAAC,IAAI,CAAC,0CAC/C,IAAI,CAAC,IAAI,EAAE,KAAI,EAAE;QAC3B,OAAO,EAAE,UAAU,CAAC,YAAY;QAChC,QAAQ,EAAE,UAAU,CAAC,KAAK,CAAC,UAAU;KACxC,CAAC,CAAC;AACP,CAAC;AAED,SAAS,OAAO,CAAC,UAAiC,EAAE,IAAwB;IACxE,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,UAAU,EAAE,CAAC;QAC/B,OAAO;IACX,CAAC;IAED,IAAI,CAAC,IAAI,CAAC;QACN,IAAI,EAAE,OAAO;QACb,IAAI,EAAE,UAAU,CAAC,IAAI;QACrB,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC;QACzB,QAAQ,EAAE,WAAW,CAAC,UAAU,CAAC;QACjC,KAAK,EAAE,UAAU,CAAC,IAAI,CAAC,QAAQ,EAAE;QACjC,OAAO,EAAE,UAAU,CAAC,UAAU,CAAC;KAClC,CAAC,CAAC;AACP,CAAC;AAED,SAAS,OAAO,CAAC,UAAiC,EAAE,IAAuB;IACvE,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,UAAU,EAAE,CAAC;QAC/B,OAAO;IACX,CAAC;IAED,MAAM,OAAO,GAAG,EAAE,CAAC;IACnB,UAAU,CAAC,QAAQ,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC,CAAC;IAE/C,IAAI,CAAC,IAAI,CAAC;QACN,IAAI,EAAE,MAAM;QACZ,IAAI,EAAE,UAAU,CAAC,IAAI;QACrB,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC;QACzB,QAAQ,EAAE,WAAW,CAAC,UAAU,CAAC;QACjC,OAAO,EAAE,OAAO;QAChB,OAAO,EAAE,UAAU,CAAC,UAAU,CAAC;KAClC,CAAC,CAAC;AACP,CAAC;AAED,SAAS,aAAa,CAAC,UAAiC,EAAE,IAAkB;IACxE,IAAI,CAAC,IAAI,CAAC;QACN,IAAI,EAAE,UAAU,CAAC,IAAI;QACrB,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC;QACzB,QAAQ,EAAE,WAAW,CAAC,UAAU,CAAC;QACjC,KAAK,EAAE,UAAU,CAAC,YAAY;KACjC,CAAC,CAAC;AACP,CAAC;AAED,SAAS,OAAO,CAAC,UAAsB;;IACnC,OAAO,CAAC,MAAA,UAAU,CAAC,OAAO,0CAAE,SAAS,EAAE,MAAA,UAAU,CAAC,OAAO,0CAAE,IAAI,CAAC;SAC3D,IAAI,CAAC,IAAI,CAAC;SACV,IAAI,EAAE,CAAC;AAChB,CAAC;AAED,SAAS,WAAW,CAAC,UAAiC;;IAClD,OAAO,CAAA,MAAA,MAAA,UAAU,CAAC,OAAO,0CAAE,IAAI,0CAAE,GAAG,CAAC,MAAM,CAAC,KAAI,EAAE,CAAC;AACvD,CAAC;AAED,SAAS,MAAM,CAAC,GAAe;IAC3B,OAAO;QACH,IAAI,EAAE,GAAG,CAAC,OAAO;QACjB,IAAI,EAAE,GAAG,CAAC,IAAI,CAAC,IAAI,EAAE;KACxB,CAAC;AACN,CAAC;AAED,SAAS,UAAU,CAAC,UAAiC;IACjD,OAAO,CACH,UAAU,CAAC,IAAI,KAAK,cAAc,CAAC,QAAQ;QAC3C,UAAU,CAAC,IAAI,CAAC,QAAQ,EAAE,KAAK,UAAU,CAC5C,CAAC;AACN,CAAC;AAED,SAAS,QAAQ,CAAC,UAAiC;IAC/C,OAAO,CACH,UAAU,CAAC,IAAI,KAAK,cAAc,CAAC,QAAQ;QAC3C,UAAU,CAAC,IAAI,CAAC,QAAQ,EAAE,KAAK,UAAU,CAC5C,CAAC;AACN,CAAC;AAED,SAAS,OAAO,CAAC,GAAe;IAC5B,OAAO,GAAG,CAAC,OAAO,KAAK,OAAO,CAAC;AACnC,CAAC;AAED,SAAS,SAAS,CAAC,GAAe;IAC9B,OAAO,GAAG,CAAC,OAAO,KAAK,SAAS,CAAC;AACrC,CAAC;AAED,SAAS,WAAW,CAAC,UAAiC;IAClD,OAAO;QACH,IAAI,EAAE,UAAU,CAAC,IAAI;QACrB,IAAI,EAAE,UAAU,CAAC,IAAI,CAAC,QAAQ,EAAE;QAChC,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC;QACzB,QAAQ,EAAE,WAAW,CAAC,UAAU,CAAC;QACjC,OAAO,EAAE,UAAU,CAAC,YAAY;QAChC,QAAQ,EAAE,UAAU,CAAC,KAAK,CAAC,UAAU;KACxC,CAAC;AACN,CAAC;AAED,SAAS,SAAS,CAAC,UAAiC;;IAChD,MAAM,SAAS,GAAG,YAAY,CAAC,UAAU,CAAC,CAAC;IAE3C,OAAO;QACH,IAAI,EAAE,UAAU,CAAC,IAAI;QACrB,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC;QACzB,QAAQ,EAAE,MAAA,MAAA,UAAU,CAAC,OAAO,0CAAE,IAAI,0CAC5B,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,EACvB,MAAM,CAAC,MAAM,CAAC,SAAS,CAAC,EACxB,GAAG,CAAC,MAAM,CAAC;QAChB,GAAG,SAAS;KACf,CAAC;AACN,CAAC;AAED,SAAS,YAAY,CAAC,UAAsB;IACxC,MAAM,SAAS,GAA6B,EAAE,CAAC;IAC/C,UAAU,CAAC,QAAQ,CAAC,gBAAgB,CAAC,SAAS,CAAC,CAAC,CAAC;IAEjD,OAAO,SAA4B,CAAC;AACxC,CAAC;AAED,SAAS,aAAa,CAAC,UAAiC;;IACpD,OAAO,CACH,CAAA,MAAA,UAAU,CAAC,cAAc,0CAAE,GAAG,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;QACvC,IAAI,EAAE,KAAK,CAAC,IAAI;KACnB,CAAC,CAAC,KAAI,EAAE,CACZ,CAAC;AACN,CAAC;AAED,SAAS,UAAU,CAAC,UAAiC;IACjD,OAAO,UAAU,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;AACxE,CAAC;AAED,SAAS,YAAY,CAAC,SAAoB;IACtC,OAAO;QACH,IAAI,EAAE,SAAS,CAAC,IAAI;QACpB,SAAS,EAAE,SAAS,CAAC,SAAS;KACjC,CAAC;AACN,CAAC","sourcesContent":["import {\n    Application,\n    Decorator,\n    Reflection,\n    ReflectionKind,\n    DeclarationReflection,\n    TypeDocAndTSOptions,\n} from 'typedoc';\nimport {\n    CommentTag,\n    ParameterReflection,\n    SignatureReflection,\n} from 'typedoc/dist/lib/models';\nimport {\n    JsonDocsTag,\n    JsonDocsProp,\n    JsonDocsMethodReturn,\n} from '@stencil/core/internal';\nimport negate from 'lodash/negate';\nimport {\n    InterfaceDescription,\n    AliasDescription,\n    EnumDescription,\n    EnumMember,\n    TypeDescription,\n    MethodDescription,\n    ParameterDescription,\n    ClassDescription,\n} from '../types';\nimport { existsSync } from 'fs';\n\ninterface MethodSignature {\n    parameters: ParameterDescription[];\n    returns: JsonDocsMethodReturn;\n}\n\nexport function parseFile(filename: string): TypeDescription[] {\n    if (!existsSync(filename)) {\n        // eslint-disable-next-line no-console\n        console.warn('typeRoot file does not exist', filename);\n\n        return [];\n    }\n\n    const app = new Application();\n    const options: Partial<TypeDocAndTSOptions> = {\n        readme: 'none',\n        ignoreCompilerErrors: true,\n    };\n\n    if (filename.endsWith('.d.ts')) {\n        options.includeDeclarations = true;\n        options.exclude = ['**/+(*test*|node_modules)/**'];\n    }\n\n    app.bootstrap(options);\n\n    const reflection = app.convert([filename]);\n    if (!reflection) {\n        // eslint-disable-next-line no-console\n        console.warn('Could not find any type information');\n\n        return [];\n    }\n\n    const data: TypeDescription[] = [];\n    reflection.traverse(traverseCallback(data));\n\n    return data;\n}\n\nconst fns = {\n    [ReflectionKind.Interface]: addInterface,\n    [ReflectionKind.Class]: addClass,\n    [ReflectionKind.CallSignature]: addSignature,\n    [ReflectionKind.Parameter]: addParam,\n    [ReflectionKind.TypeAlias]: addType,\n    // [ReflectionKind.TypeLiteral]: addType,\n    [ReflectionKind.Enum]: addEnum,\n    [ReflectionKind.EnumMember]: addEnumMember,\n};\n\nconst traverseCallback = (data: any) => (reflection: Reflection) => {\n    const fn = fns[reflection.kind];\n    if (fn) {\n        fn(reflection, data);\n    } else {\n        reflection.traverse(traverseCallback(data));\n    }\n};\n\nfunction addInterface(\n    reflection: DeclarationReflection,\n    data: InterfaceDescription[],\n) {\n    if (!reflection.flags.isExported) {\n        return;\n    }\n\n    data.push({\n        type: 'interface',\n        name: reflection.name,\n        typeParams: getTypeParams(reflection),\n        docs: getDocs(reflection),\n        docsTags: getDocsTags(reflection),\n        props: reflection.children.filter(isProperty).map(getProperty),\n        methods: reflection.children.filter(isMethod).map(getMethod),\n        sources: getSources(reflection),\n    });\n}\n\nfunction addClass(reflection: DeclarationReflection, data: ClassDescription[]) {\n    if (!reflection.flags.isExported) {\n        return;\n    }\n\n    data.push({\n        type: 'class',\n        name: reflection.name,\n        typeParams: getTypeParams(reflection),\n        docs: getDocs(reflection),\n        docsTags: getDocsTags(reflection),\n        props: reflection.children?.filter(isProperty).map(getProperty),\n        methods: reflection.children?.filter(isMethod).map(getMethod),\n        sources: getSources(reflection),\n        decorators: reflection.decorators?.map(getDecorator),\n    });\n}\n\nfunction addSignature(reflection: SignatureReflection, data: MethodSignature) {\n    if (Array.isArray(data)) {\n        return;\n    }\n\n    data.parameters = [];\n    data.returns = {\n        type: reflection.type.toString(),\n        docs:\n            reflection.parent.parent.comment?.tags?.find(isReturns)?.text || '',\n    };\n\n    reflection.traverse(traverseCallback(data));\n}\n\nfunction addParam(reflection: ParameterReflection, data: MethodSignature) {\n    data.parameters.push({\n        name: reflection.name,\n        type: reflection.type.toString(),\n        docs:\n            reflection.parent.parent.parent.comment?.tags\n                ?.filter(isParam)\n                .find((tag) => tag.paramName === reflection.name)\n                ?.text.trim() || '',\n        default: reflection.defaultValue,\n        optional: reflection.flags.isOptional,\n    });\n}\n\nfunction addType(reflection: DeclarationReflection, data: AliasDescription[]) {\n    if (!reflection.flags.isExported) {\n        return;\n    }\n\n    data.push({\n        type: 'alias',\n        name: reflection.name,\n        docs: getDocs(reflection),\n        docsTags: getDocsTags(reflection),\n        alias: reflection.type.toString(),\n        sources: getSources(reflection),\n    });\n}\n\nfunction addEnum(reflection: DeclarationReflection, data: EnumDescription[]) {\n    if (!reflection.flags.isExported) {\n        return;\n    }\n\n    const members = [];\n    reflection.traverse(traverseCallback(members));\n\n    data.push({\n        type: 'enum',\n        name: reflection.name,\n        docs: getDocs(reflection),\n        docsTags: getDocsTags(reflection),\n        members: members,\n        sources: getSources(reflection),\n    });\n}\n\nfunction addEnumMember(reflection: DeclarationReflection, data: EnumMember[]) {\n    data.push({\n        name: reflection.name,\n        docs: getDocs(reflection),\n        docsTags: getDocsTags(reflection),\n        value: reflection.defaultValue,\n    });\n}\n\nfunction getDocs(reflection: Reflection): string {\n    return [reflection.comment?.shortText, reflection.comment?.text]\n        .join('\\n')\n        .trim();\n}\n\nfunction getDocsTags(reflection: DeclarationReflection) {\n    return reflection.comment?.tags?.map(getTag) || [];\n}\n\nfunction getTag(tag: CommentTag): JsonDocsTag {\n    return {\n        name: tag.tagName,\n        text: tag.text.trim(),\n    };\n}\n\nfunction isProperty(reflection: DeclarationReflection): boolean {\n    return (\n        reflection.kind === ReflectionKind.Property &&\n        reflection.type.toString() !== 'function'\n    );\n}\n\nfunction isMethod(reflection: DeclarationReflection): boolean {\n    return (\n        reflection.kind === ReflectionKind.Property &&\n        reflection.type.toString() === 'function'\n    );\n}\n\nfunction isParam(tag: CommentTag): boolean {\n    return tag.tagName === 'param';\n}\n\nfunction isReturns(tag: CommentTag): boolean {\n    return tag.tagName === 'returns';\n}\n\nfunction getProperty(reflection: DeclarationReflection): Partial<JsonDocsProp> {\n    return {\n        name: reflection.name,\n        type: reflection.type.toString(),\n        docs: getDocs(reflection),\n        docsTags: getDocsTags(reflection),\n        default: reflection.defaultValue,\n        optional: reflection.flags.isOptional,\n    };\n}\n\nfunction getMethod(reflection: DeclarationReflection): MethodDescription {\n    const signature = getSignature(reflection);\n\n    return {\n        name: reflection.name,\n        docs: getDocs(reflection),\n        docsTags: reflection.comment?.tags\n            ?.filter(negate(isParam))\n            .filter(negate(isReturns))\n            .map(getTag),\n        ...signature,\n    };\n}\n\nfunction getSignature(reflection: Reflection): MethodSignature {\n    const signature: Partial<MethodSignature> = {};\n    reflection.traverse(traverseCallback(signature));\n\n    return signature as MethodSignature;\n}\n\nfunction getTypeParams(reflection: DeclarationReflection) {\n    return (\n        reflection.typeParameters?.map((param) => ({\n            name: param.name,\n        })) || []\n    );\n}\n\nfunction getSources(reflection: DeclarationReflection) {\n    return reflection.sources.map((source) => source.file.fullFileName);\n}\n\nfunction getDecorator(decorator: Decorator) {\n    return {\n        name: decorator.name,\n        arguments: decorator.arguments,\n    };\n}\n"]}