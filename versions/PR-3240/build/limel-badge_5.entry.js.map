{"version":3,"names":["badgeCss","Badge","render","h","Host","title","this","labelIsLarge","label","class","renderLabel","abbreviate","largeNumericLabel","largeStringLabel","length","breadcrumbsCss","Breadcrumbs","renderSteps","allStepsWithoutLast","items","slice","areItemsLinks","map","renderAsLink","renderAsButton","item","tooltipId","createRandomString","role","id","onClick","handleClick","renderIcon","renderTooltip","href","link","renderLastStep","lastItem","tabindex","text","name","getIconName","icon","color","getIconColor","style","type","elementId","some","event","stopPropagation","select","emit","divider","componentWillLoad","makeEnterClickable","host","disconnectedCallback","removeEnterClickable","inputFieldCss","DEBOUNCE_TIMEOUT","InputField","constructor","hostRef","completionsList","changeWaiting","initialize","element","limelInputField","shadowRoot","querySelector","mdcTextField","MDCTextField","value","invalid","valid","mapCompletions","window","addEventListener","layout","passive","setFocus","completions","focus","getContainerClassList","classList","isInvalid","disabled","readonly","required","isEmpty","hasPrefix","hasSuffix","helperText","maxlength","leadingIcon","getTrailingIcon","_a","inputElement","validity","badInput","getCurrentValue","renderInput","properties","Object","assign","pattern","onWheel","handleWheel","onKeyDown","placeholder","renderTextarea","getAdditionalProps","props","step","Number","isInteger","min","max","minlength","onFocus","isFocused","showCompletions","onBlur","validate","changeEmitter","flush","hasHelperText","undefined","hasHelperLine","renderHelperLine","helperTextId","maxLength","renderEmptyValueForReadonly","renderSuffix","suffix","renderPrefix","prefix","wasInvalid","checkValidity","setInputElement","labelClassList","labelId","renderLeadingIcon","renderTrailingLinkOrButton","trailingIcon","hasLink","renderLinkIcon","getLink","renderTrailingIcon","showLink","includes","getHref","target","getTarget","linkProps","key","tabIndex","handleIconKeyPress","handleIconClick","renderFormattedNumber","renderValue","formatNumber","Intl","NumberFormat","locale","format","isForwardTab","TAB","keyCode","TAB_KEY_CODE","altKey","metaKey","shiftKey","isUp","ARROW_UP","ARROW_UP_KEY_CODE","isDown","ARROW_DOWN","ARROW_DOWN_KEY_CODE","list","document","portalId","preventDefault","listElement","handleCompletionChange","detail","renderAutocompleteList","dropdownZIndex","getComputedStyle","getPropertyValue","visible","containerId","inheritParentWidth","containerStyle","open","allowClicksElement","display","onDismiss","handleCloseMenu","renderListResult","filteredCompletions","filterCompletions","onChange","handleKeyDownInDropdown","keyFound","ESCAPE","ENTER","keyCodeFound","ESCAPE_KEY_CODE","ENTER_KEY_CODE","filter","completion","toLowerCase","indexOf","handleInput","data","debounce","change","handleChange","action","isEnter","isSpace","SPACE","SPACE_KEY_CODE","globalConfig","defaultLocale","connectedCallback","componentDidLoad","destroy","removeEventListener","componentDidUpdate","ref","onInput","ariaControls","valueWatcher","newValue","completionsWatcher","menuCss","DEFAULT_ROOT_BREADCRUMBS_ITEM","Menu","renderLoader","loadingSubItems","loading","cssProperties","getCssProperties","width","padding","size","limeBranded","renderBreadcrumb","breadcrumbsItems","getBreadcrumbsItems","onSelect","handleBreadcrumbsSelect","menuItem","currentSubMenu","clearSearch","navigateMenu","handleSelect","renderSearchField","searcher","setSearchElement","searchValue","handleTextInput","handleInputKeyDown","renderEmptyMessage","emptyResultMessage","Array","isArray","searchResults","renderMenuList","visibleItems","gridLayout","badgeIcons","setListElement","handleMenuKeyDown","async","query","result","listItems","querySelectorAll","isBackwardTab","isLeft","ARROW_LEFT","ARROW_LEFT_KEY_CODE","isRight","ARROW_RIGHT","ARROW_RIGHT_KEY_CODE","searchInput","currentItem","getCurrentItem","goForward","goBack","activeItem","_b","attrIndex","_c","attributes","getNamedItem","dataIndex","parseInt","parent","parentItem","setTriggerAttributes","entries","removeAttribute","setAttribute","String","onClose","cancel","onTriggerClick","selectOnEmptyChildren","selectedMenuItem","isFunction","menuLoader","subItems","setTimeout","observer","IntersectionObserver","unobserve","activeElement","observe","focusMenuItem","blur","menuItems","isMenuItem","selectedIndex","Math","findIndex","selected","menuElements","from","renderNotificationBadge","hasNotificationBadge","badge","setTriggerRef","elm","triggerElement","componentDidRender","slotElement","assignedElements","forEach","menuSurfaceWidth","getMenuSurfaceWidth","openDirection","position","itemsWatcher","openWatcher","breadCrumbItems","push","rootItem","reverse","propertyNames","values","property","zipObject","customWidth","surfaceWidth","assignedTriggers","clientWidth","_d","cssClasses","MENU_SELECTED_LIST_ITEM","MENU_SELECTION_GROUP","ROOT","strings","ARIA_CHECKED_ATTR","ARIA_DISABLED_ATTR","CHECKBOX_SELECTOR","LIST_SELECTOR","SELECTED_EVENT","SKIP_RESTORE_FOCUS","numbers","FOCUS_ROOT_INDEX","DefaultFocusState","MDCMenuFoundation","_super","__extends","adapter","_this","call","__assign","defaultAdapter","closeAnimationEndTimerId","defaultFocusState","LIST_ROOT","defineProperty","get","enumerable","configurable","addClassToElementAtIndex","removeClassFromElementAtIndex","addAttributeToElementAtIndex","removeAttributeFromElementAtIndex","getAttributeFromElementAtIndex","elementContainsClass","closeSurface","getElementIndex","notifySelected","getMenuItemCount","focusItemAtIndex","focusListRoot","getSelectedSiblingOfItemAtIndex","isSelectableItemAtIndex","prototype","clearTimeout","handleKeydown","evt","isTab","handleItemAction","listItem","index","skipRestoreFocus","recomputedIndex","setSelectedIndex","MDCMenuSurfaceFoundation","TRANSITION_CLOSE_DURATION","handleMenuSurfaceOpened","FIRST_ITEM","LAST_ITEM","NONE","setDefaultFocusState","focusState","getSelectedIndex","validatedIndex","Error","prevSelectedIndex","setEnabled","isEnabled","listCssClasses","LIST_ITEM_DISABLED_CLASS","menuSize","isIndexInRange","MDCFoundation","MDCMenu","apply","arguments","attachTo","root","menuSurfaceFactory","listFactory","el","MDCMenuSurface","MDCList","initialSyncWithDOM","menuSurface","wrapFocus","foundation","listen","OPENED_EVENT","MDCListFoundation","ACTION_EVENT","unlisten","isOpen","set","close","hasTypeahead","typeaheadInProgress","typeaheadMatchItem","nextChar","startingIndex","listElements","singleSelection","listConstants","UNSET_INDEX","quickOpen","setAnchorCorner","corner","setAnchorMargin","margin","getOptionByIndex","getPrimaryTextAtIndex","getPrimaryText","setFixedPosition","isFixed","setIsHoisted","isHoisted","setAbsolutePosition","x","y","setAnchorElement","anchorElement","getDefaultFoundation","className","add","remove","attr","getAttribute","contains","evtData","closest","selectionGroupEl","selectedItemEl","MDCComponent","MenuListRenderer","defaultConfig","getIndexForWhichToApplyTabIndex","i","renderMenuItem","rendertext","classNames","applyTabIndexToItemAtIndex","config","renderText","renderSubMenuIcon","renderNotification","twoLines","avatarList","renderDivider","isSimpleItem","renderCommandText","secondaryText","hasSubItems","commandText","iconColor","iconSize","classes","commandKey","hasIcons","selectable","menuListCss","menuStrings","MenuList","setup","setupMenu","setupListeners","mdcMenu","teardown","MDCRipple","handleMenuSelect","handleSingleSelect","MenuItems","selectedItem","find","triggerIconColorWarning","html","handleType","itemsChanged","console","warn"],"sources":["./src/components/badge/badge.scss?tag=limel-badge&encapsulation=shadow","./src/components/badge/badge.tsx","./src/components/breadcrumbs/breadcrumbs.scss?tag=limel-breadcrumbs&encapsulation=shadow","./src/components/breadcrumbs/breadcrumbs.tsx","./src/components/input-field/input-field.scss?tag=limel-input-field&encapsulation=shadow","./src/components/input-field/input-field.tsx","./src/components/menu/menu.scss?tag=limel-menu&encapsulation=shadow","./src/components/menu/menu.tsx","./node_modules/@material/menu/constants.js","./node_modules/@material/menu/foundation.js","./node_modules/@material/menu/component.js","./src/components/menu-list/menu-list-renderer.tsx","./src/components/menu-list/menu-list.scss?tag=limel-menu-list&encapsulation=shadow","./src/components/menu-list/menu-list.tsx"],"sourcesContent":["@use '../../style/functions';\n@use '../../style/internal/lime-theme';\n@use '../../style/mixins';\n\n/**\n * @prop --badge-background-color: badge background color\n * @prop --badge-text-color: badge text color\n */\n\n:host([hidden]) {\n    display: none;\n}\n\n:host(limel-badge) {\n    --limel-min-badge-size: 1rem;\n    display: inline-flex;\n    justify-content: center;\n    align-items: center;\n    flex-shrink: 0;\n    min-height: var(--limel-min-badge-size);\n    min-width: var(--limel-min-badge-size);\n}\n\nspan {\n    cursor: default;\n    box-sizing: border-box;\n\n    @include mixins.truncate-text;\n    text-align: center;\n    font-size: functions.pxToRem(11);\n    line-height: var(--limel-min-badge-size);\n\n    color: var(--badge-text-color, rgb(var(--contrast-1200)));\n\n    border-radius: var(--limel-min-badge-size);\n    max-height: var(--limel-min-badge-size);\n    min-width: 0.5rem;\n    min-height: 0.5rem;\n\n    background-color: var(--badge-background-color, rgb(var(--contrast-500)));\n\n    &:not(:empty) {\n        min-width: var(\n            --limel-min-badge-size\n        ); // ensures that a badge with only one character rendered as perfect circle\n        max-width: 2.75rem;\n        padding: 0 functions.pxToRem(4.5);\n    }\n}\n\n:host(.has-large-label) {\n    span {\n        cursor: help;\n    }\n}\n","import { Component, Prop, h, Host } from '@stencil/core';\nimport { abbreviate } from './format';\n\n/**\n * The Badge component can be used to display a notification badge,\n * optionally with a number or a text label.\n *\n * @exampleComponent limel-example-badge\n * @exampleComponent limel-example-badge-number\n * @exampleComponent limel-example-badge-string\n */\n@Component({\n    tag: 'limel-badge',\n    styleUrl: 'badge.scss',\n    shadow: true,\n})\nexport class Badge {\n    /**\n     * Label to display in the badge.\n     * Numeric labels larger than 999 will be rounded and abbreviated.\n     * String labels get truncated if their length is longer than\n     * six characters.\n     */\n    @Prop({ reflect: true })\n    public label?: number | string;\n\n    public render() {\n        return (\n            <Host\n                title={this.labelIsLarge() ? this.label : ''}\n                class={{\n                    'has-large-label': this.labelIsLarge(),\n                }}\n            >\n                <span>{this.renderLabel()}</span>\n            </Host>\n        );\n    }\n\n    private renderLabel() {\n        if (typeof this.label === 'number') {\n            return abbreviate(this.label);\n        }\n\n        return this.label;\n    }\n\n    private labelIsLarge() {\n        const largeNumericLabel = 999;\n        const largeStringLabel = 6;\n        if (\n            (typeof this.label === 'number' &&\n                this.label > largeNumericLabel) ||\n            (typeof this.label === 'string' &&\n                this.label.length > largeStringLabel)\n        ) {\n            return true;\n        }\n    }\n}\n","@use '../../style/mixins';\n\n/**\n* @prop --breadcrumbs-item-text-color: Text color of breadcrumbs items, defaults to `--contrast-1100`.\n* @prop --breadcrumbs-item-max-width: Maximum width of a button in the breadcrumbs. Defaults to `10rem`. Keep in mind that the buttons should not appear too big.\n*/\n\n$padding: 0.5rem;\n\n:host(limel-breadcrumbs) {\n    --limel-breadcrumbs-item-height: 1.5rem;\n    --limel-breadcrumbs-gap: 0.75rem;\n    --limel-breadcrumbs-gap: 0.75rem;\n    --limel-breadcrumbs-item-text-color: var(\n        --breadcrumbs-item-text-color,\n        rgb(var(--contrast-1500))\n    );\n    @include mixins.fade-out-overflowed-content-on-edges(horizontally);\n    --limel-left-edge-fade-width: #{$padding};\n    --limel-right-edge-fade-width: #{$padding};\n}\n\nol,\nli,\n.step {\n    all: unset;\n}\n\n* {\n    box-sizing: border-box;\n}\n\nol {\n    padding: $padding; // needed for the focus and hover effects, since we are using overflow\n    gap: var(--limel-breadcrumbs-gap);\n}\n\n.step {\n    position: relative;\n\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    gap: 0.25rem;\n\n    max-width: var(--breadcrumbs-item-max-width, 10rem);\n    height: var(--limel-breadcrumbs-item-height);\n\n    color: var(--limel-breadcrumbs-item-text-color);\n    border-radius: 100vw;\n    font-size: 0.875rem;\n    padding: 0 0.25rem;\n\n    &:not(:has(.text)) {\n        padding: 0 0.125rem;\n    }\n\n    &:not(.last) {\n        @include mixins.visualize-keyboard-focus;\n\n        &:after {\n            content: var(--limel-breadcrumbs-divider);\n            display: flex;\n            align-items: center;\n            justify-content: center;\n\n            width: var(--limel-breadcrumbs-gap);\n\n            position: absolute;\n            top: 0;\n            right: calc(var(--limel-breadcrumbs-gap) * -1);\n            bottom: 0;\n            left: auto;\n\n            text-align: center;\n        }\n    }\n}\n\na.step {\n    @include mixins.hyperlink($color: var(--limel-breadcrumbs-item-text-color));\n}\n\nbutton.step {\n    &:not(.last) {\n        @include mixins.is-flat-clickable(\n            $color: var(--limel-breadcrumbs-item-text-color)\n        );\n    }\n}\n\nlimel-icon {\n    flex-shrink: 0;\n    width: calc(var(--limel-breadcrumbs-item-height) - 0.25rem);\n    height: calc(var(--limel-breadcrumbs-item-height) - 0.25rem);\n}\n\n.text {\n    @include mixins.truncate-text;\n    padding: 0 0.25rem;\n}\n\n.last {\n    opacity: 0.7;\n}\n\n// LAYOUT:\n// The code below makes sure that the last item is always visible,\n// and previous items overflow out of the container\n// while keeping the container scrollable.\n// All without any additional scripts in the component code.\n\n:host(limel-breadcrumbs) {\n    box-sizing: border-box;\n\n    display: flex;\n    width: 100%;\n    overflow-x: auto;\n    scrollbar-width: none; // This hides the scrollbars appearing under in Firefox\n    -ms-overflow-style: none; // Same as above for IE 11\n    &::-webkit-scrollbar {\n        display: none; // This hides the scrollbars appearing under in Chrome\n    }\n\n    direction: rtl;\n}\n\nol {\n    display: flex;\n    flex-direction: row-reverse;\n    justify-content: flex-end;\n    margin-right: auto;\n}\n\n.step {\n    direction: ltr;\n}\n","import {\n    Component,\n    Element,\n    h,\n    Event,\n    EventEmitter,\n    Prop,\n} from '@stencil/core';\nimport { BreadcrumbsItem } from './breadcrumbs.types';\nimport {\n    makeEnterClickable,\n    removeEnterClickable,\n} from '../../util/make-enter-clickable';\nimport { createRandomString } from '../../util/random-string';\nimport { getIconColor, getIconName } from '../icon/get-icon-props';\n\n/**\n * A Breadcrumb consists of a list of distinct \"places\" that a user has gone through,\n * before ending up where they are right now, in a website or an application.\n *\n * These \"places\" can be for example _pages_ of a website, which are hierarchically\n * laid out before the current page that the user is looking at.\n * They could also be _steps_ which the user has gone through, which perhaps have no\n * hierarchical relation with each other, but has eventually led the user \"here\".\n *\n * :::note\n * - Where the user currently is, is always the last step of the breadcrumb.\n * - A breadcrumbs never shows where users can go after this place.\n * It only illustrates where user has been before ending up here.\n * If the path that a user can take is not changing and if next steps are clear,\n * you can use the [Progress flow component](#/component/limel-progress-flow) instead.\n * :::\n *\n * Breadcrumbs are often placed horizontally before the main content of the current screen.\n *\n * @exampleComponent limel-example-breadcrumbs-links\n * @exampleComponent limel-example-breadcrumbs-buttons\n * @exampleComponent limel-example-breadcrumbs-icons\n * @exampleComponent limel-example-breadcrumbs-divider\n * @exampleComponent limel-example-breadcrumbs-icon-color\n * @exampleComponent limel-example-breadcrumbs-styling\n */\n\n@Component({\n    tag: 'limel-breadcrumbs',\n    shadow: true,\n    styleUrl: 'breadcrumbs.scss',\n})\nexport class Breadcrumbs {\n    /**\n     * List of items in the breadcrumbs,\n     * each representing a step or a page.\n     */\n    @Prop()\n    public items: BreadcrumbsItem[];\n\n    /**\n     * The visual divider that separates items.\n     * It must be a single character such as `-` or `,`.\n     */\n    @Prop()\n    public divider: string = '›';\n\n    /**\n     * Fired when clicking on buttons (not links!)\n     * inside the breadcrumbs.\n     */\n    @Event()\n    public select: EventEmitter<BreadcrumbsItem>;\n\n    @Element()\n    private host: HTMLLimelBreadcrumbsElement;\n\n    public render() {\n        return (\n            <ol\n                role=\"navigation\"\n                aria-label=\"Breadcrumb\"\n                style={{ '--limel-breadcrumbs-divider': `'${this.divider}'` }}\n            >\n                {this.renderSteps()}\n                {this.renderLastStep()}\n            </ol>\n        );\n    }\n\n    public componentWillLoad() {\n        makeEnterClickable(this.host);\n    }\n\n    public disconnectedCallback() {\n        removeEnterClickable(this.host);\n    }\n\n    private renderSteps = () => {\n        const allStepsWithoutLast = this.items.slice(0, -1);\n\n        if (this.areItemsLinks(this.items)) {\n            return allStepsWithoutLast.map(this.renderAsLink);\n        }\n\n        return allStepsWithoutLast.map(this.renderAsButton);\n    };\n\n    private renderAsButton = (item: BreadcrumbsItem) => {\n        const tooltipId = createRandomString();\n\n        return [\n            <button\n                role=\"listitem\"\n                id={tooltipId}\n                class=\"step\"\n                onClick={this.handleClick(item)}\n            >\n                {this.renderIcon(item)}\n                {this.renderLabel(item)}\n            </button>,\n            this.renderTooltip(item, tooltipId),\n        ];\n    };\n\n    private renderAsLink = (item: BreadcrumbsItem) => {\n        const tooltipId = createRandomString();\n\n        return [\n            <a\n                role=\"listitem\"\n                id={tooltipId}\n                class=\"step\"\n                href={item.link.href}\n                title={item.link.title}\n            >\n                {this.renderIcon(item)}\n                {this.renderLabel(item)}\n            </a>,\n            this.renderTooltip(item, tooltipId),\n        ];\n    };\n\n    private renderLastStep = () => {\n        const lastItem = this.items.slice(-1);\n\n        return (\n            <li\n                class=\"last step\"\n                tabindex=\"-1\"\n                aria-current={this.areItemsLinks(this.items) ? 'page' : 'step'}\n            >\n                {this.renderIcon(lastItem[0])}\n                <span class=\"text\">{lastItem[0].text}</span>\n            </li>\n        );\n    };\n\n    private renderIcon = (item: BreadcrumbsItem) => {\n        const name = getIconName(item.icon);\n        const color = getIconColor(item.icon);\n\n        if (!name) {\n            return;\n        }\n\n        return (\n            <limel-icon\n                style={{\n                    color: `${color}`,\n                }}\n                name={name}\n            />\n        );\n    };\n\n    private renderLabel = (item: BreadcrumbsItem) => {\n        if (item.type === 'icon-only') {\n            return;\n        }\n\n        return <span class=\"text\">{item.text}</span>;\n    };\n\n    private renderTooltip = (item: BreadcrumbsItem, tooltipId: string) => {\n        if (item.type === 'icon-only') {\n            return <limel-tooltip elementId={tooltipId} label={item.text} />;\n        }\n    };\n\n    private areItemsLinks = (items: BreadcrumbsItem[]) => {\n        return items.some((item) => 'link' in item);\n    };\n\n    private handleClick = (item: BreadcrumbsItem) => (event: MouseEvent) => {\n        event.stopPropagation();\n        this.select.emit(item);\n    };\n}\n","@use '../../style/internal/z-index';\n@use '../../style/functions';\n@use '../../style/internal/shared_input-select-picker';\n@use '../../style/mixins';\n\n@use '../../style/internal/lime-theme';\n\n@use '@material/textfield';\n@use '@material/textfield/icon';\n@use '@material/notched-outline/mdc-notched-outline';\n@use '@material/floating-label';\n@use '@material/floating-label/mdc-floating-label';\n@use '@material/ripple';\n@use '@material/list';\n@use '@material/elevation';\n@use '@material/menu-surface';\n\n/**\n * @prop --textarea-height: Height of the field when type is set to `textarea`\n */\n\n:host {\n    position: relative;\n    display: block;\n}\n\n:host([hidden]) {\n    display: none;\n}\n\n:host([type='textarea']) {\n    height: var(--textarea-height, 100%);\n\n    .mdc-text-field.mdc-text-field--textarea {\n        height: var(--textarea-height, 100%);\n\n        .mdc-text-field__input {\n            @include shared_input-select-picker.input-field-placeholder;\n            margin-top: functions.pxToRem(8);\n            margin-bottom: 0;\n        }\n    }\n}\n\n@include mixins.hide-helper-line-when-not-needed(limel-input-field);\n\n@include textfield.core-styles;\n@include icon.icon-core-styles;\n\n@include shared_input-select-picker.outlined-style-overrides;\n@include shared_input-select-picker.readonly-overrides;\n@include shared_input-select-picker.cropped-label-hack;\n@include shared_input-select-picker.disabled-overrides;\n@include shared_input-select-picker.leading-icon;\n@include shared_input-select-picker.trailing-icon;\n@include shared_input-select-picker.floating-label-overrides;\n@include shared_input-select-picker.lime-empty-value-for-readonly;\n@include shared_input-select-picker.lime-looks-like-input-value;\n\n.lime-text-field--empty {\n    .mdc-text-field__icon--trailing {\n        @include shared_input-select-picker.looks-disabled;\n        pointer-events: none;\n        box-shadow: none !important;\n    }\n}\n\n.mdc-text-field {\n    width: 100%;\n\n    &:not(.mdc-text-field--disabled) {\n        .mdc-text-field__affix,\n        .mdc-text-field__icon {\n            color: rgb(var(--contrast-900));\n        }\n    }\n    &.mdc-text-field--disabled {\n        .mdc-text-field__affix,\n        .mdc-text-field__icon {\n            color: rgb(var(--contrast-700));\n        }\n    }\n}\n\n.lime-formatted-input {\n    display: none;\n    width: calc(100% - #{functions.pxToRem(20)});\n    z-index: z-index.$input-field--formatted-value;\n\n    pointer-events: none;\n\n    .mdc-text-field:not(.mdc-text-field--focused):not(.mdc-text-field--invalid)\n        & {\n        display: block;\n    }\n\n    + .mdc-text-field__input {\n        z-index: z-index.$input-field--input-with-formatted-value;\n    }\n}\n\n.mdc-text-field:not(.mdc-text-field--focused):not(.mdc-text-field--invalid) {\n    .mdc-text-field__input[type='number'] {\n        color: transparent;\n        -webkit-text-fill-color: transparent;\n    }\n\n    &.lime-text-field--readonly {\n        .mdc-text-field__input[type='number'] {\n            visibility: hidden;\n            // Not having `visibility: hidden;` makes the unformatted\n            // value selectable; which is not so nice when users\n            // click drag to select content on the screen.\n            // The reason to have it only on `readonly` mode is\n            // 1. This is the use case where it makes most sense\n            // 2. We don't want to repeat the same thing in the\n            // accessibility tree, and make it readable for assistive\n            // technologies.\n            // 3. When not readonly, clicking on the `<input />`\n            // element sets the focus and activates the edit mode.\n            // So we cannot always have it `hidden` on.\n            // which is why we have instead\n            // `color: transparent` a few lines before this.\n        }\n    }\n}\n\n.autocomplete-list-container {\n    position: relative;\n}\n\n.autocomplete-list {\n    background-color: var(--lime-elevated-surface-background-color);\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    max-height: functions.pxToRem(200);\n    overflow-y: auto;\n}\n\n.mdc-deprecated-list-item {\n    cursor: pointer;\n}\n\ninput.mdc-text-field__input {\n    @include shared_input-select-picker.input-field-placeholder;\n\n    &::-webkit-search-cancel-button {\n        @include mixins.clear-all-button;\n\n        -webkit-appearance: none;\n\n        position: absolute;\n        right: 0;\n        top: 0;\n        bottom: 0;\n        margin: auto;\n\n        &:active {\n            transform: none; //Makes the \"clear-all button\" work\n        }\n        .mdc-text-field--label-floating & {\n            opacity: 1;\n        }\n    }\n}\n\n@import './partial-styles/trailing-icon.scss';\n@import './partial-styles/readonly';\n\n// To make the input field render smaller than the default MDC UI\n.mdc-text-field {\n    &.mdc-text-field--outlined {\n        height: shared_input-select-picker.$height-of-mdc-text-field;\n    }\n}\n.mdc-text-field--with-trailing-icon {\n    .mdc-text-field__icon:last-child {\n        padding: 0.25rem;\n        margin-right: 0.25rem;\n    }\n}\n.mdc-text-field--outlined.mdc-text-field--with-leading-icon {\n    .mdc-text-field__icon--leading {\n        margin-left: 0.25rem;\n    }\n    .mdc-floating-label {\n        left: 1.5rem;\n    }\n}\n","import { MDCTextField } from '@material/textfield';\nimport {\n    Component,\n    Element,\n    Event,\n    EventEmitter,\n    h,\n    Prop,\n    State,\n    Watch,\n} from '@stencil/core';\nimport { debounce } from 'lodash-es';\nimport {\n    ARROW_DOWN,\n    ARROW_DOWN_KEY_CODE,\n    ARROW_UP,\n    ARROW_UP_KEY_CODE,\n    ENTER,\n    ENTER_KEY_CODE,\n    ESCAPE,\n    ESCAPE_KEY_CODE,\n    SPACE,\n    SPACE_KEY_CODE,\n    TAB,\n    TAB_KEY_CODE,\n} from '../../util/keycodes';\nimport { InputType } from '../input-field/input-field.types';\nimport { ListItem } from '../list/list-item.types';\nimport { getHref, getTarget } from '../../util/link-helper';\nimport { JSXBase } from '@stencil/core/internal';\nimport { createRandomString } from '../../util/random-string';\nimport { LimelListCustomEvent } from '../../components';\nimport { globalConfig } from '../../global/config';\n\ninterface LinkProperties {\n    href: string;\n    target?: string;\n}\n\nconst DEBOUNCE_TIMEOUT = 300;\n\n/**\n * @exampleComponent limel-example-input-field-text\n * @exampleComponent limel-example-input-field-placeholder\n * @exampleComponent limel-example-input-field-text-multiple\n * @exampleComponent limel-example-input-field-number\n * @exampleComponent limel-example-input-field-autocomplete\n * @exampleComponent limel-example-input-field-icon-leading\n * @exampleComponent limel-example-input-field-icon-trailing\n * @exampleComponent limel-example-input-field-icon-both\n * @exampleComponent limel-example-input-field-showlink\n * @exampleComponent limel-example-input-field-error-icon\n * @exampleComponent limel-example-input-field-textarea\n * @exampleComponent limel-example-input-field-suffix\n * @exampleComponent limel-example-input-field-prefix\n * @exampleComponent limel-example-input-field-search\n * @exampleComponent limel-example-input-field-pattern\n * @exampleComponent limel-example-input-field-focus\n */\n@Component({\n    tag: 'limel-input-field',\n    shadow: true,\n    styleUrl: 'input-field.scss',\n})\nexport class InputField {\n    /**\n     * Set to `true` to disable the field.\n     * Use `disabled` to indicate that the field can normally be interacted\n     * with, but is currently disabled. This tells the user that if certain\n     * requirements are met, the field may become enabled again.\n     */\n    @Prop({ reflect: true })\n    public disabled = false;\n\n    /**\n     * Set to `true` to make the field read-only.\n     * Use `readonly` when the field is only there to present the data it holds,\n     * and will not become possible for the current user to edit.\n     */\n    @Prop({ reflect: true })\n    public readonly = false;\n\n    /**\n     * Set to `true` to indicate that the current value of the input field is\n     * invalid.\n     */\n    @Prop({ reflect: true })\n    public invalid = false;\n\n    /**\n     * The input label.\n     */\n    @Prop({ reflect: true })\n    public label: string;\n\n    /**\n     * The placeholder text shown inside the input field, when the field is focused and empty.\n     */\n    @Prop({ reflect: true })\n    public placeholder: string;\n\n    /**\n     * Optional helper text to display below the input field when it has focus\n     */\n    @Prop({ reflect: true })\n    public helperText: string;\n\n    /**\n     * A short piece of text to display before the value inside the input field.\n     * Displayed for all types except `textarea`.\n     */\n    @Prop({ reflect: true })\n    public prefix: string;\n\n    /**\n     * A short piece of text to display after the value inside the input field.\n     * Displayed for all types except `textarea`.\n     */\n    @Prop({ reflect: true })\n    public suffix: string;\n\n    /**\n     * Set to `true` to indicate that the field is required.\n     */\n    @Prop({ reflect: true })\n    public required = false;\n\n    /**\n     * The value of the field.\n     */\n    @Prop({ reflect: true })\n    public value: string;\n\n    /**\n     * Trailing icon to show to the far right in the field.\n     */\n    @Prop({ reflect: true })\n    public trailingIcon: string;\n\n    /**\n     * Leading icon to show to the far left in the field.\n     */\n    @Prop({ reflect: true })\n    public leadingIcon: string;\n\n    /**\n     * Regular expression that the current value of the input field must match.\n     * No forward slashes should be specified around the pattern.\n     * Only used if type is `text`, `tel`, `email`, `url`, `urlAsText`,\n     * `password`, or `search`.\n     */\n    @Prop({ reflect: true })\n    public pattern: string;\n\n    /**\n     * Type of input.\n     *\n     * Note** regarding type `url`: `limel-input` uses the native validation\n     * built into the browser for many types of input fields. The native\n     * validation for `url` is very strict, and does not allow relative urls,\n     * nor any other formats that are not a \"fully qualified\" url. To allow\n     * such urls, use the type `urlAsText` instead. `urlAsText` works exactly\n     * like `text` in all regards, except that it enables use of the `showLink`\n     * property.\n     */\n    @Prop({ reflect: true })\n    public type: InputType = 'text';\n\n    /**\n     * Set to `true` to format the current value of the input field only\n     * if the field is of type number.\n     * The number format is determined by the current language of the browser.\n     */\n    @Prop({ reflect: true })\n    public formatNumber = true;\n\n    /**\n     * Incremental values that are valid if the field type is `number`.\n     */\n    @Prop({ reflect: true })\n    public step: number | 'any' = 'any';\n\n    /**\n     * Maximum allowed value if input type is `number`.\n     */\n    @Prop({ reflect: true })\n    public max: number;\n\n    /**\n     * Minimum allowed value if input type is `number`.\n     */\n    @Prop({ reflect: true })\n    public min: number;\n\n    /**\n     * Maximum length of the value if type is `password`, `search`, `tel`,\n     * `text`, `url`, or `urlAsText`.\n     */\n    @Prop({ reflect: true })\n    public maxlength: number;\n\n    /**\n     * Minimum length of the value if type is `password`, `search`, `tel`,\n     * `text`, `url`, or `urlAsText`.\n     */\n    @Prop({ reflect: true })\n    public minlength: number;\n\n    /**\n     * list of suggestions `value` can autocomplete to.\n     */\n    @Prop()\n    public completions: string[] = [];\n\n    /**\n     * For inputs of type `email`, `tel`, `url`, and `urlAsText`, set this to\n     * `true` to show a trailing icon with a `mailto:`,`tel:`, or normal link,\n     * respectively. The default icon can be overridden using the `trailingIcon`\n     * property.\n     */\n    @Prop({ reflect: true })\n    public showLink = false;\n\n    /**\n     * The locale to use for formatting numbers.\n     */\n    @Prop({ reflect: true })\n    public locale: string = globalConfig.defaultLocale;\n\n    /**\n     * Emitted when the input value is changed.\n     */\n    @Event()\n    private change: EventEmitter<string>;\n\n    /**\n     * Emitted when `trailingIcon` or `leadingIcon` is set\n     * and the icon is interacted with.\n     */\n    @Event()\n    private action: EventEmitter<void>;\n\n    @Element()\n    private limelInputField: HTMLLimelInputFieldElement;\n\n    @State()\n    private isFocused: boolean = false;\n\n    @State()\n    private wasInvalid: boolean = false;\n\n    @State()\n    public showCompletions: boolean = false;\n\n    private inputElement?: HTMLInputElement | HTMLTextAreaElement;\n    private mdcTextField: MDCTextField;\n    private completionsList: ListItem[] = [];\n    private portalId: string;\n    private helperTextId: string;\n    private labelId: string;\n\n    private changeWaiting = false;\n\n    constructor() {\n        this.portalId = createRandomString();\n        this.helperTextId = createRandomString();\n        this.labelId = createRandomString();\n    }\n\n    public connectedCallback() {\n        this.initialize();\n    }\n\n    public componentDidLoad() {\n        this.initialize();\n    }\n\n    public disconnectedCallback() {\n        if (this.mdcTextField) {\n            this.mdcTextField.destroy();\n        }\n\n        window.removeEventListener('resize', this.layout);\n        this.limelInputField.removeEventListener('focus', this.setFocus);\n    }\n\n    public componentDidUpdate() {\n        if (this.invalid) {\n            this.mdcTextField.valid = false;\n        }\n\n        this.mdcTextField.disabled = this.disabled || this.readonly;\n    }\n\n    public render() {\n        const properties = this.getAdditionalProps();\n        properties['aria-labelledby'] = this.labelId;\n        properties.class = 'mdc-text-field__input';\n        properties.ref = this.setInputElement;\n        properties.onInput = this.handleInput;\n        properties.onChange = this.handleChange;\n        properties.onFocus = this.onFocus;\n        properties.onBlur = this.onBlur;\n        properties.required = this.required;\n        properties.readonly = this.readonly;\n        properties.disabled = this.disabled || this.readonly;\n\n        let ariaControls = '';\n\n        if (this.hasHelperText()) {\n            ariaControls += this.helperTextId;\n            properties['aria-describedby'] = this.helperTextId;\n        }\n\n        if (this.renderAutocompleteList()) {\n            if (ariaControls) {\n                ariaControls += ' ';\n            }\n\n            ariaControls += this.portalId;\n        }\n\n        if (ariaControls) {\n            properties['aria-controls'] = ariaControls;\n        }\n\n        return [\n            <label class={this.getContainerClassList()}>\n                <span class=\"mdc-notched-outline\" tabindex=\"-1\">\n                    <span class=\"mdc-notched-outline__leading\"></span>\n                    {this.renderLabel()}\n                    <span class=\"mdc-notched-outline__trailing\"></span>\n                </span>\n                {this.renderLeadingIcon()}\n                {this.renderEmptyValueForReadonly()}\n                {this.renderPrefix()}\n                {this.renderFormattedNumber()}\n                {this.renderInput(properties)}\n                {this.renderSuffix()}\n                {this.renderTextarea(properties)}\n                {this.renderTrailingLinkOrButton()}\n            </label>,\n            this.renderHelperLine(),\n            this.renderAutocompleteList(),\n        ];\n    }\n\n    @Watch('value')\n    protected valueWatcher(newValue: string) {\n        if (!this.mdcTextField) {\n            return;\n        }\n\n        if (this.changeWaiting) {\n            return;\n        }\n\n        if (\n            this.type === 'number' &&\n            this.isFocused &&\n            Number(newValue) === Number(this.mdcTextField.value)\n        ) {\n            return;\n        }\n\n        if (newValue !== this.mdcTextField.value) {\n            this.mdcTextField.value = newValue || '';\n        }\n\n        if (this.wasInvalid) {\n            this.validate();\n        }\n    }\n\n    @Watch('completions')\n    protected completionsWatcher() {\n        this.mapCompletions();\n    }\n\n    private initialize = () => {\n        const element =\n            this.limelInputField.shadowRoot.querySelector('.mdc-text-field');\n        if (!element) {\n            return;\n        }\n\n        this.mdcTextField = new MDCTextField(element);\n        if (this.value) {\n            this.mdcTextField.value = this.value;\n        }\n\n        if (this.invalid) {\n            this.mdcTextField.valid = false;\n        }\n\n        this.mapCompletions();\n\n        window.addEventListener('resize', this.layout, { passive: true });\n        this.limelInputField.addEventListener('focus', this.setFocus);\n    };\n\n    private mapCompletions = () => {\n        this.completionsList = [...this.completions].map((item) => {\n            return { text: item };\n        });\n    };\n\n    private setFocus = () => {\n        this.mdcTextField.focus();\n    };\n\n    private getContainerClassList = () => {\n        const classList = {\n            'mdc-text-field': true,\n            'mdc-text-field--no-label': !this.label,\n            'mdc-text-field--outlined': true,\n            'mdc-text-field--invalid': this.isInvalid(),\n            'mdc-text-field--disabled': this.disabled || this.readonly,\n            'lime-text-field--readonly': this.readonly,\n            'mdc-text-field--required': this.required,\n            'lime-text-field--empty': this.isEmpty(),\n            'lime-has-prefix': this.hasPrefix(),\n            'lime-has-suffix': this.hasSuffix(),\n        };\n\n        if (this.type === 'textarea') {\n            classList['mdc-text-field--textarea'] = true;\n            classList['has-helper-line'] =\n                !!this.helperText || !!this.maxlength;\n        } else {\n            classList['mdc-text-field--with-leading-icon'] = !!this.leadingIcon;\n            classList['mdc-text-field--with-trailing-icon'] =\n                !!this.getTrailingIcon();\n        }\n\n        return classList;\n    };\n\n    private isEmpty = () => {\n        if (this.type === 'number' && this.inputElement?.validity.badInput) {\n            return false;\n        }\n\n        return !this.getCurrentValue();\n    };\n\n    private getCurrentValue = () => {\n        if (this.changeWaiting && this.inputElement) {\n            return this.inputElement.value;\n        }\n\n        return this.value;\n    };\n\n    private renderInput = (\n        properties: JSXBase.InputHTMLAttributes<HTMLInputElement>,\n    ) => {\n        if (this.type === 'textarea') {\n            return;\n        }\n\n        const type = this.type === 'urlAsText' ? 'text' : this.type;\n\n        return (\n            <input\n                {...properties}\n                type={type}\n                pattern={this.pattern}\n                onWheel={this.handleWheel}\n                onKeyDown={this.onKeyDown}\n                placeholder={this.placeholder}\n            />\n        );\n    };\n\n    private renderTextarea = (\n        properties: JSXBase.TextareaHTMLAttributes<HTMLTextAreaElement>,\n    ) => {\n        if (this.type !== 'textarea') {\n            return;\n        }\n\n        return (\n            <span class=\"mdc-text-field__resizer\">\n                <textarea\n                    {...properties}\n                    placeholder={this.placeholder}\n                ></textarea>\n            </span>\n        );\n    };\n\n    private layout = () => {\n        this.mdcTextField?.layout();\n    };\n\n    private getAdditionalProps = () => {\n        const props: any = {};\n\n        if (this.type === 'number') {\n            props.step = this.step;\n        }\n\n        if (this.type === 'number' && Number.isInteger(this.min)) {\n            props.min = this.min;\n        }\n\n        if (this.type === 'number' && Number.isInteger(this.max)) {\n            props.max = this.max;\n        }\n\n        if (this.minlength) {\n            props.minlength = this.minlength;\n        }\n\n        if (this.maxlength) {\n            props.maxlength = this.maxlength;\n        }\n\n        return props;\n    };\n\n    private onFocus = () => {\n        this.isFocused = true;\n        this.showCompletions = true;\n    };\n\n    private onBlur = () => {\n        this.isFocused = false;\n        this.validate();\n        this.changeEmitter.flush();\n    };\n\n    private hasHelperText = () => {\n        return this.helperText !== null && this.helperText !== undefined;\n    };\n\n    private hasHelperLine = () => {\n        return this.maxlength || this.hasHelperText();\n    };\n\n    private renderHelperLine = () => {\n        const text: string = this.getCurrentValue() || '';\n        const length = text.length;\n\n        if (!this.hasHelperLine()) {\n            return;\n        }\n\n        return (\n            <limel-helper-line\n                helperTextId={this.helperTextId}\n                helperText={this.helperText}\n                length={length}\n                maxLength={this.maxlength}\n                invalid={this.isInvalid()}\n            />\n        );\n    };\n\n    private renderEmptyValueForReadonly = () => {\n        if (this.readonly && this.isEmpty()) {\n            return (\n                <span class=\"lime-empty-value-for-readonly lime-looks-like-input-value\">\n                    –\n                </span>\n            );\n        }\n    };\n\n    private renderSuffix = () => {\n        if (!this.hasSuffix() || this.type === 'textarea') {\n            return;\n        }\n\n        const classList = {\n            'mdc-text-field__affix': true,\n            'mdc-text-field__affix--suffix': true,\n        };\n\n        return <span class={classList}>{this.suffix}</span>;\n    };\n\n    private hasSuffix = () => {\n        return this.suffix !== null && this.suffix !== undefined;\n    };\n\n    private renderPrefix = () => {\n        if (!this.hasPrefix() || this.type === 'textarea') {\n            return;\n        }\n\n        const classList = {\n            'mdc-text-field__affix': true,\n            'mdc-text-field__affix--prefix': true,\n        };\n\n        return <span class={classList}>{this.prefix}</span>;\n    };\n\n    private hasPrefix = () => {\n        return this.prefix !== null && this.prefix !== undefined;\n    };\n\n    private isInvalid = () => {\n        if (this.readonly) {\n            // A readonly field can never be invalid.\n            return false;\n        }\n\n        if (this.invalid) {\n            // `this.invalid` is set by the consumer. If the consumer explicitly\n            // told us to consider the field invalid, we consider it invalid\n            // regardless of what our internal validation thinks, and regardless\n            // of whether the field has been modified.\n            return true;\n        }\n\n        return this.wasInvalid;\n    };\n\n    private validate = () => {\n        if (this.readonly || this.invalid) {\n            this.wasInvalid = false;\n\n            return;\n        }\n\n        if (this.inputElement) {\n            this.wasInvalid = !this.inputElement.checkValidity();\n        }\n    };\n\n    private setInputElement = (\n        element?: HTMLInputElement | HTMLTextAreaElement,\n    ) => {\n        if (element) {\n            this.inputElement = element;\n        }\n    };\n\n    private renderLabel = () => {\n        const labelClassList = {\n            'mdc-floating-label': true,\n            'mdc-floating-label--float-above':\n                !this.isEmpty() || this.isFocused || this.readonly,\n        };\n\n        if (!this.label) {\n            return;\n        }\n\n        return (\n            <span class=\"mdc-notched-outline__notch\">\n                <span class={labelClassList} id={this.labelId}>\n                    {this.label}\n                </span>\n            </span>\n        );\n    };\n\n    private renderLeadingIcon = () => {\n        if (this.type === 'textarea') {\n            return;\n        }\n\n        if (this.leadingIcon) {\n            return (\n                <i class=\"material-icons mdc-text-field__icon mdc-text-field__icon--leading\">\n                    <limel-icon name={this.leadingIcon} />\n                </i>\n            );\n        }\n    };\n\n    private renderTrailingLinkOrButton = () => {\n        if (this.type === 'textarea') {\n            return;\n        }\n\n        const trailingIcon = this.getTrailingIcon();\n\n        if (!this.isInvalid() && this.hasLink()) {\n            return this.renderLinkIcon(this.getLink(), trailingIcon);\n        } else if (trailingIcon) {\n            return this.renderTrailingIcon(trailingIcon);\n        }\n    };\n\n    private hasLink = () => {\n        return (\n            this.showLink &&\n            ['email', 'tel', 'url', 'urlAsText'].includes(this.type)\n        );\n    };\n\n    private getLink = () => {\n        const props: LinkProperties = { href: '' };\n        switch (this.type) {\n            case 'email':\n                props.href = `mailto:${this.value}`;\n                break;\n            case 'tel':\n                props.href = `tel:${this.value}`;\n                break;\n            default:\n                props.href = getHref(this.value);\n                props.target = getTarget(this.value);\n        }\n\n        return props;\n    };\n\n    private renderLinkIcon = (linkProps: LinkProperties, icon: string) => {\n        // If the trailing icon uses the class `mdc-text-field__icon--trailing`,\n        // MDC attaches a click handler to it, which apparently runs\n        // `preventDefault()` on the event. For links, we don't want that,\n        // so instead of `mdc-text-field__icon--trailing`, we use our own class\n        // `lime-trailing-icon-for-link`, which uses all the same styling. /Ads\n        return (\n            <a\n                {...linkProps}\n                class=\"material-icons mdc-text-field__icon lime-trailing-icon-for-link\"\n                tabindex={this.disabled || this.isEmpty() ? '-1' : '0'}\n                role=\"button\"\n            >\n                <limel-icon name={icon} />\n            </a>\n        );\n    };\n\n    private renderTrailingIcon = (icon: string) => {\n        if (this.isInvalid()) {\n            return (\n                <i\n                    key=\"invalid\"\n                    class=\"material-icons mdc-text-field__icon invalid-icon\"\n                >\n                    <limel-icon name={icon} />\n                </i>\n            );\n        }\n\n        return (\n            <i\n                key=\"action\"\n                class=\"material-icons mdc-text-field__icon mdc-text-field__icon--trailing\"\n                tabIndex={0}\n                role=\"button\"\n                onKeyDown={this.handleIconKeyPress}\n                onClick={this.handleIconClick}\n            >\n                <limel-icon name={icon} />\n            </i>\n        );\n    };\n\n    private getTrailingIcon = () => {\n        if (this.isInvalid()) {\n            return 'high_importance';\n        }\n\n        if (this.trailingIcon) {\n            return this.trailingIcon;\n        }\n\n        if (this.showLink && this.type === 'email') {\n            return 'filled_message';\n        }\n\n        if (this.showLink && this.type === 'tel') {\n            return 'phone';\n        }\n\n        if (\n            this.showLink &&\n            (this.type === 'url' || this.type === 'urlAsText')\n        ) {\n            return 'external_link';\n        }\n    };\n\n    private renderFormattedNumber = () => {\n        if (this.type !== 'number') {\n            return;\n        }\n\n        let renderValue = this.value;\n        if (this.formatNumber && this.value) {\n            renderValue = new Intl.NumberFormat(this.locale).format(\n                Number(this.value),\n            );\n            if (renderValue === 'NaN') {\n                return;\n            }\n        }\n\n        return (\n            <span class=\"lime-formatted-input lime-looks-like-input-value\">\n                {renderValue}\n            </span>\n        );\n    };\n\n    /**\n     * Key handler for the input field\n     * Will change focus to the first/last item in the dropdown list to enable selection with the keyboard\n     *\n     * @param event - event\n     */\n\n    private onKeyDown = (event: KeyboardEvent): void => {\n        this.showCompletions = true;\n        const isForwardTab =\n            (event.key === TAB || event.keyCode === TAB_KEY_CODE) &&\n            !event.altKey &&\n            !event.metaKey &&\n            !event.shiftKey;\n        const isUp =\n            event.key === ARROW_UP || event.keyCode === ARROW_UP_KEY_CODE;\n        const isDown =\n            event.key === ARROW_DOWN || event.keyCode === ARROW_DOWN_KEY_CODE;\n\n        if (event.keyCode === TAB_KEY_CODE && event.shiftKey) {\n            this.showCompletions = false;\n        }\n\n        if (!isForwardTab && !isUp && !isDown) {\n            return;\n        }\n\n        const list = document.querySelector(` #${this.portalId} limel-list`);\n\n        if (!list) {\n            return;\n        }\n\n        event.preventDefault();\n        if (isForwardTab || isDown) {\n            const listElement: HTMLElement = list.shadowRoot.querySelector(\n                '.mdc-deprecated-list-item:first-child',\n            );\n            listElement.focus();\n\n            return;\n        }\n\n        if (isUp) {\n            const listElement: HTMLElement = list.shadowRoot.querySelector(\n                '.mdc-deprecated-list-item:last-child',\n            );\n            listElement.focus();\n        }\n    };\n\n    private handleCompletionChange = (\n        event: LimelListCustomEvent<ListItem>,\n    ) => {\n        event.stopPropagation();\n        if (!event.detail) {\n            return;\n        }\n\n        this.showCompletions = false;\n\n        /*\n         This change event doesn't need to be debounced in itself, but we want\n         to make absolutely sure that an earlier change event that *has* been\n         debounced doesn't emit after this one. Therefore, we run this through\n         the same debounced emitter function. /Ads\n         */\n        this.changeEmitter(event.detail.text);\n        this.changeEmitter.flush();\n    };\n\n    private renderAutocompleteList = () => {\n        if (this.type === 'textarea' || !this.completions.length) {\n            return;\n        }\n\n        const dropdownZIndex = getComputedStyle(\n            this.limelInputField,\n        ).getPropertyValue('--dropdown-z-index');\n\n        return (\n            <limel-portal\n                visible={this.showCompletions}\n                containerId={this.portalId}\n                inheritParentWidth={true}\n                containerStyle={{ 'z-index': dropdownZIndex }}\n            >\n                <limel-menu-surface\n                    open={this.showCompletions}\n                    allowClicksElement={this.limelInputField}\n                    style={{\n                        '--mdc-menu-min-width': '100%',\n                        'max-height': 'inherit',\n                        display: 'flex',\n                    }}\n                    onDismiss={this.handleCloseMenu}\n                >\n                    {this.renderListResult()}\n                </limel-menu-surface>\n            </limel-portal>\n        );\n    };\n\n    private renderListResult = () => {\n        const filteredCompletions: ListItem[] = this.filterCompletions(\n            this.getCurrentValue(),\n        );\n        if (!filteredCompletions || filteredCompletions.length === 0) {\n            return null;\n        }\n\n        return (\n            <limel-list\n                onChange={this.handleCompletionChange}\n                onKeyDown={this.handleKeyDownInDropdown}\n                type=\"selectable\"\n                items={filteredCompletions}\n            />\n        );\n    };\n\n    private handleKeyDownInDropdown = (event: KeyboardEvent) => {\n        const keyFound = [TAB, ESCAPE, ENTER].includes(event.key);\n        const keyCodeFound = [\n            TAB_KEY_CODE,\n            ESCAPE_KEY_CODE,\n            ENTER_KEY_CODE,\n        ].includes(event.keyCode);\n        if (keyFound || keyCodeFound) {\n            this.setFocus();\n        }\n    };\n\n    private handleCloseMenu = () => {\n        this.showCompletions = false;\n    };\n\n    private filterCompletions = (filter: string) => {\n        if (!filter) {\n            return this.completionsList;\n        }\n\n        return this.completionsList.filter(\n            (completion) =>\n                completion.text.toLowerCase().indexOf(filter.toLowerCase()) >\n                -1,\n        );\n    };\n\n    private handleInput = (event) => {\n        event.stopPropagation();\n        let value = event.target.value;\n\n        if (this.type === 'number') {\n            if (!value && event.data) {\n                event.stopPropagation();\n\n                return;\n            }\n\n            if (value) {\n                value = Number(value);\n            }\n        }\n\n        this.changeWaiting = true;\n        this.changeEmitter(value);\n    };\n\n    private changeEmitter = debounce((value: string) => {\n        this.change.emit(value);\n        this.changeWaiting = false;\n    }, DEBOUNCE_TIMEOUT);\n\n    private handleChange = (event: Event) => {\n        event.stopPropagation();\n        this.changeEmitter.flush();\n    };\n\n    private handleIconClick = () => {\n        this.action.emit();\n    };\n\n    private handleIconKeyPress = (event: KeyboardEvent) => {\n        const isEnter = event.key === ENTER || event.keyCode === ENTER_KEY_CODE;\n        const isSpace = event.key === SPACE || event.keyCode === SPACE_KEY_CODE;\n\n        if (isSpace || isEnter) {\n            this.action.emit();\n        }\n    };\n\n    private handleWheel = () => {\n        // This empty event handler is here to circumvent a bug.\n        // In some browsers (Chrome for example), hovering the input with\n        // the input focused, and scrolling, will both change the value\n        // AND scroll the page. We would prefer to never change the value\n        // on scroll, instead always scrolling the page, but since we\n        // haven't found a way to do that, this is the next best thing, as\n        // it prevents the page from being scrolled, but only in the\n        // circumstances when the value is changed by the scrolling.\n        // Please test THOROUGHLY if you remove this event handler 😄\n    };\n}\n","@use '../../style/functions';\n\n// Note! The `--dropdown-z-index` property is used from `menu.tsx`.\n\n/**\n * @prop --dropdown-z-index: `z-index` of the dropdown menu.\n * @prop --menu-surface-width: Width of the menu surface. Overrides the width defined by `surfaceWidth`.\n * @prop --list-grid-item-max-width: Maximum width of items in the menu list when `gridLayout={true}`. Defaults to `10rem`.\n * @prop --list-grid-item-min-width: Minimum width of items in the menu list when `gridLayout={true}`. Defaults to `7.5rem`.\n * @prop --list-grid-gap: Distance between the items in the menu list when `gridLayout={true}`. Defaults to `0.75rem`.\n * @prop --notification-badge-text-color: Defines the text color of notification badges. Defaults to `--color-white`.\n * @prop --notification-badge-background-color: Defines the background color of notification badges. Defaults to `--color-red-default`.\n */\n\n:host(limel-menu) {\n    isolation: isolate;\n    position: relative;\n    display: inline-block;\n    --badge-background-color: var(\n        --notification-badge-background-color,\n        rgb(var(--color-red-default))\n    );\n    --badge-text-color: var(\n        --notification-badge-text-color,\n        rgb(var(--color-white))\n    );\n}\n\n:host([hidden]) {\n    display: none;\n}\n\n.menu__trigger {\n    border-color: transparent;\n    border-width: 1px;\n    border-style: solid;\n    background: none;\n    color: rgb(var(--contrast-800));\n    height: functions.pxToRem(36);\n\n    &-enabled {\n        &:hover {\n            border-color: rgb(var(--contrast-800));\n            color: rgb(var(--contrast-1100));\n        }\n    }\n}\n\n.mdc-menu-surface--anchor {\n    position: relative;\n}\n\nlimel-badge {\n    position: absolute;\n    top: -0.25rem;\n    right: -0.25rem;\n}\n","import {\n    Component,\n    Event,\n    EventEmitter,\n    h,\n    Prop,\n    Element,\n    Watch,\n    State,\n} from '@stencil/core';\nimport { createRandomString } from '../../util/random-string';\nimport { zipObject, isFunction } from 'lodash-es';\nimport {\n    LimelBreadcrumbsCustomEvent,\n    LimelInputFieldCustomEvent,\n} from '../../components';\n\nimport { BreadcrumbsItem } from '../breadcrumbs/breadcrumbs.types';\nimport { ListSeparator } from '../list/list-item.types';\nimport {\n    OpenDirection,\n    MenuItem,\n    MenuLoader,\n    SurfaceWidth,\n    MenuSearcher,\n} from './menu.types';\n\nimport {\n    ARROW_DOWN,\n    ARROW_DOWN_KEY_CODE,\n    ARROW_LEFT,\n    ARROW_LEFT_KEY_CODE,\n    ARROW_RIGHT,\n    ARROW_RIGHT_KEY_CODE,\n    ARROW_UP,\n    ARROW_UP_KEY_CODE,\n    TAB,\n    TAB_KEY_CODE,\n} from '../../util/keycodes';\n\ninterface MenuCrumbItem extends BreadcrumbsItem {\n    menuItem?: MenuItem;\n}\n\nconst DEFAULT_ROOT_BREADCRUMBS_ITEM: BreadcrumbsItem = {\n    text: '',\n    icon: {\n        name: 'home',\n    },\n    type: 'icon-only',\n};\n\n/**\n * @slot trigger - Element to use as a trigger for the menu.\n * @exampleComponent limel-example-menu-basic\n * @exampleComponent limel-example-menu-disabled\n * @exampleComponent limel-example-menu-open-direction\n * @exampleComponent limel-example-menu-surface-width\n * @exampleComponent limel-example-menu-separators\n * @exampleComponent limel-example-menu-icons\n * @exampleComponent limel-example-menu-badge-icons\n * @exampleComponent limel-example-menu-grid\n * @exampleComponent limel-example-menu-hotkeys\n * @exampleComponent limel-example-menu-secondary-text\n * @exampleComponent limel-example-menu-notification\n * @exampleComponent limel-example-menu-sub-menus\n * @exampleComponent limel-example-menu-sub-menu-lazy-loading\n * @exampleComponent limel-example-menu-sub-menu-lazy-loading-infinite\n * @exampleComponent limel-example-menu-searchable\n * @exampleComponent limel-example-menu-composite\n */\n@Component({\n    tag: 'limel-menu',\n    shadow: true,\n    styleUrl: 'menu.scss',\n})\nexport class Menu {\n    /**\n     * A list of items and separators to show in the menu.\n     */\n    @Prop()\n    public items: Array<MenuItem | ListSeparator> = [];\n\n    /**\n     * Sets the disabled state of the menu.\n     */\n    @Prop({ reflect: true })\n    public disabled = false;\n\n    /**\n     * Decides the menu's location in relation to its trigger\n     */\n    @Prop({ reflect: true })\n    public openDirection: OpenDirection = 'bottom-start';\n\n    /**\n     * Decides the width of menu's dropdown\n     */\n    @Prop({ reflect: true })\n    public surfaceWidth: SurfaceWidth = 'inherit-from-items';\n\n    /**\n     * Sets the open state of the menu.\n     */\n    @Prop({ mutable: true, reflect: true })\n    public open = false;\n\n    /**\n     * Defines whether the menu should show badges.\n     */\n    @Prop({ reflect: true })\n    public badgeIcons = false;\n\n    /**\n     * Renders list items in a grid layout, rather than a vertical list\n     */\n    @Prop({ reflect: true })\n    public gridLayout = false;\n\n    /**\n     * :::warning Internal Use Only\n     * This property is for internal use only. We need it for now, but want to\n     * find a better implementation of the functionality it currently enables.\n     * If and when we do so, this property will be removed without prior\n     * notice. If you use it, your code _will_ break in the future.\n     * :::\n     *\n     * @internal\n     */\n    @Prop({ reflect: true })\n    public loading = false;\n\n    /**\n     * :::warning Internal Use Only\n     * This property is for internal use only. We need it for now, but want to\n     * find a better implementation of the functionality it currently enables.\n     * If and when we do so, this property will be removed without prior\n     * notice. If you use it, your code _will_ break in the future.\n     * :::\n     *\n     * @internal\n     */\n    @Prop({ mutable: true })\n    public currentSubMenu: MenuItem;\n\n    /**\n     * A root breadcrumb item to show above the menu items.\n     * Clicking it navigates back from a sub-menu to the root menu.\n     */\n    @Prop()\n    public rootItem: BreadcrumbsItem = DEFAULT_ROOT_BREADCRUMBS_ITEM;\n\n    /**\n     * Is emitted when the menu is cancelled.\n     */\n    @Event()\n    public cancel: EventEmitter<void>;\n\n    /**\n     * Is emitted when a menu item is selected.\n     */\n    @Event()\n    public select: EventEmitter<MenuItem>;\n\n    /**\n     * A search function that takes a search-string as an argument,\n     * and returns a promise that will eventually be resolved with\n     * an array of `MenuItem`:s.\n     *\n     * See the docs for the type `MenuSearcher` for type information on\n     * the searcher function itself.\n     */\n    @Prop()\n    public searcher: MenuSearcher;\n\n    /**\n     * Message to display when search returns 0 results.\n     */\n    @Prop()\n    public emptyResultMessage?: string;\n\n    /**\n     * Is emitted when a menu item with a sub-menu is selected.\n     */\n    @Event()\n    public navigateMenu: EventEmitter<MenuItem | null>;\n\n    @Element()\n    private host: HTMLLimelMenuElement;\n\n    @State()\n    private loadingSubItems: boolean;\n\n    @State()\n    private searchValue: string;\n\n    @State()\n    private searchResults: Array<MenuItem | ListSeparator> | null;\n\n    private list: HTMLLimelMenuListElement;\n    private searchInput: HTMLLimelInputFieldElement;\n    private portalId: string;\n    private triggerElement: HTMLSlotElement;\n    private selectedMenuItem?: MenuItem;\n\n    constructor() {\n        this.portalId = createRandomString();\n    }\n\n    public componentDidRender() {\n        const slotElement = this.host.shadowRoot.querySelector('slot');\n        slotElement.assignedElements().forEach(this.setTriggerAttributes);\n    }\n\n    public render() {\n        const cssProperties = this.getCssProperties();\n\n        const dropdownZIndex = getComputedStyle(this.host).getPropertyValue(\n            '--dropdown-z-index',\n        );\n\n        const menuSurfaceWidth = this.getMenuSurfaceWidth(\n            cssProperties['--menu-surface-width'],\n        );\n\n        return (\n            <div class=\"mdc-menu-surface--anchor\" onClick={this.onTriggerClick}>\n                <slot ref={this.setTriggerRef} name=\"trigger\" />\n                {this.renderNotificationBadge()}\n                <limel-portal\n                    visible={this.open}\n                    containerId={this.portalId}\n                    openDirection={this.openDirection}\n                    position=\"absolute\"\n                    containerStyle={{ 'z-index': dropdownZIndex }}\n                >\n                    <limel-menu-surface\n                        open={this.open}\n                        onDismiss={this.onClose}\n                        style={{\n                            ...cssProperties,\n                            '--mdc-menu-min-width': menuSurfaceWidth,\n                            '--limel-menu-surface-display': 'flex',\n                            '--limel-menu-surface-flex-direction': 'column',\n                        }}\n                        class={{\n                            'has-grid-layout': this.gridLayout,\n                        }}\n                    >\n                        {this.renderSearchField()}\n                        {this.renderBreadcrumb()}\n                        {this.renderLoader()}\n                        {this.renderEmptyMessage()}\n                        {this.renderMenuList()}\n                    </limel-menu-surface>\n                </limel-portal>\n            </div>\n        );\n    }\n\n    @Watch('items')\n    protected itemsWatcher() {\n        this.clearSearch();\n        this.setFocus();\n    }\n\n    @Watch('open')\n    protected openWatcher(newValue: boolean) {\n        if (newValue) {\n            this.setFocus();\n        } else {\n            this.clearSearch();\n        }\n    }\n\n    private getBreadcrumbsItems() {\n        const breadCrumbItems: MenuCrumbItem[] = [];\n        let currentItem = this.currentSubMenu;\n        while (currentItem) {\n            breadCrumbItems.push({\n                text: currentItem.text,\n                icon: currentItem.icon,\n                menuItem: currentItem,\n            });\n            currentItem = currentItem.parentItem;\n        }\n\n        if (\n            breadCrumbItems.length ||\n            this.rootItem !== DEFAULT_ROOT_BREADCRUMBS_ITEM\n        ) {\n            breadCrumbItems.push(this.rootItem);\n        }\n\n        return breadCrumbItems.reverse();\n    }\n\n    private renderLoader = () => {\n        if (!this.loadingSubItems && !this.loading) {\n            return;\n        }\n\n        const cssProperties = this.getCssProperties();\n\n        return (\n            <div\n                style={{\n                    width: cssProperties['--menu-surface-width'],\n                    display: 'flex',\n                    'align-items': 'center',\n                    'justify-content': 'center',\n                    padding: '0.5rem 0',\n                }}\n            >\n                <limel-spinner size=\"mini\" limeBranded={false} />\n            </div>\n        );\n    };\n\n    private renderBreadcrumb = () => {\n        const breadcrumbsItems = this.getBreadcrumbsItems();\n        if (!breadcrumbsItems.length) {\n            return;\n        }\n\n        return (\n            <limel-breadcrumbs\n                style={{\n                    'border-bottom': 'solid 1px rgb(var(--contrast-500))',\n                    'flex-shrink': '0',\n                }}\n                onSelect={this.handleBreadcrumbsSelect}\n                items={breadcrumbsItems}\n            />\n        );\n    };\n\n    private handleBreadcrumbsSelect = (\n        event: LimelBreadcrumbsCustomEvent<MenuCrumbItem>,\n    ) => {\n        if (!event.detail.menuItem) {\n            this.currentSubMenu = null;\n            this.clearSearch();\n            this.navigateMenu.emit(null);\n\n            this.setFocus();\n\n            return;\n        }\n\n        this.handleSelect(event.detail.menuItem);\n    };\n\n    private renderSearchField = () => {\n        if (!this.searcher) {\n            return;\n        }\n\n        return (\n            <limel-input-field\n                tabindex=\"0\"\n                ref={this.setSearchElement}\n                type=\"search\"\n                leadingIcon=\"search\"\n                style={{\n                    padding: '0.25rem',\n                    'box-sizing': 'border-box',\n                }}\n                value={this.searchValue}\n                onChange={this.handleTextInput}\n                onKeyDown={this.handleInputKeyDown}\n            />\n        );\n    };\n\n    private renderEmptyMessage = () => {\n        if (\n            this.loading ||\n            this.loadingSubItems ||\n            !this.emptyResultMessage ||\n            !Array.isArray(this.searchResults) ||\n            this.searchResults?.length\n        ) {\n            return null;\n        }\n\n        return (\n            <p\n                style={{\n                    padding: '0 1rem',\n                    'text-align': 'center',\n                }}\n            >\n                {this.emptyResultMessage}\n            </p>\n        );\n    };\n\n    private renderMenuList = () => {\n        let items = this.visibleItems;\n\n        if (this.loadingSubItems || this.loading) {\n            items = [];\n        }\n\n        return (\n            <limel-menu-list\n                style={{\n                    'overflow-y': 'auto',\n                    'flex-grow': '1',\n                }}\n                class={{\n                    'has-grid-layout has-interactive-items': this.gridLayout,\n                }}\n                items={items}\n                type=\"menu\"\n                badgeIcons={this.badgeIcons}\n                onSelect={this.onSelect}\n                ref={this.setListElement}\n                onKeyDown={this.handleMenuKeyDown}\n            />\n        );\n    };\n\n    private handleTextInput = async (\n        event: LimelInputFieldCustomEvent<string>,\n    ) => {\n        event.stopPropagation();\n\n        const query = event.detail;\n        this.searchValue = query;\n        if (query === '') {\n            this.searchResults = null;\n            this.loadingSubItems = false;\n\n            return;\n        }\n\n        this.loadingSubItems = true;\n\n        const result = await this.searcher(query);\n\n        if (this.searchValue !== query) {\n            return;\n        }\n\n        this.searchResults = result;\n        this.loadingSubItems = false;\n    };\n\n    // Key handler for the input search field\n    // Will change focus to the first/last item in the dropdown\n    // list to enable selection with the keyboard\n    private handleInputKeyDown = (event: KeyboardEvent) => {\n        const isForwardTab =\n            (event.key === TAB || event.keyCode === TAB_KEY_CODE) &&\n            !event.altKey &&\n            !event.metaKey &&\n            !event.shiftKey;\n        const isUp =\n            event.key === ARROW_UP || event.keyCode === ARROW_UP_KEY_CODE;\n        const isDown =\n            event.key === ARROW_DOWN || event.keyCode === ARROW_DOWN_KEY_CODE;\n\n        if (!isForwardTab && !isUp && !isDown) {\n            return;\n        }\n\n        if (!this.list) {\n            return;\n        }\n\n        event.stopPropagation();\n        event.preventDefault();\n\n        if (isForwardTab || isDown) {\n            const listItems =\n                this.list.shadowRoot.querySelectorAll<HTMLElement>(\n                    '.mdc-deprecated-list-item',\n                );\n            const listElement = listItems[0];\n            listElement?.focus();\n\n            return;\n        }\n\n        if (isUp) {\n            const listItems =\n                this.list.shadowRoot.querySelectorAll<HTMLElement>(\n                    '.mdc-deprecated-list-item',\n                );\n            const listElement = listItems[listItems.length - 1];\n            listElement?.focus();\n        }\n    };\n\n    // Key handler for the menu list\n    // Will change focus to the search field if using shift+tab\n    // And can go forward/back with righ/left arrow keys\n    private handleMenuKeyDown = (event: KeyboardEvent) => {\n        const isBackwardTab =\n            (event.key === TAB || event.keyCode === TAB_KEY_CODE) &&\n            !event.altKey &&\n            !event.metaKey &&\n            event.shiftKey;\n\n        const isLeft =\n            event.key === ARROW_LEFT || event.keyCode === ARROW_LEFT_KEY_CODE;\n\n        const isRight =\n            event.key === ARROW_RIGHT || event.keyCode === ARROW_RIGHT_KEY_CODE;\n\n        if (!isBackwardTab && !isLeft && !isRight) {\n            return;\n        }\n\n        if (isBackwardTab) {\n            event.stopPropagation();\n            event.preventDefault();\n            this.searchInput?.focus();\n        } else if (!this.gridLayout) {\n            const currentItem = this.getCurrentItem();\n\n            event.stopPropagation();\n            event.preventDefault();\n            if (isRight) {\n                this.goForward(currentItem);\n            } else if (isLeft) {\n                this.goBack();\n            }\n        }\n    };\n\n    private clearSearch = () => {\n        this.searchValue = '';\n        this.searchResults = null;\n        this.loadingSubItems = false;\n    };\n\n    private getCurrentItem = (): MenuItem => {\n        const activeItem = this.list?.shadowRoot?.querySelector(\n            '[role=\"menuitem\"][tabindex=\"0\"]',\n        );\n        const attrIndex = activeItem?.attributes?.getNamedItem('data-index');\n        const dataIndex = parseInt(attrIndex?.value || '0', 10);\n\n        return this.visibleItems[dataIndex] as MenuItem;\n    };\n\n    private goForward = (currentItem: MenuItem) => {\n        this.handleSelect(currentItem, false);\n    };\n\n    private goBack = () => {\n        if (!this.currentSubMenu) {\n            // Already in the root of the menu\n            return;\n        }\n\n        const parent = this.currentSubMenu.parentItem;\n        if (!parent) {\n            // If only one step down, go to the root of the menu.\n            // No need to load a sub-menu.\n            this.currentSubMenu = null;\n            this.clearSearch();\n            this.navigateMenu.emit(null);\n\n            this.setFocus();\n\n            return;\n        }\n\n        this.handleSelect(parent);\n    };\n\n    private setTriggerAttributes = (element: HTMLElement) => {\n        const attributes = {\n            'aria-haspopup': true,\n            'aria-expanded': this.open,\n            'aria-controls': this.portalId,\n            disabled: this.disabled,\n            role: 'button',\n        };\n\n        for (const [key, value] of Object.entries(attributes)) {\n            if (!value) {\n                element.removeAttribute(key);\n            } else {\n                element.setAttribute(key, String(value));\n            }\n        }\n    };\n\n    private onClose = () => {\n        this.cancel.emit();\n        this.open = false;\n        this.currentSubMenu = null;\n    };\n\n    private onTriggerClick = (event: MouseEvent) => {\n        event.stopPropagation();\n        if (this.disabled) {\n            return;\n        }\n\n        this.open = !this.open;\n    };\n\n    private handleSelect = async (\n        menuItem: MenuItem,\n        selectOnEmptyChildren: boolean = true,\n    ) => {\n        if (Array.isArray(menuItem?.items) && menuItem.items.length > 0) {\n            this.selectedMenuItem = menuItem;\n            this.clearSearch();\n            this.currentSubMenu = menuItem;\n            this.navigateMenu.emit(menuItem);\n\n            this.setFocus();\n\n            return;\n        } else if (isFunction(menuItem?.items)) {\n            const menuLoader = menuItem.items as MenuLoader;\n            this.selectedMenuItem = menuItem;\n            this.loadingSubItems = true;\n            const subItems = await menuLoader(menuItem);\n\n            if (this.selectedMenuItem !== menuItem) {\n                return;\n            }\n\n            menuItem.items = subItems;\n            this.loadingSubItems = false;\n\n            if (subItems?.length) {\n                this.currentSubMenu = menuItem;\n                this.clearSearch();\n                this.navigateMenu.emit(menuItem);\n\n                this.setFocus();\n\n                return;\n            }\n        }\n\n        if (!selectOnEmptyChildren) {\n            return;\n        }\n\n        this.selectedMenuItem = menuItem;\n        this.loadingSubItems = false;\n\n        this.select.emit(menuItem);\n        this.open = false;\n        this.currentSubMenu = null;\n        this.setFocus();\n    };\n\n    private onSelect = (event: CustomEvent<MenuItem>) => {\n        event.stopPropagation();\n        this.handleSelect(event.detail);\n    };\n\n    private getCssProperties() {\n        const propertyNames = [\n            '--menu-surface-width',\n            '--list-grid-item-max-width',\n            '--list-grid-item-min-width',\n            '--list-grid-gap',\n            '--notification-badge-background-color',\n            '--notification-badge-text-color',\n        ] as const;\n        const style = getComputedStyle(this.host);\n        const values = propertyNames.map((property) => {\n            return style.getPropertyValue(property);\n        });\n\n        type PropName = (typeof propertyNames)[number];\n\n        return zipObject(propertyNames, values) as Record<PropName, string>;\n    }\n\n    private setListElement = (element: HTMLLimelMenuListElement) => {\n        this.list = element;\n    };\n\n    private setFocus = () => {\n        setTimeout(() => {\n            if (this.searchInput && this.searcher) {\n                const observer = new IntersectionObserver(() => {\n                    observer.unobserve(this.searchInput);\n                    if (this.searchInput === window.document.activeElement) {\n                        return;\n                    }\n\n                    this.searchInput.focus();\n                });\n                observer.observe(this.searchInput);\n            } else if (this.list) {\n                const observer = new IntersectionObserver(() => {\n                    observer.unobserve(this.list);\n                    this.focusMenuItem();\n                });\n                observer.observe(this.list);\n            }\n        }, 0);\n    };\n\n    private setSearchElement = (element: HTMLLimelInputFieldElement) => {\n        this.searchInput = element;\n    };\n\n    private focusMenuItem = () => {\n        if (!this.list) {\n            return;\n        }\n\n        const activeElement = this.list.shadowRoot.activeElement as HTMLElement;\n        activeElement?.blur();\n\n        const menuItems = this.visibleItems.filter(this.isMenuItem);\n        const selectedIndex = Math.max(\n            menuItems.findIndex((item) => item.selected),\n            0,\n        );\n        const menuElements: HTMLElement[] = Array.from(\n            this.list.shadowRoot.querySelectorAll('[role=\"menuitem\"]'),\n        );\n        menuElements[selectedIndex]?.focus();\n    };\n\n    private isMenuItem(item: MenuItem | ListSeparator): item is MenuItem {\n        return !('separator' in item);\n    }\n\n    private renderNotificationBadge = () => {\n        if (this.items.some(this.hasNotificationBadge)) {\n            return <limel-badge />;\n        }\n    };\n\n    private hasNotificationBadge = (item: MenuItem | ListSeparator) =>\n        this.isMenuItem(item) && item.badge !== undefined;\n\n    private setTriggerRef = (elm?: HTMLSlotElement) => {\n        this.triggerElement = elm;\n    };\n\n    private getMenuSurfaceWidth(customWidth: string): string {\n        if (customWidth) {\n            return customWidth;\n        }\n\n        if (this.surfaceWidth === 'inherit-from-trigger') {\n            const assignedTriggers = this.triggerElement?.assignedElements();\n\n            if (\n                !assignedTriggers?.length ||\n                !assignedTriggers[0]?.clientWidth\n            ) {\n                return '';\n            }\n\n            return `${assignedTriggers[0].clientWidth}px`;\n        } else if (this.surfaceWidth === 'inherit-from-menu') {\n            if (!this.host?.clientWidth) {\n                return '';\n            }\n\n            return `${this.host?.clientWidth}px`;\n        }\n\n        return '';\n    }\n\n    private get visibleItems(): Array<MenuItem | ListSeparator> {\n        if (Array.isArray(this.searchResults) && this.searchValue) {\n            return this.searchResults;\n        } else if (Array.isArray(this.currentSubMenu?.items)) {\n            return this.currentSubMenu.items.map((item) => ({\n                ...item,\n                parentItem: this.currentSubMenu,\n            }));\n        }\n\n        return this.items;\n    }\n}\n","/**\n * @license\n * Copyright 2018 Google Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nvar cssClasses = {\n    MENU_SELECTED_LIST_ITEM: 'mdc-menu-item--selected',\n    MENU_SELECTION_GROUP: 'mdc-menu__selection-group',\n    ROOT: 'mdc-menu',\n};\nvar strings = {\n    ARIA_CHECKED_ATTR: 'aria-checked',\n    ARIA_DISABLED_ATTR: 'aria-disabled',\n    CHECKBOX_SELECTOR: 'input[type=\"checkbox\"]',\n    LIST_SELECTOR: '.mdc-list,.mdc-deprecated-list',\n    SELECTED_EVENT: 'MDCMenu:selected',\n    SKIP_RESTORE_FOCUS: 'data-menu-item-skip-restore-focus',\n};\nvar numbers = {\n    FOCUS_ROOT_INDEX: -1,\n};\nvar DefaultFocusState;\n(function (DefaultFocusState) {\n    DefaultFocusState[DefaultFocusState[\"NONE\"] = 0] = \"NONE\";\n    DefaultFocusState[DefaultFocusState[\"LIST_ROOT\"] = 1] = \"LIST_ROOT\";\n    DefaultFocusState[DefaultFocusState[\"FIRST_ITEM\"] = 2] = \"FIRST_ITEM\";\n    DefaultFocusState[DefaultFocusState[\"LAST_ITEM\"] = 3] = \"LAST_ITEM\";\n})(DefaultFocusState || (DefaultFocusState = {}));\nexport { cssClasses, strings, numbers, DefaultFocusState };\n//# sourceMappingURL=constants.js.map","/**\n * @license\n * Copyright 2018 Google Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport { __assign, __extends } from \"tslib\";\nimport { MDCFoundation } from '@material/base/foundation';\nimport { cssClasses as listCssClasses } from '@material/list/constants';\nimport { MDCMenuSurfaceFoundation } from '@material/menu-surface/foundation';\nimport { cssClasses, DefaultFocusState, numbers, strings } from './constants';\nvar MDCMenuFoundation = /** @class */ (function (_super) {\n    __extends(MDCMenuFoundation, _super);\n    function MDCMenuFoundation(adapter) {\n        var _this = _super.call(this, __assign(__assign({}, MDCMenuFoundation.defaultAdapter), adapter)) || this;\n        _this.closeAnimationEndTimerId = 0;\n        _this.defaultFocusState = DefaultFocusState.LIST_ROOT;\n        _this.selectedIndex = -1;\n        return _this;\n    }\n    Object.defineProperty(MDCMenuFoundation, \"cssClasses\", {\n        get: function () {\n            return cssClasses;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MDCMenuFoundation, \"strings\", {\n        get: function () {\n            return strings;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MDCMenuFoundation, \"numbers\", {\n        get: function () {\n            return numbers;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MDCMenuFoundation, \"defaultAdapter\", {\n        /**\n         * @see {@link MDCMenuAdapter} for typing information on parameters and return types.\n         */\n        get: function () {\n            // tslint:disable:object-literal-sort-keys Methods should be in the same order as the adapter interface.\n            return {\n                addClassToElementAtIndex: function () { return undefined; },\n                removeClassFromElementAtIndex: function () { return undefined; },\n                addAttributeToElementAtIndex: function () { return undefined; },\n                removeAttributeFromElementAtIndex: function () { return undefined; },\n                getAttributeFromElementAtIndex: function () { return null; },\n                elementContainsClass: function () { return false; },\n                closeSurface: function () { return undefined; },\n                getElementIndex: function () { return -1; },\n                notifySelected: function () { return undefined; },\n                getMenuItemCount: function () { return 0; },\n                focusItemAtIndex: function () { return undefined; },\n                focusListRoot: function () { return undefined; },\n                getSelectedSiblingOfItemAtIndex: function () { return -1; },\n                isSelectableItemAtIndex: function () { return false; },\n            };\n            // tslint:enable:object-literal-sort-keys\n        },\n        enumerable: false,\n        configurable: true\n    });\n    MDCMenuFoundation.prototype.destroy = function () {\n        if (this.closeAnimationEndTimerId) {\n            clearTimeout(this.closeAnimationEndTimerId);\n        }\n        this.adapter.closeSurface();\n    };\n    MDCMenuFoundation.prototype.handleKeydown = function (evt) {\n        var key = evt.key, keyCode = evt.keyCode;\n        var isTab = key === 'Tab' || keyCode === 9;\n        if (isTab) {\n            this.adapter.closeSurface(/** skipRestoreFocus */ true);\n        }\n    };\n    MDCMenuFoundation.prototype.handleItemAction = function (listItem) {\n        var _this = this;\n        var index = this.adapter.getElementIndex(listItem);\n        if (index < 0) {\n            return;\n        }\n        this.adapter.notifySelected({ index: index });\n        var skipRestoreFocus = this.adapter.getAttributeFromElementAtIndex(index, strings.SKIP_RESTORE_FOCUS) === 'true';\n        this.adapter.closeSurface(skipRestoreFocus);\n        // Wait for the menu to close before adding/removing classes that affect styles.\n        this.closeAnimationEndTimerId = setTimeout(function () {\n            // Recompute the index in case the menu contents have changed.\n            var recomputedIndex = _this.adapter.getElementIndex(listItem);\n            if (recomputedIndex >= 0 &&\n                _this.adapter.isSelectableItemAtIndex(recomputedIndex)) {\n                _this.setSelectedIndex(recomputedIndex);\n            }\n        }, MDCMenuSurfaceFoundation.numbers.TRANSITION_CLOSE_DURATION);\n    };\n    MDCMenuFoundation.prototype.handleMenuSurfaceOpened = function () {\n        switch (this.defaultFocusState) {\n            case DefaultFocusState.FIRST_ITEM:\n                this.adapter.focusItemAtIndex(0);\n                break;\n            case DefaultFocusState.LAST_ITEM:\n                this.adapter.focusItemAtIndex(this.adapter.getMenuItemCount() - 1);\n                break;\n            case DefaultFocusState.NONE:\n                // Do nothing.\n                break;\n            default:\n                this.adapter.focusListRoot();\n                break;\n        }\n    };\n    /**\n     * Sets default focus state where the menu should focus every time when menu\n     * is opened. Focuses the list root (`DefaultFocusState.LIST_ROOT`) element by\n     * default.\n     */\n    MDCMenuFoundation.prototype.setDefaultFocusState = function (focusState) {\n        this.defaultFocusState = focusState;\n    };\n    /** @return Index of the currently selected list item within the menu. */\n    MDCMenuFoundation.prototype.getSelectedIndex = function () {\n        return this.selectedIndex;\n    };\n    /**\n     * Selects the list item at `index` within the menu.\n     * @param index Index of list item within the menu.\n     */\n    MDCMenuFoundation.prototype.setSelectedIndex = function (index) {\n        this.validatedIndex(index);\n        if (!this.adapter.isSelectableItemAtIndex(index)) {\n            throw new Error('MDCMenuFoundation: No selection group at specified index.');\n        }\n        var prevSelectedIndex = this.adapter.getSelectedSiblingOfItemAtIndex(index);\n        if (prevSelectedIndex >= 0) {\n            this.adapter.removeAttributeFromElementAtIndex(prevSelectedIndex, strings.ARIA_CHECKED_ATTR);\n            this.adapter.removeClassFromElementAtIndex(prevSelectedIndex, cssClasses.MENU_SELECTED_LIST_ITEM);\n        }\n        this.adapter.addClassToElementAtIndex(index, cssClasses.MENU_SELECTED_LIST_ITEM);\n        this.adapter.addAttributeToElementAtIndex(index, strings.ARIA_CHECKED_ATTR, 'true');\n        this.selectedIndex = index;\n    };\n    /**\n     * Sets the enabled state to isEnabled for the menu item at the given index.\n     * @param index Index of the menu item\n     * @param isEnabled The desired enabled state of the menu item.\n     */\n    MDCMenuFoundation.prototype.setEnabled = function (index, isEnabled) {\n        this.validatedIndex(index);\n        if (isEnabled) {\n            this.adapter.removeClassFromElementAtIndex(index, listCssClasses.LIST_ITEM_DISABLED_CLASS);\n            this.adapter.addAttributeToElementAtIndex(index, strings.ARIA_DISABLED_ATTR, 'false');\n        }\n        else {\n            this.adapter.addClassToElementAtIndex(index, listCssClasses.LIST_ITEM_DISABLED_CLASS);\n            this.adapter.addAttributeToElementAtIndex(index, strings.ARIA_DISABLED_ATTR, 'true');\n        }\n    };\n    MDCMenuFoundation.prototype.validatedIndex = function (index) {\n        var menuSize = this.adapter.getMenuItemCount();\n        var isIndexInRange = index >= 0 && index < menuSize;\n        if (!isIndexInRange) {\n            throw new Error('MDCMenuFoundation: No list item at specified index.');\n        }\n    };\n    return MDCMenuFoundation;\n}(MDCFoundation));\nexport { MDCMenuFoundation };\n// tslint:disable-next-line:no-default-export Needed for backward compatibility with MDC Web v0.44.0 and earlier.\nexport default MDCMenuFoundation;\n//# sourceMappingURL=foundation.js.map","/**\n * @license\n * Copyright 2018 Google Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport { __extends } from \"tslib\";\nimport { MDCComponent } from '@material/base/component';\nimport { closest } from '@material/dom/ponyfill';\nimport { MDCList } from '@material/list/component';\nimport { numbers as listConstants } from '@material/list/constants';\nimport { MDCListFoundation } from '@material/list/foundation';\nimport { MDCMenuSurface } from '@material/menu-surface/component';\nimport { MDCMenuSurfaceFoundation } from '@material/menu-surface/foundation';\nimport { cssClasses, strings } from './constants';\nimport { MDCMenuFoundation } from './foundation';\nvar MDCMenu = /** @class */ (function (_super) {\n    __extends(MDCMenu, _super);\n    function MDCMenu() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    MDCMenu.attachTo = function (root) {\n        return new MDCMenu(root);\n    };\n    MDCMenu.prototype.initialize = function (menuSurfaceFactory, listFactory) {\n        if (menuSurfaceFactory === void 0) { menuSurfaceFactory = function (el) { return new MDCMenuSurface(el); }; }\n        if (listFactory === void 0) { listFactory = function (el) { return new MDCList(el); }; }\n        this.menuSurfaceFactory = menuSurfaceFactory;\n        this.listFactory = listFactory;\n    };\n    MDCMenu.prototype.initialSyncWithDOM = function () {\n        var _this = this;\n        this.menuSurface = this.menuSurfaceFactory(this.root);\n        var list = this.root.querySelector(strings.LIST_SELECTOR);\n        if (list) {\n            this.list = this.listFactory(list);\n            this.list.wrapFocus = true;\n        }\n        else {\n            this.list = null;\n        }\n        this.handleKeydown = function (evt) {\n            _this.foundation.handleKeydown(evt);\n        };\n        this.handleItemAction = function (evt) {\n            _this.foundation.handleItemAction(_this.items[evt.detail.index]);\n        };\n        this.handleMenuSurfaceOpened = function () {\n            _this.foundation.handleMenuSurfaceOpened();\n        };\n        this.menuSurface.listen(MDCMenuSurfaceFoundation.strings.OPENED_EVENT, this.handleMenuSurfaceOpened);\n        this.listen('keydown', this.handleKeydown);\n        this.listen(MDCListFoundation.strings.ACTION_EVENT, this.handleItemAction);\n    };\n    MDCMenu.prototype.destroy = function () {\n        if (this.list) {\n            this.list.destroy();\n        }\n        this.menuSurface.destroy();\n        this.menuSurface.unlisten(MDCMenuSurfaceFoundation.strings.OPENED_EVENT, this.handleMenuSurfaceOpened);\n        this.unlisten('keydown', this.handleKeydown);\n        this.unlisten(MDCListFoundation.strings.ACTION_EVENT, this.handleItemAction);\n        _super.prototype.destroy.call(this);\n    };\n    Object.defineProperty(MDCMenu.prototype, \"open\", {\n        get: function () {\n            return this.menuSurface.isOpen();\n        },\n        set: function (value) {\n            if (value) {\n                this.menuSurface.open();\n            }\n            else {\n                this.menuSurface.close();\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MDCMenu.prototype, \"wrapFocus\", {\n        get: function () {\n            return this.list ? this.list.wrapFocus : false;\n        },\n        set: function (value) {\n            if (this.list) {\n                this.list.wrapFocus = value;\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MDCMenu.prototype, \"hasTypeahead\", {\n        /**\n         * Sets whether the menu has typeahead functionality.\n         * @param value Whether typeahead is enabled.\n         */\n        set: function (value) {\n            if (this.list) {\n                this.list.hasTypeahead = value;\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MDCMenu.prototype, \"typeaheadInProgress\", {\n        /**\n         * @return Whether typeahead logic is currently matching some user prefix.\n         */\n        get: function () {\n            return this.list ? this.list.typeaheadInProgress : false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Given the next desired character from the user, adds it to the typeahead\n     * buffer. Then, attempts to find the next option matching the buffer. Wraps\n     * around if at the end of options.\n     *\n     * @param nextChar The next character to add to the prefix buffer.\n     * @param startingIndex The index from which to start matching. Only relevant\n     *     when starting a new match sequence. To start a new match sequence,\n     *     clear the buffer using `clearTypeaheadBuffer`, or wait for the buffer\n     *     to clear after a set interval defined in list foundation. Defaults to\n     *     the currently focused index.\n     * @return The index of the matched item, or -1 if no match.\n     */\n    MDCMenu.prototype.typeaheadMatchItem = function (nextChar, startingIndex) {\n        if (this.list) {\n            return this.list.typeaheadMatchItem(nextChar, startingIndex);\n        }\n        return -1;\n    };\n    /**\n     * Layout the underlying list element in the case of any dynamic updates\n     * to its structure.\n     */\n    MDCMenu.prototype.layout = function () {\n        if (this.list) {\n            this.list.layout();\n        }\n    };\n    Object.defineProperty(MDCMenu.prototype, \"items\", {\n        /**\n         * Return the items within the menu. Note that this only contains the set of elements within\n         * the items container that are proper list items, and not supplemental / presentational DOM\n         * elements.\n         */\n        get: function () {\n            return this.list ? this.list.listElements : [];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MDCMenu.prototype, \"singleSelection\", {\n        /**\n         * Turns on/off the underlying list's single selection mode. Used mainly\n         * by select menu.\n         *\n         * @param singleSelection Whether to enable single selection mode.\n         */\n        set: function (singleSelection) {\n            if (this.list) {\n                this.list.singleSelection = singleSelection;\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MDCMenu.prototype, \"selectedIndex\", {\n        /**\n         * Retrieves the selected index. Only applicable to select menus.\n         * @return The selected index, which is a number for single selection and\n         *     radio lists, and an array of numbers for checkbox lists.\n         */\n        get: function () {\n            return this.list ? this.list.selectedIndex : listConstants.UNSET_INDEX;\n        },\n        /**\n         * Sets the selected index of the list. Only applicable to select menus.\n         * @param index The selected index, which is a number for single selection and\n         *     radio lists, and an array of numbers for checkbox lists.\n         */\n        set: function (index) {\n            if (this.list) {\n                this.list.selectedIndex = index;\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MDCMenu.prototype, \"quickOpen\", {\n        set: function (quickOpen) {\n            this.menuSurface.quickOpen = quickOpen;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Sets default focus state where the menu should focus every time when menu\n     * is opened. Focuses the list root (`DefaultFocusState.LIST_ROOT`) element by\n     * default.\n     * @param focusState Default focus state.\n     */\n    MDCMenu.prototype.setDefaultFocusState = function (focusState) {\n        this.foundation.setDefaultFocusState(focusState);\n    };\n    /**\n     * @param corner Default anchor corner alignment of top-left menu corner.\n     */\n    MDCMenu.prototype.setAnchorCorner = function (corner) {\n        this.menuSurface.setAnchorCorner(corner);\n    };\n    MDCMenu.prototype.setAnchorMargin = function (margin) {\n        this.menuSurface.setAnchorMargin(margin);\n    };\n    /**\n     * Sets the list item as the selected row at the specified index.\n     * @param index Index of list item within menu.\n     */\n    MDCMenu.prototype.setSelectedIndex = function (index) {\n        this.foundation.setSelectedIndex(index);\n    };\n    /**\n     * Sets the enabled state to isEnabled for the menu item at the given index.\n     * @param index Index of the menu item\n     * @param isEnabled The desired enabled state of the menu item.\n     */\n    MDCMenu.prototype.setEnabled = function (index, isEnabled) {\n        this.foundation.setEnabled(index, isEnabled);\n    };\n    /**\n     * @return The item within the menu at the index specified.\n     */\n    MDCMenu.prototype.getOptionByIndex = function (index) {\n        var items = this.items;\n        if (index < items.length) {\n            return this.items[index];\n        }\n        else {\n            return null;\n        }\n    };\n    /**\n     * @param index A menu item's index.\n     * @return The primary text within the menu at the index specified.\n     */\n    MDCMenu.prototype.getPrimaryTextAtIndex = function (index) {\n        var item = this.getOptionByIndex(index);\n        if (item && this.list) {\n            return this.list.getPrimaryText(item) || '';\n        }\n        return '';\n    };\n    MDCMenu.prototype.setFixedPosition = function (isFixed) {\n        this.menuSurface.setFixedPosition(isFixed);\n    };\n    MDCMenu.prototype.setIsHoisted = function (isHoisted) {\n        this.menuSurface.setIsHoisted(isHoisted);\n    };\n    MDCMenu.prototype.setAbsolutePosition = function (x, y) {\n        this.menuSurface.setAbsolutePosition(x, y);\n    };\n    /**\n     * Sets the element that the menu-surface is anchored to.\n     */\n    MDCMenu.prototype.setAnchorElement = function (element) {\n        this.menuSurface.anchorElement = element;\n    };\n    MDCMenu.prototype.getDefaultFoundation = function () {\n        var _this = this;\n        // DO NOT INLINE this variable. For backward compatibility, foundations take a Partial<MDCFooAdapter>.\n        // To ensure we don't accidentally omit any methods, we need a separate, strongly typed adapter variable.\n        // tslint:disable:object-literal-sort-keys Methods should be in the same order as the adapter interface.\n        var adapter = {\n            addClassToElementAtIndex: function (index, className) {\n                var list = _this.items;\n                list[index].classList.add(className);\n            },\n            removeClassFromElementAtIndex: function (index, className) {\n                var list = _this.items;\n                list[index].classList.remove(className);\n            },\n            addAttributeToElementAtIndex: function (index, attr, value) {\n                var list = _this.items;\n                list[index].setAttribute(attr, value);\n            },\n            removeAttributeFromElementAtIndex: function (index, attr) {\n                var list = _this.items;\n                list[index].removeAttribute(attr);\n            },\n            getAttributeFromElementAtIndex: function (index, attr) {\n                var list = _this.items;\n                return list[index].getAttribute(attr);\n            },\n            elementContainsClass: function (element, className) {\n                return element.classList.contains(className);\n            },\n            closeSurface: function (skipRestoreFocus) {\n                _this.menuSurface.close(skipRestoreFocus);\n            },\n            getElementIndex: function (element) { return _this.items.indexOf(element); },\n            notifySelected: function (evtData) {\n                _this.emit(strings.SELECTED_EVENT, {\n                    index: evtData.index,\n                    item: _this.items[evtData.index],\n                });\n            },\n            getMenuItemCount: function () { return _this.items.length; },\n            focusItemAtIndex: function (index) {\n                _this.items[index].focus();\n            },\n            focusListRoot: function () {\n                _this.root.querySelector(strings.LIST_SELECTOR).focus();\n            },\n            isSelectableItemAtIndex: function (index) {\n                return !!closest(_this.items[index], \".\" + cssClasses.MENU_SELECTION_GROUP);\n            },\n            getSelectedSiblingOfItemAtIndex: function (index) {\n                var selectionGroupEl = closest(_this.items[index], \".\" + cssClasses.MENU_SELECTION_GROUP);\n                var selectedItemEl = selectionGroupEl.querySelector(\".\" + cssClasses.MENU_SELECTED_LIST_ITEM);\n                return selectedItemEl ? _this.items.indexOf(selectedItemEl) : -1;\n            },\n        };\n        // tslint:enable:object-literal-sort-keys\n        return new MDCMenuFoundation(adapter);\n    };\n    return MDCMenu;\n}(MDCComponent));\nexport { MDCMenu };\n//# sourceMappingURL=component.js.map","import { ListSeparator } from '../list/list-item.types';\nimport { MenuItem } from '../menu/menu.types';\nimport { h } from '@stencil/core';\nimport { MenuListRendererConfig } from './menu-list-renderer-config';\nimport { getIconColor, getIconName } from '../icon/get-icon-props';\nimport { isFunction } from 'lodash-es';\n\nexport class MenuListRenderer {\n    private defaultConfig: MenuListRendererConfig = {\n        isOpen: true,\n        badgeIcons: false,\n    };\n\n    private config: MenuListRendererConfig;\n\n    private hasIcons: boolean;\n    private twoLines: boolean;\n    private avatarList: boolean;\n    private commandKey: boolean;\n\n    private applyTabIndexToItemAtIndex: number;\n\n    public render(\n        items: Array<MenuItem | ListSeparator>,\n        config: MenuListRendererConfig = {},\n    ) {\n        items = items || [];\n        this.config = { ...this.defaultConfig, ...config };\n\n        this.twoLines = items.some((item) => {\n            return 'secondaryText' in item && !!item.secondaryText;\n        });\n\n        this.commandKey = items.some((item) => {\n            return 'commandText' in item && !!item.commandText;\n        });\n\n        this.hasIcons = items.some((item) => {\n            return 'icon' in item && !!item.icon;\n        });\n\n        this.avatarList = this.config.badgeIcons && this.hasIcons;\n\n        this.applyTabIndexToItemAtIndex =\n            this.getIndexForWhichToApplyTabIndex(items);\n\n        const classNames = {\n            'mdc-deprecated-list': true,\n            'mdc-deprecated-list--two-line': this.twoLines,\n            selectable: true,\n            'mdc-deprecated-list--avatar-list': this.avatarList,\n            'list--compact':\n                this.twoLines &&\n                this.commandKey &&\n                ['small', 'x-small'].includes(this.config.iconSize),\n        };\n\n        return (\n            <ul\n                class={classNames}\n                role=\"menu\"\n                aria-orientation=\"vertical\"\n                style={{ '--maxLinesSecondaryText': '2' }}\n            >\n                {items.map(this.renderMenuItem)}\n            </ul>\n        );\n    }\n\n    /**\n     * Determine which MenuItem should have the `tab-index` attribute set,\n     * and return the index at which that MenuItem is located in `items`.\n     * Returns `undefined` if no item should have the attribute set.\n     * See https://github.com/material-components/material-components-web/tree/e66a43a75fef4f9179e24856649518e15e279a04/packages/mdc-list#accessibility\n     *\n     * @param items - the items of the list, including any `ListSeparator`:s\n     * @returns the index as per the description\n     */\n    private getIndexForWhichToApplyTabIndex = (\n        items: Array<MenuItem | ListSeparator>,\n    ) => {\n        let result;\n        for (let i = 0, max = items.length; i < max; i += 1) {\n            if ('separator' in items[i]) {\n                // Ignore ListSeparator\n            } else {\n                const item = items[i] as MenuItem<any>;\n                if (item.selected) {\n                    result = i;\n                    break;\n                }\n\n                if (result === undefined && !item.disabled) {\n                    result = i;\n                    // Do NOT break, as any later item with\n                    // `selected=true` should get the tab-index instead!\n                }\n            }\n        }\n\n        return result;\n    };\n\n    /**\n     * Render a single list item\n     *\n     * @param item - the item to render\n     * @param index - the index the item had in the `items` array\n     * @returns the list item\n     */\n    private renderMenuItem = (\n        item: MenuItem | ListSeparator,\n        index: number,\n    ) => {\n        if ('separator' in item) {\n            return (\n                <li class=\"mdc-deprecated-list-divider\" role=\"separator\">\n                    {this.rendertext(item)}\n                    <div class=\"limel-list-divider-line\" />\n                </li>\n            );\n        }\n\n        const classNames = {\n            'mdc-deprecated-list-item': true,\n            'mdc-deprecated-list-item--disabled': item.disabled,\n            'mdc-deprecated-list-item--selected': item.selected,\n        };\n\n        const attributes: { tabindex?: string } = {};\n        if (index === this.applyTabIndexToItemAtIndex) {\n            attributes.tabindex = '0';\n        }\n\n        return (\n            <li\n                class={classNames}\n                role=\"menuitem\"\n                aria-disabled={item.disabled ? 'true' : 'false'}\n                aria-selected={item.selected ? 'true' : 'false'}\n                data-index={index}\n                {...attributes}\n            >\n                {this.renderIcon(this.config, item)}\n                {this.renderText(item)}\n                {this.renderSubMenuIcon(item)}\n                {this.renderNotification(item)}\n                {this.twoLines && this.avatarList ? this.renderDivider() : null}\n            </li>\n        );\n    };\n\n    /**\n     * Render the text of the list item\n     *\n     * @param item - the list item\n     * @returns the text for the list item\n     */\n    private renderText = (item: MenuItem) => {\n        if (this.isSimpleItem(item)) {\n            return (\n                <span class=\"mdc-deprecated-list-item__text\">{item.text}</span>\n            );\n        }\n\n        return (\n            <div class=\"mdc-deprecated-list-item__text\">\n                <div class=\"mdc-deprecated-list-item__primary-command-text\">\n                    <div class=\"mdc-deprecated-list-item__primary-text\">\n                        {item.text}\n                    </div>\n                    {this.renderCommandText(item)}\n                </div>\n                <div class=\"mdc-deprecated-list-item__secondary-text\">\n                    {item.secondaryText}\n                </div>\n            </div>\n        );\n    };\n\n    private renderSubMenuIcon = (item: MenuItem) => {\n        if (!this.hasSubItems(item)) {\n            return;\n        }\n\n        return <limel-icon class=\"sub-menu-icon\" name=\"-lime-caret-right\" />;\n    };\n\n    private rendertext = (item: ListSeparator) => {\n        if ('text' in item) {\n            return <h2 class=\"limel-list-divider-title\">{item.text}</h2>;\n        }\n    };\n\n    private renderCommandText = (item: MenuItem) => {\n        if (!('commandText' in item)) {\n            return;\n        }\n\n        return (\n            <div class=\"mdc-deprecated-list-item__command-text\">\n                {item.commandText}\n            </div>\n        );\n    };\n\n    private isSimpleItem = (item: MenuItem): boolean => {\n        if ('commandText' in item) {\n            return false;\n        }\n\n        return !('secondaryText' in item);\n    };\n\n    /**\n     * Render an icon for a list item\n     *\n     * @param config - the config object, passed on from the `renderMenuItem` function\n     * @param item - the list item\n     * @returns the icon element\n     */\n    private renderIcon = (config: MenuListRendererConfig, item: MenuItem) => {\n        const style: any = {};\n        const name = getIconName(item.icon);\n        if (!name) {\n            return;\n        }\n\n        const color = getIconColor(item.icon, item.iconColor);\n\n        if (color) {\n            if (config.badgeIcons) {\n                style['--icon-background-color'] = color;\n            } else {\n                style.color = color;\n            }\n        }\n\n        return (\n            <limel-icon\n                badge={config.badgeIcons}\n                class=\"mdc-deprecated-list-item__graphic\"\n                name={name}\n                style={style}\n                size={config.iconSize}\n            />\n        );\n    };\n\n    private renderNotification = (item: MenuItem) => {\n        if (item.badge !== undefined) {\n            return <limel-badge label={item.badge} />;\n        }\n    };\n\n    private renderDivider = () => {\n        const classes = {\n            'mdc-deprecated-list-divider': true,\n            'mdc-deprecated-list-divider--inset': true,\n        };\n        if (this.config.iconSize) {\n            classes[this.config.iconSize] = true;\n        }\n\n        return <hr class={classes} />;\n    };\n\n    private hasSubItems = (item: MenuItem): boolean => {\n        return (\n            (Array.isArray(item.items) && item.items.length > 0) ||\n            isFunction(item.items)\n        );\n    };\n}\n","@use '../../style/functions';\n\n@import '../list/list';\n\n:host(limel-menu-list) {\n    display: block;\n    --badge-background-color: var(\n        --notification-badge-background-color,\n        rgb(var(--color-red-default))\n    );\n    --badge-text-color: var(\n        --notification-badge-text-color,\n        rgb(var(--color-white))\n    );\n}\n\n.mdc-menu {\n    max-height: 70vh; // force tall menus render inside the viewport when menu is at the bottom of the screen\n}\n\n.mdc-deprecated-list {\n    margin: functions.pxToRem(4);\n    // added space to visualize keyboard-focused items\n    .mdc-deprecated-list-item[role='menuitem'] {\n        font-size: functions.pxToRem(13);\n\n        .mdc-deprecated-list-item__graphic {\n            margin-right: 0;\n            margin-left: -0.75rem;\n        }\n    }\n\n    hr.mdc-deprecated-list-divider {\n        &.mdc-deprecated-list-divider--inset {\n            display: none;\n        }\n    }\n}\n\nlimel-badge {\n    transform: translateX(0.75rem);\n}\n\n.sub-menu-icon {\n    width: 1rem;\n    transform: translateX(0.75rem);\n    flex-shrink: 0;\n}\n","import { IconSize } from '../icon/icon.types';\nimport { ListSeparator } from '../list/list-item.types';\nimport { MenuItem } from '../menu/menu.types';\nimport { MenuListType } from '../menu-list/menu-list.types';\nimport { MDCMenu, MDCMenuItemEvent } from '@material/menu';\nimport { MDCRipple } from '@material/ripple';\nimport { strings as menuStrings } from '@material/menu/constants';\nimport {\n    Component,\n    Element,\n    Event,\n    EventEmitter,\n    h,\n    Prop,\n    Watch,\n} from '@stencil/core';\nimport { MenuListRenderer } from './menu-list-renderer';\nimport { MenuListRendererConfig } from './menu-list-renderer-config';\n\nconst { SELECTED_EVENT } = menuStrings;\n\n/**\n * @private\n */\n@Component({\n    tag: 'limel-menu-list',\n    shadow: { delegatesFocus: true },\n    styleUrl: 'menu-list.scss',\n})\nexport class MenuList {\n    /**\n     * List of items to display\n     */\n    @Prop()\n    public items: Array<MenuItem | ListSeparator>;\n\n    /**\n     * Set to `true` if the list should display larger icons with a background\n     */\n    @Prop()\n    public badgeIcons: boolean;\n\n    /**\n     * Size of the icons in the list\n     */\n    @Prop()\n    public iconSize: IconSize = 'small';\n\n    /**\n     * The type of the menu, omit to get a regular vertical menu.\n     * Available types are:\n     * `menu`: regular vertical menu.\n     */\n    @Prop()\n    public type: MenuListType;\n\n    /**\n     * By default, lists will display 3 lines of text, and then truncate the rest.\n     * Consumers can increase or decrease this number by specifying\n     * `maxLinesSecondaryText`. If consumer enters zero or negative\n     * numbers we default to 1; and if they type decimals we round up.\n     */\n    // eslint-disable-next-line no-magic-numbers\n    @Prop() maxLinesSecondaryText: number = 3;\n\n    @Element()\n    private element: HTMLLimelMenuListElement;\n\n    private config: MenuListRendererConfig;\n    private MenuListRenderer = new MenuListRenderer();\n    private mdcMenu: MDCMenu;\n\n    /**\n     * Fired when a new value has been selected from the list.\n     */\n    @Event()\n    private select: EventEmitter<MenuItem>;\n\n    public connectedCallback() {\n        this.setup();\n    }\n\n    public disconnectedCallback() {\n        this.teardown();\n    }\n\n    public componentDidLoad() {\n        this.setup();\n        this.triggerIconColorWarning();\n    }\n\n    public render() {\n        this.config = {\n            badgeIcons: this.badgeIcons,\n            type: this.type,\n            iconSize: this.iconSize,\n        };\n\n        const html = this.MenuListRenderer.render(this.items, this.config);\n\n        return <div class=\"mdc-menu mdc-menu-surface\">{html}</div>;\n    }\n\n    @Watch('type')\n    protected handleType() {\n        this.setupListeners();\n    }\n\n    @Watch('items')\n    protected itemsChanged() {\n        setTimeout(() => {\n            this.setup();\n        }, 0);\n    }\n\n    private setup = () => {\n        this.setupMenu();\n        this.setupListeners();\n    };\n\n    private setupMenu = () => {\n        if (this.mdcMenu) {\n            this.teardown();\n            this.mdcMenu = null;\n        }\n\n        const element = this.element.shadowRoot.querySelector('.mdc-menu');\n        if (!element) {\n            return;\n        }\n\n        this.mdcMenu = new MDCMenu(element);\n        this.mdcMenu.hasTypeahead = true;\n        this.mdcMenu.wrapFocus = true;\n        this.mdcMenu.items.forEach((item) => new MDCRipple(item));\n    };\n\n    private setupListeners = () => {\n        if (!this.mdcMenu) {\n            return;\n        }\n\n        this.mdcMenu.unlisten(SELECTED_EVENT, this.handleMenuSelect);\n        this.mdcMenu.listen(SELECTED_EVENT, this.handleMenuSelect);\n    };\n\n    private teardown = () => {\n        this.mdcMenu?.unlisten(SELECTED_EVENT, this.handleMenuSelect);\n        this.mdcMenu?.destroy();\n    };\n\n    private handleMenuSelect = (event: MDCMenuItemEvent) => {\n        this.handleSingleSelect(event.detail.index);\n    };\n\n    private handleSingleSelect = (index: number) => {\n        const MenuItems = this.items.filter(this.isMenuItem) as MenuItem[];\n        if (MenuItems[index].disabled) {\n            return;\n        }\n\n        const selectedItem: MenuItem = MenuItems.find((item: MenuItem) => {\n            return !!item.selected;\n        });\n\n        if (selectedItem) {\n            this.select.emit({ ...selectedItem, selected: false });\n        }\n\n        if (MenuItems[index] !== selectedItem) {\n            this.select.emit({ ...MenuItems[index], selected: false });\n        }\n    };\n\n    private isMenuItem = (item: MenuItem): boolean => {\n        return !('separator' in item);\n    };\n\n    private triggerIconColorWarning() {\n        if (this.items?.some((item) => 'iconColor' in item)) {\n            /* eslint-disable-next-line no-console */\n            console.warn(\n                \"The `iconColor` prop is deprecated now! Use the new `Icon` interface and instead of `iconColor: 'color-name'` write `icon {name: 'icon-name', color: 'color-name'}`.\",\n            );\n        }\n    }\n}\n"],"mappings":"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"}