{"version":3,"names":["eventHandlers","WeakMap","EnterClickable","constructor","element","this","isActive","hasJustReleasedEnter","handleKeyDown","event","key","repeat","_a","shadowRoot","forceUpdate","handleKeyUp","handleBlur","handleClick","stopImmediatePropagation","callbacks","keydownHandler","bind","keyupHandler","blurHandler","clickHandler","enable","addEventListener","disable","removeEventListener","makeEnterClickable","has","enterClickable","set","removeEnterClickable","get","delete"],"sources":["./src/util/make-enter-clickable.ts"],"sourcesContent":["import { forceUpdate } from '@stencil/core';\n\nconst eventHandlers: WeakMap<HTMLElement, EnterClickable> = new WeakMap();\n\nclass EnterClickable {\n    private isActive = false;\n    private hasJustReleasedEnter = true;\n\n    constructor(private element: HTMLElement) {}\n\n    private handleKeyDown = (event: KeyboardEvent) => {\n        if (event.key === 'Enter' && !this.isActive && !event.repeat) {\n            this.isActive = true;\n\n            if (this.element?.shadowRoot) {\n                forceUpdate(this.element);\n            }\n        }\n    };\n\n    private handleKeyUp = (event: KeyboardEvent) => {\n        if (event.key === 'Enter' && this.isActive) {\n            this.isActive = false;\n            this.hasJustReleasedEnter = true;\n\n            if (this.element?.shadowRoot) {\n                forceUpdate(this.element);\n            }\n        }\n    };\n\n    private handleBlur = () => {\n        this.isActive = false;\n        this.hasJustReleasedEnter = true;\n    };\n\n    private handleClick = (event: MouseEvent) => {\n        if (!this.isActive) {\n            return;\n        }\n\n        if (this.hasJustReleasedEnter) {\n            this.hasJustReleasedEnter = false;\n\n            return;\n        }\n\n        event.stopImmediatePropagation();\n    };\n\n    private callbacks: CallBacks = {\n        keydownHandler: this.handleKeyDown.bind(this),\n        keyupHandler: this.handleKeyUp.bind(this),\n        blurHandler: this.handleBlur.bind(this),\n        clickHandler: this.handleClick.bind(this),\n    };\n\n    public enable() {\n        this.element.addEventListener('keydown', this.callbacks.keydownHandler);\n        this.element.addEventListener('keyup', this.callbacks.keyupHandler);\n        this.element.addEventListener('blur', this.callbacks.blurHandler);\n        this.element.addEventListener(\n            'click',\n            this.callbacks.clickHandler,\n            true\n        );\n    }\n\n    public disable() {\n        this.element.removeEventListener(\n            'keydown',\n            this.callbacks.keydownHandler\n        );\n        this.element.removeEventListener('keyup', this.callbacks.keyupHandler);\n        this.element.removeEventListener('blur', this.callbacks.blurHandler);\n        this.element.removeEventListener(\n            'click',\n            this.callbacks.clickHandler,\n            true\n        );\n    }\n}\n\n/**\n * Overrides the default browser behavior for clickable elements\n * When focused and pressing down enter, avoids calling onClick repeatedly\n *\n * @param element - The clickable element\n */\nexport function makeEnterClickable(element: HTMLElement) {\n    if (!eventHandlers.has(element)) {\n        const enterClickable = new EnterClickable(element);\n        enterClickable.enable();\n        eventHandlers.set(element, enterClickable);\n    }\n}\n\n/**\n * Removes the keyboard-enter click override behavior from an element.\n * Call this during teardown (e.g. `disconnectedCallback`) to avoid leaking\n * event listeners.\n *\n * @param element - The clickable element\n */\nexport function removeEnterClickable(element: HTMLElement) {\n    const enterClickable: EnterClickable = eventHandlers.get(element);\n    if (enterClickable) {\n        enterClickable.disable();\n        eventHandlers.delete(element);\n    }\n}\n\ninterface CallBacks {\n    keydownHandler: (arg: KeyboardEvent) => void;\n    keyupHandler: (arg: KeyboardEvent) => void;\n    blurHandler: () => void;\n    clickHandler: (arg: MouseEvent) => void;\n}\n"],"mappings":"wCAEA,MAAMA,EAAsD,IAAIC,QAEhE,MAAMC,EAIFC,YAAoBC,GAAAC,KAAAD,UAHZC,KAAAC,SAAW,MACXD,KAAAE,qBAAuB,KAIvBF,KAAAG,cAAiBC,I,MACrB,GAAIA,EAAMC,MAAQ,UAAYL,KAAKC,WAAaG,EAAME,OAAQ,CAC1DN,KAAKC,SAAW,KAEhB,IAAIM,EAAAP,KAAKD,WAAO,MAAAQ,SAAA,SAAAA,EAAEC,WAAY,CAC1BC,EAAYT,KAAKD,Q,IAKrBC,KAAAU,YAAeN,I,MACnB,GAAIA,EAAMC,MAAQ,SAAWL,KAAKC,SAAU,CACxCD,KAAKC,SAAW,MAChBD,KAAKE,qBAAuB,KAE5B,IAAIK,EAAAP,KAAKD,WAAO,MAAAQ,SAAA,SAAAA,EAAEC,WAAY,CAC1BC,EAAYT,KAAKD,Q,IAKrBC,KAAAW,WAAa,KACjBX,KAAKC,SAAW,MAChBD,KAAKE,qBAAuB,IAAI,EAG5BF,KAAAY,YAAeR,IACnB,IAAKJ,KAAKC,SAAU,CAChB,M,CAGJ,GAAID,KAAKE,qBAAsB,CAC3BF,KAAKE,qBAAuB,MAE5B,M,CAGJE,EAAMS,0BAA0B,EAG5Bb,KAAAc,UAAuB,CAC3BC,eAAgBf,KAAKG,cAAca,KAAKhB,MACxCiB,aAAcjB,KAAKU,YAAYM,KAAKhB,MACpCkB,YAAalB,KAAKW,WAAWK,KAAKhB,MAClCmB,aAAcnB,KAAKY,YAAYI,KAAKhB,M,CAGjCoB,SACHpB,KAAKD,QAAQsB,iBAAiB,UAAWrB,KAAKc,UAAUC,gBACxDf,KAAKD,QAAQsB,iBAAiB,QAASrB,KAAKc,UAAUG,cACtDjB,KAAKD,QAAQsB,iBAAiB,OAAQrB,KAAKc,UAAUI,aACrDlB,KAAKD,QAAQsB,iBACT,QACArB,KAAKc,UAAUK,aACf,K,CAIDG,UACHtB,KAAKD,QAAQwB,oBACT,UACAvB,KAAKc,UAAUC,gBAEnBf,KAAKD,QAAQwB,oBAAoB,QAASvB,KAAKc,UAAUG,cACzDjB,KAAKD,QAAQwB,oBAAoB,OAAQvB,KAAKc,UAAUI,aACxDlB,KAAKD,QAAQwB,oBACT,QACAvB,KAAKc,UAAUK,aACf,K,WAWIK,EAAmBzB,GAC/B,IAAKJ,EAAc8B,IAAI1B,GAAU,CAC7B,MAAM2B,EAAiB,IAAI7B,EAAeE,GAC1C2B,EAAeN,SACfzB,EAAcgC,IAAI5B,EAAS2B,E,CAEnC,C,SASgBE,EAAqB7B,GACjC,MAAM2B,EAAiC/B,EAAckC,IAAI9B,GACzD,GAAI2B,EAAgB,CAChBA,EAAeJ,UACf3B,EAAcmC,OAAO/B,E,CAE7B,Q"}