async function n(n,t){const{width:c,height:u,fit:l="cover",type:f="image/jpeg",quality:d=.85,rename:w=(n=>a(n,f))}=t;const y=await s(n);const{sx:h,sy:g,sw:p,sh:v,dx:m,dy:x,dw:b,dh:T}=i(y.width,y.height,c,u,l);const j=e(c,u);const q=o(j);q.clearRect(0,0,c,u);q.drawImage(y,h,g,p,v,m,x,b,T);const E=await r(j,f,d);const F=w(n.name);return new File([E],F,{type:f})}function t(){try{return typeof globalThis.OffscreenCanvas==="function"}catch(n){return false}}function e(n,e){if(t()){return new globalThis.OffscreenCanvas(n,e)}const o=document.createElement("canvas");o.width=n;o.height=e;return o}function o(n){const t=n.getContext("2d",{alpha:true});if(!t){throw new Error("2D canvas context not available")}return t}function r(n,t,e){if("convertToBlob"in n){return n.convertToBlob({type:t,quality:e})}return new Promise(((o,r)=>{n.toBlob((n=>{if(!n){r(new Error("Failed to create blob from canvas"));return}o(n)}),t,e)}))}async function s(n){return await c(n)}async function c(n){var t;const e=URL.createObjectURL(n);try{const n=new Image;n.decoding="sync";n.src=e;await((t=n.decode)===null||t===void 0?void 0:t.call(n).catch((()=>undefined)));if(!n.complete){await new Promise(((t,e)=>{const o=()=>{n.removeEventListener("load",r);n.removeEventListener("error",s)};const r=()=>{o();t()};const s=n=>{o();e(n)};n.addEventListener("load",r);n.addEventListener("error",s)}))}return n}finally{URL.revokeObjectURL(e)}}function i(n,t,e,o,r){const s=n/t;const c=e/o;if(r==="cover"){let r;let i;if(s>c){i=t;r=t*c}else{r=n;i=n/c}const a=(n-r)/2;const u=(t-i)/2;return{sx:a,sy:u,sw:r,sh:i,dx:0,dy:0,dw:e,dh:o}}let i;let a;if(s>c){i=e;a=e/s}else{a=o;i=o*s}const u=(e-i)/2;const l=(o-a)/2;return{sx:0,sy:0,sw:n,sh:t,dx:u,dy:l,dw:i,dh:a}}function a(n,t){const e=t==="image/png"?"png":"jpg";const o=n.lastIndexOf(".");const r=o>0?n.slice(0,o):n;return`${r}.${e}`}export{n as r};
//# sourceMappingURL=image-resize-9152c28a.js.map