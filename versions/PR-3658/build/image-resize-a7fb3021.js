async function t(t,n){const{width:c,height:l,fit:u="cover",type:f="image/jpeg",quality:d=.85,rename:w=(t=>s(t,f))}=n;const y=await a(t);const{sx:m,sy:g,sw:h,sh:p,dx:v,dy:b,dw:x,dh:I}=i(y.width,y.height,c,l,u);const T=e(c,l);const B=o(T);B.clearRect(0,0,c,l);B.drawImage(y,m,g,h,p,v,b,x,I);const E=await r(T,f,d);const L=w(t.name);return new File([E],L,{type:f})}function n(){try{return typeof globalThis.OffscreenCanvas==="function"}catch(t){return false}}function e(t,e){if(n()){return new globalThis.OffscreenCanvas(t,e)}const o=document.createElement("canvas");o.width=t;o.height=e;return o}function o(t){const n=t.getContext("2d",{alpha:true});if(!n){throw new Error("2D canvas context not available")}return n}function r(t,n,e){if("convertToBlob"in t){return t.convertToBlob({type:n,quality:e})}return new Promise(((o,r)=>{t.toBlob((t=>{if(!t){r(new Error("Failed to create blob from canvas"));return}o(t)}),n,e)}))}async function a(t){if("createImageBitmap"in globalThis){try{const n={imageOrientation:"from-image"};return await createImageBitmap(t,n)}catch(t){console.debug("createImageBitmap failed, falling back to HTMLImageElement:",t)}}return await c(t)}async function c(t){var n;const e=URL.createObjectURL(t);try{const t=new Image;t.decoding="sync";t.src=e;await((n=t.decode)===null||n===void 0?void 0:n.call(t).catch((()=>undefined)));if(!t.complete){await new Promise(((n,e)=>{const o=()=>{t.removeEventListener("load",r);t.removeEventListener("error",a)};const r=()=>{o();n()};const a=t=>{o();e(t)};t.addEventListener("load",r);t.addEventListener("error",a)}))}return t}finally{URL.revokeObjectURL(e)}}function i(t,n,e,o,r){const a=t/n;const c=e/o;if(r==="cover"){let r;let i;if(a>c){i=n;r=n*c}else{r=t;i=t/c}const s=(t-r)/2;const l=(n-i)/2;return{sx:s,sy:l,sw:r,sh:i,dx:0,dy:0,dw:e,dh:o}}let i;let s;if(a>c){i=e;s=e/a}else{s=o;i=o*a}const l=(e-i)/2;const u=(o-s)/2;return{sx:0,sy:0,sw:t,sh:n,dx:l,dy:u,dw:i,dh:s}}function s(t,n){const e=n==="image/png"?"png":"jpg";const o=t.lastIndexOf(".");const r=o>0?t.slice(0,o):t;return`${r}.${e}`}export{t as r};
//# sourceMappingURL=image-resize-a7fb3021.js.map