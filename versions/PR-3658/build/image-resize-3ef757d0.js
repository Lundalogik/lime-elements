async function t(t,n){const{width:c,height:u,fit:l="cover",type:f="image/jpeg",quality:d=.85,rename:w=(t=>s(t,f))}=n;const y=await a(t);const{sx:h,sy:g,sw:m,sh:p,dx:v,dy:x,dw:b,dh:T}=i(y.width,y.height,c,u,l);const B=e(c,u);const I=o(B);I.clearRect(0,0,c,u);I.drawImage(y,h,g,m,p,v,x,b,T);const j=await r(B,f,d);const q=w(t.name);return new File([j],q,{type:f})}function n(){try{return typeof globalThis.OffscreenCanvas==="function"}catch(t){return false}}function e(t,e){if(n()){return new globalThis.OffscreenCanvas(t,e)}const o=document.createElement("canvas");o.width=t;o.height=e;return o}function o(t){const n=t.getContext("2d",{alpha:true});if(!n){throw new Error("2D canvas context not available")}return n}function r(t,n,e){if("convertToBlob"in t){return t.convertToBlob({type:n,quality:e})}return new Promise(((o,r)=>{t.toBlob((t=>{if(!t){r(new Error("Failed to create blob from canvas"));return}o(t)}),n,e)}))}async function a(t){if("createImageBitmap"in globalThis){try{const n={imageOrientation:"from-image"};return await createImageBitmap(t,n)}catch(t){}}return await c(t)}async function c(t){var n;const e=URL.createObjectURL(t);try{const t=new Image;t.decoding="sync";t.src=e;await((n=t.decode)===null||n===void 0?void 0:n.call(t).catch((()=>undefined)));if(!t.complete){await new Promise(((n,e)=>{const o=()=>{t.removeEventListener("load",r);t.removeEventListener("error",a)};const r=()=>{o();n()};const a=t=>{o();e(t)};t.addEventListener("load",r);t.addEventListener("error",a)}))}return t}finally{URL.revokeObjectURL(e)}}function i(t,n,e,o,r){const a=t/n;const c=e/o;if(r==="cover"){let r;let i;if(a>c){i=n;r=n*c}else{r=t;i=t/c}const s=(t-r)/2;const u=(n-i)/2;return{sx:s,sy:u,sw:r,sh:i,dx:0,dy:0,dw:e,dh:o}}let i;let s;if(a>c){i=e;s=e/a}else{s=o;i=o*a}const u=(e-i)/2;const l=(o-s)/2;return{sx:0,sy:0,sw:t,sh:n,dx:u,dy:l,dw:i,dh:s}}function s(t,n){const e=n==="image/png"?"png":"jpg";const o=t.lastIndexOf(".");const r=o>0?t.slice(0,o):t;return`${r}.${e}`}export{t as r};
//# sourceMappingURL=image-resize-3ef757d0.js.map