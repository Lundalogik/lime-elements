{"version":3,"names":["eventHandlers","WeakMap","EnterClickable","constructor","element","this","isActive","hasJustReleasedEnter","handleKeyDown","event","key","_a","shadowRoot","forceUpdate","handleKeyUp","handleClick","stopImmediatePropagation","callbacks","keydownHandler","bind","keyupHandler","clickHandler","enable","addEventListener","disable","removeEventListener","makeEnterClickable","has","enterClickable","set","removeEnterClickable","get","delete"],"sources":["./src/util/make-enter-clickable.ts"],"sourcesContent":["import { forceUpdate } from '@stencil/core';\n\nconst eventHandlers: WeakMap<HTMLElement, EnterClickable> = new WeakMap();\n\nclass EnterClickable {\n    private isActive = false;\n    private hasJustReleasedEnter = true;\n\n    constructor(private element: HTMLElement) {}\n\n    private handleKeyDown = (event: KeyboardEvent) => {\n        if (event.key === 'Enter' && !this.isActive) {\n            this.isActive = true;\n\n            if (this.element?.shadowRoot) {\n                forceUpdate(this.element);\n            }\n        }\n    };\n\n    private handleKeyUp = (event: KeyboardEvent) => {\n        if (event.key === 'Enter' && this.isActive) {\n            this.isActive = false;\n            this.hasJustReleasedEnter = true;\n\n            if (this.element?.shadowRoot) {\n                forceUpdate(this.element);\n            }\n        }\n    };\n\n    private handleClick = (event: MouseEvent) => {\n        if (!this.isActive) {\n            return;\n        }\n\n        if (this.hasJustReleasedEnter) {\n            this.hasJustReleasedEnter = false;\n\n            return;\n        }\n\n        event.stopImmediatePropagation();\n    };\n\n    private callbacks: CallBacks = {\n        keydownHandler: this.handleKeyDown.bind(this),\n        keyupHandler: this.handleKeyUp.bind(this),\n        clickHandler: this.handleClick.bind(this),\n    };\n\n    public enable() {\n        this.element.addEventListener('keydown', this.callbacks.keydownHandler);\n        this.element.addEventListener('keyup', this.callbacks.keyupHandler);\n        this.element.addEventListener(\n            'click',\n            this.callbacks.clickHandler,\n            true\n        );\n    }\n\n    public disable() {\n        this.element.removeEventListener(\n            'keydown',\n            this.callbacks.keydownHandler\n        );\n        this.element.removeEventListener('keyup', this.callbacks.keyupHandler);\n        this.element.removeEventListener(\n            'click',\n            this.callbacks.clickHandler,\n            true\n        );\n    }\n}\n\n/**\n * Overrides the default browser behavior for clickable elements\n * When focused and pressing down enter, avoids calling onClick repeatedly\n *\n * @param element - The clickable element\n */\nexport function makeEnterClickable(element: HTMLElement) {\n    if (!eventHandlers.has(element)) {\n        const enterClickable = new EnterClickable(element);\n        enterClickable.enable();\n        eventHandlers.set(element, enterClickable);\n    }\n}\n\n/**\n *\n * @param element\n */\nexport function removeEnterClickable(element: HTMLElement) {\n    const enterClickable: EnterClickable = eventHandlers.get(element);\n    if (enterClickable) {\n        enterClickable.disable();\n        eventHandlers.delete(element);\n    }\n}\n\ninterface CallBacks {\n    keydownHandler: (arg: KeyboardEvent) => void;\n    keyupHandler: (arg: KeyboardEvent) => void;\n    clickHandler: (arg: MouseEvent) => void;\n}\n"],"mappings":"wCAEA,MAAMA,EAAsD,IAAIC,QAEhE,MAAMC,EAIFC,YAAoBC,GAAAC,KAAAD,UAHZC,KAAAC,SAAW,MACXD,KAAAE,qBAAuB,KAIvBF,KAAAG,cAAiBC,I,MACrB,GAAIA,EAAMC,MAAQ,UAAYL,KAAKC,SAAU,CACzCD,KAAKC,SAAW,KAEhB,IAAIK,EAAAN,KAAKD,WAAO,MAAAO,SAAA,SAAAA,EAAEC,WAAY,CAC1BC,EAAYR,KAAKD,Q,IAKrBC,KAAAS,YAAeL,I,MACnB,GAAIA,EAAMC,MAAQ,SAAWL,KAAKC,SAAU,CACxCD,KAAKC,SAAW,MAChBD,KAAKE,qBAAuB,KAE5B,IAAII,EAAAN,KAAKD,WAAO,MAAAO,SAAA,SAAAA,EAAEC,WAAY,CAC1BC,EAAYR,KAAKD,Q,IAKrBC,KAAAU,YAAeN,IACnB,IAAKJ,KAAKC,SAAU,CAChB,M,CAGJ,GAAID,KAAKE,qBAAsB,CAC3BF,KAAKE,qBAAuB,MAE5B,M,CAGJE,EAAMO,0BAA0B,EAG5BX,KAAAY,UAAuB,CAC3BC,eAAgBb,KAAKG,cAAcW,KAAKd,MACxCe,aAAcf,KAAKS,YAAYK,KAAKd,MACpCgB,aAAchB,KAAKU,YAAYI,KAAKd,M,CAGjCiB,SACHjB,KAAKD,QAAQmB,iBAAiB,UAAWlB,KAAKY,UAAUC,gBACxDb,KAAKD,QAAQmB,iBAAiB,QAASlB,KAAKY,UAAUG,cACtDf,KAAKD,QAAQmB,iBACT,QACAlB,KAAKY,UAAUI,aACf,K,CAIDG,UACHnB,KAAKD,QAAQqB,oBACT,UACApB,KAAKY,UAAUC,gBAEnBb,KAAKD,QAAQqB,oBAAoB,QAASpB,KAAKY,UAAUG,cACzDf,KAAKD,QAAQqB,oBACT,QACApB,KAAKY,UAAUI,aACf,K,WAWIK,EAAmBtB,GAC/B,IAAKJ,EAAc2B,IAAIvB,GAAU,CAC7B,MAAMwB,EAAiB,IAAI1B,EAAeE,GAC1CwB,EAAeN,SACftB,EAAc6B,IAAIzB,EAASwB,E,CAEnC,C,SAMgBE,EAAqB1B,GACjC,MAAMwB,EAAiC5B,EAAc+B,IAAI3B,GACzD,GAAIwB,EAAgB,CAChBA,EAAeJ,UACfxB,EAAcgC,OAAO5B,E,CAE7B,Q"}