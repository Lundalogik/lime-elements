import{u as i,g as n,r as t,v as e,e as o,f as r}from"./index-e757a0f1.js";async function l(r){const l=await i().use(n).use(t,s()).use((()=>i=>{e(i,"element",(i=>{u(i);a(i)}))})).use(o).process(r);return l.toString()}function s(){var i,n,t,e,o,l,s,a;const c=(n=(i=r.protocols)===null||i===void 0?void 0:i.src)!==null&&n!==void 0?n:[];const d=Object.assign(Object.assign({},r),{protocols:Object.assign(Object.assign({},(t=r.protocols)!==null&&t!==void 0?t:undefined),{src:[...c,"data"]}),attributes:Object.assign(Object.assign({},r.attributes),{table:[...(e=r.attributes.table)!==null&&e!==void 0?e:[],"cellpadding","cellPadding","cellspacing","cellSpacing","border","dir","width","height"],colgroup:[...(o=r.attributes.colgroup)!==null&&o!==void 0?o:[],"span"],col:[...(l=r.attributes.col)!==null&&l!==void 0?l:[],"width","span"],"*":[...(s=r.attributes["*"])!==null&&s!==void 0?s:[],"style","className","class","id"]}),tagNames:[...(a=r.tagNames)!==null&&a!==void 0?a:[],"html","head","body","title","meta","style","colgroup","col","center","font"]});return d}function a(i){var n;if(!(i===null||i===void 0?void 0:i.tagName)||i.tagName!=="img"){return}const t=(n=i.properties)===null||n===void 0?void 0:n.src;if(typeof t!=="string"){return}const e=c(t);if(e){i.properties.src=e;return}delete i.properties.src}function c(i){const n=i.trim();if(!n){return}if(!n.toLowerCase().startsWith("data:")){return}const t=d(n);if(!t){return}const e=new Set(["image/png","image/jpeg","image/jpg","image/gif","image/webp","image/bmp","image/x-icon","image/vnd.microsoft.icon"]);if(!e.has(t)){return}return n}function d(i){var n;const t=/^data:([^;,]+)(?:;charset=[^;,]+)?(?:;base64)?,/i.exec(i);const e=(n=t===null||t===void 0?void 0:t[1])===null||n===void 0?void 0:n.toLowerCase();return e||undefined}function u(i){var n;if(!(i===null||i===void 0?void 0:i.tagName)){return}if(((n=i.properties)===null||n===void 0?void 0:n.style)&&typeof i.properties.style==="string"){i.properties.style=f(i.properties.style)}if(i.tagName==="style"&&Array.isArray(i.children)){for(const n of i.children){if((n===null||n===void 0?void 0:n.type)==="text"&&typeof n.value==="string"){n.value=f(n.value)}}}}function f(i){const n=[/behavior\s*:/gi,/expression\s*\(/gi,/-moz-binding\s*:/gi,/vbscript\s*:/gi,/javascript\s*:/gi];let t=i;for(const i of n){t=t.replaceAll(i,"")}return t}export{l as sanitizeEmailHTML};
//# sourceMappingURL=sanitize-email-html-bf04c0f6.js.map