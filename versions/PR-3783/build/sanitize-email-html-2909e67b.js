import{u as t,g as e,r as i,v as n,e as o,f as r}from"./index-e757a0f1.js";async function l(r){const l=await t().use(e).use(i,s()).use((()=>t=>{n(t,"element",(t=>{f(t);c(t)}))})).use(o).process(r);return l.toString()}function s(){var t,e,i,n,o,l,s,c;const a=(e=(t=r.protocols)===null||t===void 0?void 0:t.src)!==null&&e!==void 0?e:[];const d=Object.assign(Object.assign({},r),{protocols:Object.assign(Object.assign({},(i=r.protocols)!==null&&i!==void 0?i:undefined),{src:[...a,"http","https","data"]}),attributes:Object.assign(Object.assign({},r.attributes),{table:[...(n=r.attributes.table)!==null&&n!==void 0?n:[],"cellpadding","cellPadding","cellspacing","cellSpacing","border","dir","width","height"],colgroup:[...(o=r.attributes.colgroup)!==null&&o!==void 0?o:[],"span"],col:[...(l=r.attributes.col)!==null&&l!==void 0?l:[],"width","span"],"*":[...(s=r.attributes["*"])!==null&&s!==void 0?s:[],"style","className","class","id","data-remote-src","dataRemoteSrc"]}),tagNames:[...(c=r.tagNames)!==null&&c!==void 0?c:[],"html","head","body","title","meta","style","colgroup","col","center","font"]});return d}function c(t){var e;if(!(t===null||t===void 0?void 0:t.tagName)||t.tagName!=="img"){return}const i=(e=t.properties)===null||e===void 0?void 0:e.src;if(typeof i!=="string"){return}const n=a(i);if(n){t.properties.src=n;delete t.properties["data-remote-src"];delete t.properties.dataRemoteSrc;return}const o=d(i);if(o){t.properties["data-remote-src"]=o;delete t.properties.src;return}delete t.properties.src}function a(t){const e=t.trim();if(!e){return}if(!e.toLowerCase().startsWith("data:")){return}const i=u(e);if(!i){return}const n=new Set(["image/png","image/jpeg","image/jpg","image/gif","image/webp","image/bmp","image/x-icon","image/vnd.microsoft.icon"]);if(!n.has(i)){return}return e}function d(t){const e=t.trim();const i=e.toLowerCase();if(i.startsWith("http://")||i.startsWith("https://")){return e}}function u(t){var e;const i=/^data:([^;,]+)(?:;charset=[^;,]+)?(?:;base64)?,/i.exec(t);const n=(e=i===null||i===void 0?void 0:i[1])===null||e===void 0?void 0:e.toLowerCase();return n||undefined}function f(t){var e;if(!(t===null||t===void 0?void 0:t.tagName)){return}if(((e=t.properties)===null||e===void 0?void 0:e.style)&&typeof t.properties.style==="string"){t.properties.style=v(t.properties.style)}if(t.tagName==="style"&&Array.isArray(t.children)){for(const e of t.children){if((e===null||e===void 0?void 0:e.type)==="text"&&typeof e.value==="string"){e.value=v(e.value)}}}}function v(t){const e=[/behavior\s*:/gi,/expression\s*\(/gi,/-moz-binding\s*:/gi,/vbscript\s*:/gi,/javascript\s*:/gi];let i=t;for(const t of e){i=i.replaceAll(t,"")}return i}export{l as sanitizeEmailHTML};
//# sourceMappingURL=sanitize-email-html-2909e67b.js.map