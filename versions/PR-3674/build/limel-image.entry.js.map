{"version":3,"names":["imageCss","ImageComponent","this","intersectionObserver","handleImageIntersection","entries","entry","isIntersecting","img","target","dataSrc","dataset","src","setAttribute","_a","unobserve","componentDidRender","setupImageIntersectionObserver","disconnectedCallback","teardownImageIntersectionObserver","render","imageProps","Object","assign","alt","lazyLoadImages","h","IntersectionObserver","root","host","shadowRoot","images","_b","querySelectorAll","_c","observe","disconnect"],"sources":["./src/components/image/image.scss?tag=limel-image","./src/components/image/image.tsx"],"sourcesContent":[":host {\n    display: inline-block;\n}\n\nimg {\n    width: 100%;\n}\n","import { Component, Element, h, Prop } from '@stencil/core';\n\n/**\n * Image is a component that displays an image.\n * It supports lazy loading of images to improve performance,\n * the image will only be loaded when it enters the viewport.\n *\n * @private\n *\n * @exampleComponent limel-example-image-basic\n * @exampleComponent limel-example-image-lazy\n * @exampleComponent limel-example-image-interactive\n * @exampleComponent limel-example-image-gallery\n * @exampleComponent limel-example-image-no-source\n */\n@Component({\n    tag: 'limel-image',\n    shadow: false,\n    styleUrl: 'image.scss',\n})\nexport class ImageComponent {\n    /**\n     * The image source URL\n     */\n    @Prop()\n    public src: string;\n\n    /**\n     * Alternative text for the image\n     */\n    @Prop()\n    public alt: string = '';\n\n    /**\n     * Enable lazy loading for images\n     */\n    @Prop()\n    public lazyLoadImages = false;\n\n    @Element()\n    private host: HTMLLimelImageElement;\n\n    private intersectionObserver: IntersectionObserver | null = null;\n\n    public componentDidRender() {\n        this.setupImageIntersectionObserver();\n    }\n\n    public disconnectedCallback() {\n        this.teardownImageIntersectionObserver();\n    }\n\n    public render() {\n        if (!this.src) {\n            return null;\n        }\n\n        const imageProps = {\n            alt: this.alt,\n            ...(this.lazyLoadImages\n                ? { 'data-src': this.src }\n                : { src: this.src }),\n        };\n\n        return <img {...imageProps} />;\n    }\n\n    private setupImageIntersectionObserver() {\n        if (!this.src || !this.lazyLoadImages) {\n            return;\n        }\n\n        // Create observer if not already created\n        if (!this.intersectionObserver) {\n            this.intersectionObserver = new IntersectionObserver(\n                this.handleImageIntersection\n            );\n        }\n\n        const root = this.host.shadowRoot ?? this.host;\n        const images = root?.querySelectorAll('img') ?? [];\n\n        for (const img of images) {\n            this.intersectionObserver?.observe(img);\n        }\n    }\n\n    private readonly handleImageIntersection = (\n        entries: IntersectionObserverEntry[]\n    ) => {\n        for (const entry of entries) {\n            if (entry.isIntersecting) {\n                const img = entry.target as HTMLImageElement;\n                const dataSrc = img.dataset.src;\n\n                if (dataSrc) {\n                    img.setAttribute('src', dataSrc);\n                    delete img.dataset.src;\n                }\n\n                this.intersectionObserver?.unobserve(img);\n            }\n        }\n    };\n\n    private teardownImageIntersectionObserver() {\n        this.intersectionObserver?.disconnect();\n        this.intersectionObserver = null;\n    }\n}\n"],"mappings":"sDAAA,MAAMA,EAAW,6C,MCoBJC,EAAc,M,yBAsBfC,KAAAC,qBAAoD,KA6C3CD,KAAAE,wBACbC,I,MAEA,IAAK,MAAMC,KAASD,EAAS,CACzB,GAAIC,EAAMC,eAAgB,CACtB,MAAMC,EAAMF,EAAMG,OAClB,MAAMC,EAAUF,EAAIG,QAAQC,IAE5B,GAAIF,EAAS,CACTF,EAAIK,aAAa,MAAOH,UACjBF,EAAIG,QAAQC,G,EAGvBE,EAAAZ,KAAKC,wBAAoB,MAAAW,SAAA,SAAAA,EAAEC,UAAUP,E,gCArE5B,G,oBAMG,K,CAOjBQ,qBACHd,KAAKe,gC,CAGFC,uBACHhB,KAAKiB,mC,CAGFC,SACH,IAAKlB,KAAKU,IAAK,CACX,OAAO,I,CAGX,MAAMS,EAAUC,OAAAC,OAAA,CACZC,IAAKtB,KAAKsB,KACNtB,KAAKuB,eACH,CAAE,WAAYvB,KAAKU,KACnB,CAAEA,IAAKV,KAAKU,MAGtB,OAAOc,EAAA,MAAAJ,OAAAC,OAAA,GAASF,G,CAGZJ,iC,UACJ,IAAKf,KAAKU,MAAQV,KAAKuB,eAAgB,CACnC,M,CAIJ,IAAKvB,KAAKC,qBAAsB,CAC5BD,KAAKC,qBAAuB,IAAIwB,qBAC5BzB,KAAKE,wB,CAIb,MAAMwB,GAAOd,EAAAZ,KAAK2B,KAAKC,cAAU,MAAAhB,SAAA,EAAAA,EAAIZ,KAAK2B,KAC1C,MAAME,GAASC,EAAAJ,IAAI,MAAJA,SAAI,SAAJA,EAAMK,iBAAiB,UAAM,MAAAD,SAAA,EAAAA,EAAI,GAEhD,IAAK,MAAMxB,KAAOuB,EAAQ,EACtBG,EAAAhC,KAAKC,wBAAoB,MAAA+B,SAAA,SAAAA,EAAEC,QAAQ3B,E,EAsBnCW,oC,OACJL,EAAAZ,KAAKC,wBAAoB,MAAAW,SAAA,SAAAA,EAAEsB,aAC3BlC,KAAKC,qBAAuB,I"}