{"version":3,"names":["imageCss","ImageComponent","this","intersectionObserver","currentImageElement","setCurrentImageElement","element","handleImageIntersection","entries","entry","isIntersecting","img","target","dataSrc","dataset","src","setAttribute","_a","unobserve","componentDidRender","teardownImageIntersectionObserver","setupImageIntersectionObserver","disconnectedCallback","render","image","alt","loading","isLazy","imageProps","Object","assign","ref","h","IntersectionObserver","observe","disconnect"],"sources":["./src/components/image/image.scss?tag=limel-image","./src/components/image/image.tsx"],"sourcesContent":[":host {\n    display: inline-block;\n}\n\nimg {\n    width: 100%;\n}\n","import { Component, h, Prop } from '@stencil/core';\nimport { Image } from '../../global/shared-types/image.types';\n\n/**\n * Image is a component that displays an image.\n * It supports lazy loading of images to improve performance,\n * the image will only be loaded when it enters the viewport.\n *\n * @private\n *\n * @exampleComponent limel-example-image-basic\n * @exampleComponent limel-example-image-lazy\n * @exampleComponent limel-example-image-interactive\n * @exampleComponent limel-example-image-gallery\n * @exampleComponent limel-example-image-no-source\n */\n@Component({\n    tag: 'limel-image',\n    shadow: false,\n    styleUrl: 'image.scss',\n})\nexport class ImageComponent {\n    /**\n     * The image object containing src, alt, and loading properties\n     */\n    @Prop()\n    public image: Image;\n\n    private intersectionObserver: IntersectionObserver | null = null;\n    private currentImageElement: HTMLImageElement | null = null;\n\n    public componentDidRender() {\n        this.teardownImageIntersectionObserver();\n        this.setupImageIntersectionObserver();\n    }\n\n    public disconnectedCallback() {\n        this.teardownImageIntersectionObserver();\n    }\n\n    public render() {\n        if (!this.image?.src) {\n            return null;\n        }\n\n        const { src, alt = '', loading = 'eager' } = this.image;\n        const isLazy = loading === 'lazy';\n\n        const imageProps = {\n            alt,\n            ...(isLazy ? { 'data-src': src } : { src }),\n            ref: this.setCurrentImageElement,\n        };\n\n        return <img {...imageProps} />;\n    }\n\n    private setCurrentImageElement = (element: HTMLImageElement) => {\n        this.currentImageElement = element;\n    };\n\n    private setupImageIntersectionObserver() {\n        if (!this.image || this.image.loading !== 'lazy') {\n            return;\n        }\n\n        if (!this.currentImageElement) {\n            return;\n        }\n\n        // Create observer if not already created\n        if (!this.intersectionObserver) {\n            this.intersectionObserver = new IntersectionObserver(\n                this.handleImageIntersection\n            );\n        }\n\n        this.intersectionObserver?.observe(this.currentImageElement);\n    }\n\n    private readonly handleImageIntersection = (\n        entries: IntersectionObserverEntry[]\n    ) => {\n        for (const entry of entries) {\n            if (entry.isIntersecting) {\n                const img = entry.target as HTMLImageElement;\n                const dataSrc = img.dataset.src;\n\n                if (dataSrc) {\n                    img.setAttribute('src', dataSrc);\n                    delete img.dataset.src;\n                }\n\n                this.intersectionObserver?.unobserve(img);\n            }\n        }\n    };\n\n    private teardownImageIntersectionObserver() {\n        this.intersectionObserver?.disconnect();\n        this.intersectionObserver = null;\n        this.currentImageElement = null;\n    }\n}\n"],"mappings":"+CAAA,MAAMA,EAAW,6C,MCqBJC,EAAc,M,yBAOfC,KAAAC,qBAAoD,KACpDD,KAAAE,oBAA+C,KA4B/CF,KAAAG,uBAA0BC,IAC9BJ,KAAKE,oBAAsBE,CAAO,EAsBrBJ,KAAAK,wBACbC,I,MAEA,IAAK,MAAMC,KAASD,EAAS,CACzB,GAAIC,EAAMC,eAAgB,CACtB,MAAMC,EAAMF,EAAMG,OAClB,MAAMC,EAAUF,EAAIG,QAAQC,IAE5B,GAAIF,EAAS,CACTF,EAAIK,aAAa,MAAOH,UACjBF,EAAIG,QAAQC,G,EAGvBE,EAAAf,KAAKC,wBAAoB,MAAAc,SAAA,SAAAA,EAAEC,UAAUP,E,yBA9D1CQ,qBACHjB,KAAKkB,oCACLlB,KAAKmB,gC,CAGFC,uBACHpB,KAAKkB,mC,CAGFG,S,MACH,MAAKN,EAAAf,KAAKsB,SAAK,MAAAP,SAAA,SAAAA,EAAEF,KAAK,CAClB,OAAO,I,CAGX,MAAMA,IAAEA,EAAGU,IAAEA,EAAM,GAAEC,QAAEA,EAAU,SAAYxB,KAAKsB,MAClD,MAAMG,EAASD,IAAY,OAE3B,MAAME,EAAUC,OAAAC,OAAAD,OAAAC,OAAA,CACZL,OACIE,EAAS,CAAE,WAAYZ,GAAQ,CAAEA,QAAK,CAC1CgB,IAAK7B,KAAKG,yBAGd,OAAO2B,EAAA,MAAAH,OAAAC,OAAA,GAASF,G,CAOZP,iC,MACJ,IAAKnB,KAAKsB,OAAStB,KAAKsB,MAAME,UAAY,OAAQ,CAC9C,M,CAGJ,IAAKxB,KAAKE,oBAAqB,CAC3B,M,CAIJ,IAAKF,KAAKC,qBAAsB,CAC5BD,KAAKC,qBAAuB,IAAI8B,qBAC5B/B,KAAKK,wB,EAIbU,EAAAf,KAAKC,wBAAoB,MAAAc,SAAA,SAAAA,EAAEiB,QAAQhC,KAAKE,oB,CAqBpCgB,oC,OACJH,EAAAf,KAAKC,wBAAoB,MAAAc,SAAA,SAAAA,EAAEkB,aAC3BjC,KAAKC,qBAAuB,KAC5BD,KAAKE,oBAAsB,I"}