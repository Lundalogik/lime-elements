{"version":3,"names":["imageCss","ImageComponent","this","intersectionObserver","handleImageIntersection","entries","entry","isIntersecting","img","target","dataSrc","dataset","src","setAttribute","_a","unobserve","componentDidRender","setupImageIntersectionObserver","disconnectedCallback","teardownImageIntersectionObserver","render","imageProps","Object","assign","alt","lazyLoad","h","IntersectionObserver","root","host","shadowRoot","images","_b","querySelectorAll","_c","observe","disconnect"],"sources":["./src/components/image/image.scss?tag=limel-image","./src/components/image/image.tsx"],"sourcesContent":["limel-image {\n    box-sizing: border-box;\n    display: inline-block;\n    max-width: 100%;\n\n    img {\n        display: block;\n        max-width: 100%;\n        height: auto;\n    }\n}\n","import { Component, Element, h, Prop } from '@stencil/core';\n\n/**\n * Instead of directly using an image element with native lazy loading (`<img loading=\"lazy\">`),\n * you can use this component to get a more advanced lazy loading,\n * which uses the Intersection Observer API to determine when the image is in the viewport.\n *\n * @exampleComponent limel-example-image-basic\n * @exampleComponent limel-example-image-lazy\n * @exampleComponent limel-example-image-interactive\n * @exampleComponent limel-example-image-gallery\n * @exampleComponent limel-example-image-no-source\n * @private\n */\n@Component({\n    tag: 'limel-image',\n    shadow: false,\n    styleUrl: 'image.scss',\n})\nexport class ImageComponent {\n    /**\n     * The image source URL\n     */\n    @Prop()\n    public src: string;\n\n    /**\n     * Alternative text for the image\n     */\n    @Prop()\n    public alt: string = '';\n\n    /**\n     * Enable lazy loading of the image\n     */\n    @Prop()\n    public lazyLoad = false;\n\n    @Element()\n    private host: HTMLLimelImageElement;\n\n    private intersectionObserver: IntersectionObserver | null = null;\n\n    public componentDidRender() {\n        this.setupImageIntersectionObserver();\n    }\n\n    public disconnectedCallback() {\n        this.teardownImageIntersectionObserver();\n    }\n\n    public render() {\n        if (!this.src) {\n            return null;\n        }\n\n        const imageProps = {\n            alt: this.alt,\n            ...(this.lazyLoad ? { 'data-src': this.src } : { src: this.src }),\n        };\n\n        return <img {...imageProps} />;\n    }\n\n    private setupImageIntersectionObserver() {\n        if (!this.src || !this.lazyLoad) {\n            return;\n        }\n\n        // Create observer if not already created\n        if (!this.intersectionObserver) {\n            this.intersectionObserver = new IntersectionObserver(\n                this.handleImageIntersection\n            );\n        }\n\n        const root = this.host.shadowRoot ?? this.host;\n        const images = root?.querySelectorAll('img') ?? [];\n\n        for (const img of images) {\n            this.intersectionObserver?.observe(img);\n        }\n    }\n\n    private readonly handleImageIntersection = (\n        entries: IntersectionObserverEntry[]\n    ) => {\n        for (const entry of entries) {\n            if (entry.isIntersecting) {\n                const img = entry.target as HTMLImageElement;\n                const dataSrc = img.dataset.src;\n\n                if (dataSrc) {\n                    img.setAttribute('src', dataSrc);\n                    delete img.dataset.src;\n                }\n\n                this.intersectionObserver?.unobserve(img);\n            }\n        }\n    };\n\n    private teardownImageIntersectionObserver() {\n        this.intersectionObserver?.disconnect();\n        this.intersectionObserver = null;\n    }\n}\n"],"mappings":"sDAAA,MAAMA,EAAW,kI,MCmBJC,EAAc,M,yBAsBfC,KAAAC,qBAAoD,KA2C3CD,KAAAE,wBACbC,I,MAEA,IAAK,MAAMC,KAASD,EAAS,CACzB,GAAIC,EAAMC,eAAgB,CACtB,MAAMC,EAAMF,EAAMG,OAClB,MAAMC,EAAUF,EAAIG,QAAQC,IAE5B,GAAIF,EAAS,CACTF,EAAIK,aAAa,MAAOH,UACjBF,EAAIG,QAAQC,G,EAGvBE,EAAAZ,KAAKC,wBAAoB,MAAAW,SAAA,SAAAA,EAAEC,UAAUP,E,gCAnE5B,G,cAMH,K,CAOXQ,qBACHd,KAAKe,gC,CAGFC,uBACHhB,KAAKiB,mC,CAGFC,SACH,IAAKlB,KAAKU,IAAK,CACX,OAAO,I,CAGX,MAAMS,EAAUC,OAAAC,OAAA,CACZC,IAAKtB,KAAKsB,KACNtB,KAAKuB,SAAW,CAAE,WAAYvB,KAAKU,KAAQ,CAAEA,IAAKV,KAAKU,MAG/D,OAAOc,EAAA,MAAAJ,OAAAC,OAAA,GAASF,G,CAGZJ,iC,UACJ,IAAKf,KAAKU,MAAQV,KAAKuB,SAAU,CAC7B,M,CAIJ,IAAKvB,KAAKC,qBAAsB,CAC5BD,KAAKC,qBAAuB,IAAIwB,qBAC5BzB,KAAKE,wB,CAIb,MAAMwB,GAAOd,EAAAZ,KAAK2B,KAAKC,cAAU,MAAAhB,SAAA,EAAAA,EAAIZ,KAAK2B,KAC1C,MAAME,GAASC,EAAAJ,IAAI,MAAJA,SAAI,SAAJA,EAAMK,iBAAiB,UAAM,MAAAD,SAAA,EAAAA,EAAI,GAEhD,IAAK,MAAMxB,KAAOuB,EAAQ,EACtBG,EAAAhC,KAAKC,wBAAoB,MAAA+B,SAAA,SAAAA,EAAEC,QAAQ3B,E,EAsBnCW,oC,OACJL,EAAAZ,KAAKC,wBAAoB,MAAAW,SAAA,SAAAA,EAAEsB,aAC3BlC,KAAKC,qBAAuB,I"}