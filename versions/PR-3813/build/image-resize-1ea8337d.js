async function n(n,t){const{width:c,height:l,fit:u="cover",type:f="image/jpeg",quality:d=.85,rename:y=(n=>s(n,f))}=t;const w=await r(n);const{sx:g,sy:h,sw:m,sh:p,dx:v,dy:b,dw:x,dh:T}=a(w.width,w.height,c,l,u);const E=o(c,l);const I=e(E);I.clearRect(0,0,c,l);I.drawImage(w,g,h,m,p,v,b,x,T);const L=await i(E,f,d);const j=y(n.name);return new File([L],j,{type:f})}function t(){try{return typeof globalThis.OffscreenCanvas==="function"}catch(n){return false}}function o(n,o){if(t()){return new globalThis.OffscreenCanvas(n,o)}const e=document.createElement("canvas");e.width=n;e.height=o;return e}function e(n){const t=n.getContext("2d",{alpha:true});if(!t){throw new Error("2D canvas context not available")}return t}function i(n,t,o){if("convertToBlob"in n){return n.convertToBlob({type:t,quality:o})}return new Promise(((e,i)=>{n.toBlob((n=>{if(!n){i(new Error("Failed to create blob from canvas"));return}e(n)}),t,o)}))}async function r(n){var t,o;if(typeof globalThis.createImageBitmap==="function"){try{return await globalThis.createImageBitmap(n,{imageOrientation:"from-image"})}catch(n){const e=((o=(t=globalThis.process)===null||t===void 0?void 0:t.env)===null||o===void 0?void 0:o.NODE_ENV)!=="production";if(e&&typeof console!=="undefined"&&typeof console.debug==="function"){console.debug("createImageBitmap failed, falling back to HTMLImageElement:",n)}}}return await c(n)}async function c(n){var t;const o=URL.createObjectURL(n);try{const n=new Image;n.decoding="sync";n.src=o;await((t=n.decode)===null||t===void 0?void 0:t.call(n).catch((()=>undefined)));if(!n.complete){await new Promise(((t,o)=>{const e=()=>{n.removeEventListener("load",i);n.removeEventListener("error",r)};const i=()=>{e();t()};const r=n=>{e();o(n)};n.addEventListener("load",i);n.addEventListener("error",r)}))}return n}finally{URL.revokeObjectURL(o)}}function a(n,t,o,e,i){const r=n/t;const c=o/e;if(i==="cover"){let i;let a;if(r>c){a=t;i=t*c}else{i=n;a=n/c}const s=(n-i)/2;const l=(t-a)/2;return{sx:s,sy:l,sw:i,sh:a,dx:0,dy:0,dw:o,dh:e}}let a;let s;if(r>c){a=o;s=o/r}else{s=e;a=e*r}const l=(o-a)/2;const u=(e-s)/2;return{sx:0,sy:0,sw:n,sh:t,dx:l,dy:u,dw:a,dh:s}}function s(n,t){const o=t==="image/png"?"png":"jpg";const e=n.lastIndexOf(".");const i=e>0?n.slice(0,e):n;return`${i}.${o}`}export{n as r};
//# sourceMappingURL=image-resize-1ea8337d.js.map