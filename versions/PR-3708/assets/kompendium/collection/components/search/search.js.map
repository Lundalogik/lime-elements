{"version":3,"file":"search.js","sourceRoot":"","sources":["../../../src/components/search/search.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAE,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,KAAK,EAAE,MAAM,eAAe,CAAC;AAGnE,OAAO,QAAQ,MAAM,iBAAiB,CAAC;AAOvC,MAAM,OAAO,MAAM;IAaf;QALQ,cAAS,GAAyB,EAAE,CAAC;QAkCrC,mBAAc,GAAG,CAAC,QAA4B,EAAE,EAAE;YACtD,OAAO,CACH;gBACI,SAAG,IAAI,EAAE,GAAG,GAAG,QAAQ,CAAC,IAAI,EAAE,OAAO,EAAE,IAAI,CAAC,eAAe;oBACvD,YAAM,KAAK,EAAC,WAAW,IAAE,QAAQ,CAAC,KAAK,CAAQ,CAC/C,CACH,CACR,CAAC;QACN,CAAC,CAAC;QAEM,sBAAiB,GAAG,CAAC,KAAiB,EAAE,EAAE;YAC9C,MAAM,KAAK,GAAI,KAAK,CAAC,MAA2B,CAAC,KAAK,CAAC;YACvD,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;QACvB,CAAC,CAAC;QASM,oBAAe,GAAG,GAAG,EAAE;;YAC3B,MAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,aAA6B,0CAAE,IAAI,EAAE,CAAC;QAChE,CAAC,CAAC;QApDE,IAAI,CAAC,MAAM,GAAG,QAAQ,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;KAC5C;IAED,gBAAgB;QACZ,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,KAAK,EAAE,CAAC;IACxD,CAAC;IAED,MAAM;QACF,MAAM,SAAS,GAAG;YACd,MAAM,EAAE,IAAI;YACZ,aAAa,EAAE,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC;SAC3C,CAAC;QAEF,OAAO,CACH,4DAAK,KAAK,EAAC,YAAY;YACnB,8DACI,IAAI,EAAC,QAAQ,EACb,SAAS,QACT,WAAW,EAAC,QAAQ,EACpB,OAAO,EAAE,IAAI,CAAC,iBAAiB,GACjC;YACF,2DAAI,KAAK,EAAE,SAAS,IACf,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,cAAc,CAAC,CACvC,CACH,CACT,CAAC;IACN,CAAC;IAiBO,MAAM,CAAC,KAAa;QACxB,MAAM,KAAK,GAA6B,IAAI,CAAC,KAAK,CAAC;QACnD,MAAM,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;QAEnC,IAAI,CAAC,SAAS,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;IAChE,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAKJ","sourcesContent":["import { Component, h, Element, Prop, State } from '@stencil/core';\nimport Fuse from 'fuse.js';\nimport { KompendiumDocument } from '../../types';\nimport debounce from 'lodash/debounce';\n\n@Component({\n    tag: 'kompendium-search',\n    styleUrl: 'search.scss',\n    shadow: true,\n})\nexport class Search {\n    /**\n     * Index containing searchable documents\n     */\n    @Prop()\n    public index: any;\n\n    @State()\n    private documents: KompendiumDocument[] = [];\n\n    @Element()\n    private host: HTMLKompendiumSearchElement;\n\n    constructor() {\n        this.search = debounce(this.search, 300);\n    }\n\n    componentDidLoad(): void {\n        this.host.shadowRoot.querySelector('input').focus();\n    }\n\n    render(): HTMLElement {\n        const classList = {\n            result: true,\n            'has-results': this.documents.length > 0,\n        };\n\n        return (\n            <div class=\"search-box\">\n                <input\n                    type=\"search\"\n                    autoFocus\n                    placeholder=\"Search\"\n                    onInput={this.handleChangeInput}\n                />\n                <ul class={classList}>\n                    {this.documents.map(this.renderDocument)}\n                </ul>\n            </div>\n        );\n    }\n\n    private renderDocument = (document: KompendiumDocument) => {\n        return (\n            <li>\n                <a href={'#' + document.path} onClick={this.handleLinkClick}>\n                    <span class=\"link-text\">{document.title}</span>\n                </a>\n            </li>\n        );\n    };\n\n    private handleChangeInput = (event: InputEvent) => {\n        const query = (event.target as HTMLInputElement).value;\n        this.search(query);\n    };\n\n    private search(query: string) {\n        const index: Fuse<KompendiumDocument> = this.index;\n        const result = index.search(query);\n\n        this.documents = result.map((doc) => doc.item).slice(0, 10);\n    }\n\n    private handleLinkClick = () => {\n        (this.host.shadowRoot.activeElement as HTMLElement)?.blur();\n    };\n}\n"]}