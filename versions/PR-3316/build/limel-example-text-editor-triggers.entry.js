import{r as t,c as i,h as e,g as s}from"./index-6156b4fd.js";import{c as a}from"./random-string-812b1c35.js";import{p as h}from"./contains-845fe815.js";import{A as r,b as l,E as n,T as o,c}from"./keycodes-7f5039b4.js";const u="limel-button-group{min-width:8rem}limel-example-controls{display:flex;flex-wrap:wrap}.mode{display:flex;flex-wrap:nowrap}.value{display:flex;gap:0.5rem}limel-portal{width:auto}";const m=class{constructor(s){t(this,s);this.close=i(this,"close",7);this.insertModeButtons=[{id:"1",title:"text",selected:true},{id:"2",title:"chip"}];this.selectionIndex=0;this.handleKeyPress=t=>{const i=[c,l,r,n,o];if(i.includes(t.key)){t.stopPropagation();t.preventDefault()}if(t.key===r||t.key===l){this.moveSelection(t.key)}if(t.key===n||t.key===o){const t=this.items.find((t=>t.selected));if(t){this.insertItem(t)}}if(t.key===c){this.close.emit()}};this.moveSelection=t=>{const i=t===r?1:-1;const e=this.items.length;this.selectionIndex=(this.selectionIndex+i+e)%e;this.items=this.items.map(((t,i)=>{t.selected=i===this.selectionIndex;return Object.assign({},t)}))};this.renderPicker=()=>{if(!this.isPickerOpen){return}const t=this.items.filter((t=>t.text.toLowerCase().includes(this.inputText)));const i=getComputedStyle(this.host).getPropertyValue("--dropdown-z-index");return[e("limel-portal",{containerStyle:{"background-color":"rgb(var(--contrast-100))","border-radius":"0.5rem","box-shadow":"var(--shadow-depth-16)","z-index":i},containerId:this.portalId,visible:this.isPickerOpen,openDirection:"bottom-start",inheritParentWidth:true,anchor:this.textEditorElement},this.renderList(t))]};this.renderList=t=>{if(t.length===0){return e("div",{style:{padding:"0.5rem"}},"Couldn't find. Not a hero yet! ðŸ¥²")}return e("limel-list",{items:t,onChange:this.handleListChange,type:"selectable"})};this.handleTriggerStart=t=>{this.triggerState="start";this.isPickerOpen=true;this.triggerFunction=t.detail.textEditor};this.handleTriggerStop=()=>{this.triggerState="stop";this.inputText="";this.isPickerOpen=false};this.handleTriggerChange=t=>{this.inputText=t.detail.value.toLowerCase()};this.handleChange=t=>{this.value=t.detail};this.handleListChange=t=>{if(t.detail.selected){this.insertItem(t.detail)}};this.handleInsertModeChange=t=>{this.insertMode=t.detail.title};this.insertItem=t=>{if(this.insertMode==="text"){this.triggerFunction.insert("@"+t.text);return}this.triggerFunction.insert({node:{tagName:"limel-chip",attributes:{icon:t.icon,text:t.text}},children:["I'm a teapot"]})};this.value="";this.triggerState="";this.inputText="";this.isPickerOpen=false;this.textEditorElement=undefined;this.insertMode="text";this.items=[{text:"Wolverine",value:1,icon:"wolf",selected:true},{text:"Captain America",value:2,icon:"captain_america"},{text:"Superman",value:3,icon:"superman"},{text:"Tony Stark",value:4,icon:"iron_man"},{text:"Batman",value:5,icon:"batman_old"}];this.portalId=a();this.handleClick=this.handleClick.bind(this)}watchOpen(){this.setupEventHandlers()}componentWillLoad(){this.setupEventHandlers()}setupEventHandlers(){if(this.isPickerOpen){this.host.addEventListener("click",this.handleClick,{capture:true});this.host.addEventListener("keydown",this.handleKeyPress,{capture:true})}else{this.host.removeEventListener("click",this.handleClick,{capture:true});this.host.removeEventListener("keydown",this.handleKeyPress,{capture:true})}}render(){return[e("limel-text-editor",{style:{display:"block"},ref:t=>this.textEditorElement=t,value:this.value,customElements:[{tagName:"limel-chip",attributes:["text","icon"]}],triggers:["@"],onTriggerStart:this.handleTriggerStart,onTriggerStop:this.handleTriggerStop,onTriggerChange:this.handleTriggerChange,onChange:this.handleChange}),e("limel-example-controls",null,"Insert mode:",e("limel-button-group",{class:"mode",value:this.insertModeButtons,onChange:this.handleInsertModeChange}),e("div",{class:"value"},e("limel-example-value",{label:"Action",value:this.triggerState}),e("limel-example-value",{label:"Tag value",value:this.inputText}))),this.renderPicker(),e("limel-example-value",{value:this.value})]}handleClick(t){const i=t.target;const e=h(this.host,i);if(this.isPickerOpen&&!e){t.stopPropagation();t.preventDefault();this.isPickerOpen=false;this.close.emit()}}get host(){return s(this)}static get watchers(){return{isPickerOpen:["watchOpen"]}}};m.style=u;export{m as limel_example_text_editor_triggers};
//# sourceMappingURL=limel-example-text-editor-triggers.entry.js.map