{"version":3,"names":["hotkeyCss","Hotkey","render","isApple","isAppleDevice","parts","this","getDisplayParts","value","h","Host","map","part","formatDisplayToken","token","trimmed","trim","lower","toLowerCase","raw","current","index","length","char","nextChar","push","tail","handleKeyDown","event","defaultPrevented","repeat","handledFlag","isKeyboardEventFromTextInput","expected","normalizeHotkeyString","pressed","hotkeyFromKeyboardEvent","hotkeyTrigger","emit","hotkey","keyboardEvent"],"sources":["./src/components/hotkey/hotkey.scss?tag=limel-hotkey&encapsulation=shadow","./src/components/hotkey/hotkey.tsx"],"sourcesContent":["@forward '../markdown/partial-styles/_kbd.scss';\n:host(limel-hotkey) {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\nkbd {\n    display: inline-block;\n    font-size: 0.75rem;\n    padding: 0.0625rem 0.375rem;\n\n    &::first-letter {\n        text-transform: uppercase;\n    }\n}\n","import {\n    Component,\n    Event,\n    EventEmitter,\n    Host,\n    Listen,\n    Prop,\n    h,\n} from '@stencil/core';\nimport {\n    hotkeyFromKeyboardEvent,\n    isKeyboardEventFromTextInput,\n    normalizeHotkeyString,\n} from '../../util/hotkeys';\nimport { isAppleDevice } from '../../util/device';\n\n/**\n * This component is used internally to visualize hotkeys in other components,\n * such as the menu. It will also emit an event when the hotkey is pressed,\n * so that the parent component can react to it.\n *\n * @exampleComponent limel-example-hotkey-basic\n * @private\n */\n@Component({\n    tag: 'limel-hotkey',\n    shadow: true,\n    styleUrl: 'hotkey.scss',\n})\nexport class Hotkey {\n    /**\n     * The hotkey\n     */\n    @Prop({ reflect: true })\n    public value: string;\n\n    /**\n     * Emits when the configured hotkey is pressed.\n     */\n    @Event({ bubbles: true, composed: true })\n    public hotkeyTrigger: EventEmitter<{\n        hotkey: string;\n        value: string;\n        keyboardEvent: KeyboardEvent;\n    }>;\n\n    private static readonly handledFlag = '__limelHotkeyHandled';\n\n    public render() {\n        const isApple = isAppleDevice();\n        const parts = this.getDisplayParts(this.value);\n        return (\n            <Host>\n                {parts.map((part) => (\n                    <kbd>{this.formatDisplayToken(part, isApple)}</kbd>\n                ))}\n            </Host>\n        );\n    }\n\n    private formatDisplayToken(token: string, isApple: boolean): string {\n        const trimmed = (token ?? '').trim();\n        if (!trimmed) {\n            return '';\n        }\n\n        if (trimmed === '+') {\n            return '+';\n        }\n\n        const lower = trimmed.toLowerCase();\n\n        switch (lower) {\n            case 'meta':\n            case 'cmd':\n            case 'command': {\n                return isApple ? '⌘' : 'Ctrl';\n            }\n\n            case 'alt':\n            case 'option': {\n                return isApple ? '⌥' : 'Alt';\n            }\n\n            case 'shift': {\n                return '⇧';\n            }\n\n            case 'enter':\n            case 'return': {\n                return '↩';\n            }\n\n            case 'delete':\n            case 'del':\n            case 'backspace': {\n                if (isApple) {\n                    return '⌫';\n                }\n                return lower === 'backspace' ? 'Backspace' : 'Del';\n            }\n\n            case 'ctrl':\n            case 'control': {\n                return 'Ctrl';\n            }\n        }\n\n        return trimmed;\n    }\n\n    private getDisplayParts(value: string): string[] {\n        const raw = (value ?? '').trim();\n        if (!raw) {\n            return [];\n        }\n\n        // Special case: allow `+` as a hotkey.\n        if (raw === '+') {\n            return ['+'];\n        }\n\n        // Split on `+`, but treat `++` as the `+` key.\n        const parts: string[] = [];\n        let current = '';\n\n        let index = 0;\n        while (index < raw.length) {\n            const char = raw[index];\n            if (char !== '+') {\n                current += char;\n                index++;\n                continue;\n            }\n\n            const nextChar = raw[index + 1];\n            if (nextChar === '+') {\n                const token = current.trim();\n                if (token) {\n                    parts.push(token);\n                }\n                parts.push('+');\n                current = '';\n                index += 2;\n                continue;\n            }\n\n            const token = current.trim();\n            if (token) {\n                parts.push(token);\n            }\n            current = '';\n            index++;\n        }\n\n        const tail = current.trim();\n        if (tail) {\n            parts.push(tail);\n        }\n\n        return parts;\n    }\n\n    @Listen('keydown', { target: 'document', capture: true })\n    public handleKeyDown(event: KeyboardEvent) {\n        if (event.defaultPrevented || event.repeat) {\n            return;\n        }\n\n        if ((event as any)[Hotkey.handledFlag]) {\n            return;\n        }\n\n        if (!this.value) {\n            return;\n        }\n\n        if (isKeyboardEventFromTextInput(event)) {\n            return;\n        }\n\n        const expected = normalizeHotkeyString(this.value);\n        if (!expected) {\n            return;\n        }\n\n        const pressed = hotkeyFromKeyboardEvent(event);\n        if (!pressed || pressed !== expected) {\n            return;\n        }\n\n        (event as any)[Hotkey.handledFlag] = true;\n        this.hotkeyTrigger.emit({\n            hotkey: expected,\n            value: this.value,\n            keyboardEvent: event,\n        });\n    }\n}\n"],"mappings":"yJAAA,MAAMA,EAAY,2vB,MC6BLC,EAAM,M,2FAmBRC,SACH,MAAMC,EAAUC,IAChB,MAAMC,EAAQC,KAAKC,gBAAgBD,KAAKE,OACxC,OACIC,EAACC,EAAI,KACAL,EAAMM,KAAKC,GACRH,EAAA,WAAMH,KAAKO,mBAAmBD,EAAMT,M,CAM5CU,mBAAmBC,EAAeX,GACtC,MAAMY,GAAWD,IAAK,MAALA,SAAK,EAALA,EAAS,IAAIE,OAC9B,IAAKD,EAAS,CACV,MAAO,E,CAGX,GAAIA,IAAY,IAAK,CACjB,MAAO,G,CAGX,MAAME,EAAQF,EAAQG,cAEtB,OAAQD,GACJ,IAAK,OACL,IAAK,MACL,IAAK,UAAW,CACZ,OAAOd,EAAU,IAAM,M,CAG3B,IAAK,MACL,IAAK,SAAU,CACX,OAAOA,EAAU,IAAM,K,CAG3B,IAAK,QAAS,CACV,MAAO,G,CAGX,IAAK,QACL,IAAK,SAAU,CACX,MAAO,G,CAGX,IAAK,SACL,IAAK,MACL,IAAK,YAAa,CACd,GAAIA,EAAS,CACT,MAAO,G,CAEX,OAAOc,IAAU,YAAc,YAAc,K,CAGjD,IAAK,OACL,IAAK,UAAW,CACZ,MAAO,M,EAIf,OAAOF,C,CAGHR,gBAAgBC,GACpB,MAAMW,GAAOX,IAAK,MAALA,SAAK,EAALA,EAAS,IAAIQ,OAC1B,IAAKG,EAAK,CACN,MAAO,E,CAIX,GAAIA,IAAQ,IAAK,CACb,MAAO,CAAC,I,CAIZ,MAAMd,EAAkB,GACxB,IAAIe,EAAU,GAEd,IAAIC,EAAQ,EACZ,MAAOA,EAAQF,EAAIG,OAAQ,CACvB,MAAMC,EAAOJ,EAAIE,GACjB,GAAIE,IAAS,IAAK,CACdH,GAAWG,EACXF,IACA,Q,CAGJ,MAAMG,EAAWL,EAAIE,EAAQ,GAC7B,GAAIG,IAAa,IAAK,CAClB,MAAMV,EAAQM,EAAQJ,OACtB,GAAIF,EAAO,CACPT,EAAMoB,KAAKX,E,CAEfT,EAAMoB,KAAK,KACXL,EAAU,GACVC,GAAS,EACT,Q,CAGJ,MAAMP,EAAQM,EAAQJ,OACtB,GAAIF,EAAO,CACPT,EAAMoB,KAAKX,E,CAEfM,EAAU,GACVC,G,CAGJ,MAAMK,EAAON,EAAQJ,OACrB,GAAIU,EAAM,CACNrB,EAAMoB,KAAKC,E,CAGf,OAAOrB,C,CAIJsB,cAAcC,GACjB,GAAIA,EAAMC,kBAAoBD,EAAME,OAAQ,CACxC,M,CAGJ,GAAKF,EAAc3B,EAAO8B,aAAc,CACpC,M,CAGJ,IAAKzB,KAAKE,MAAO,CACb,M,CAGJ,GAAIwB,EAA6BJ,GAAQ,CACrC,M,CAGJ,MAAMK,EAAWC,EAAsB5B,KAAKE,OAC5C,IAAKyB,EAAU,CACX,M,CAGJ,MAAME,EAAUC,EAAwBR,GACxC,IAAKO,GAAWA,IAAYF,EAAU,CAClC,M,CAGHL,EAAc3B,EAAO8B,aAAe,KACrCzB,KAAK+B,cAAcC,KAAK,CACpBC,OAAQN,EACRzB,MAAOF,KAAKE,MACZgC,cAAeZ,G,GArJC3B,EAAA8B,YAAc,uB"}